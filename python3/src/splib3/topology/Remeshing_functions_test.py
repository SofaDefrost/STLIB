#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Created on Fri Oct 21 16:57:00 2022

@author: pchaillo
"""

# importing csv module
# import csv
# import numpy as np

import Remeshing_functions as mf
import unittest
import pytest
import math

# print(points)

# def new_idx_from_conv_tab_test(mesh,tab): #pytest version
#     mesh_test  = [[1 ,2 ,3 ,4], [5, 6 ,7 ,8], [9, 10 ,11, 12]]
#     conv_tab_test = [[1, 11],[2, 222],[3, 4],[4, 3],[5, 10],[6, 13],[7, 24],[8, 18],[9, 19],[10, 100],[11, 1],[12, 25]]
#     new_mesh = mf.new_idx_from_conv_tab(mesh = mesh_test,tab = conv_tab_test )
#     new_mesh_sol = [[11, 222, 4, 3], [10, 13, 24, 18], [19, 100, 1, 25]]
#     print("o")
#     if new_mesh != new_mesh_sol :
#         print("Reindexation du robot mauvaise")
#     assert new_mesh == new_mesh_sol 

class Remeshing_test(unittest.TestCase):

    # def __init__(self) : # ne fonctionne pas je ne comprend pas pourquoi
        # self.points = [[9.71445147e-16, 4.375, -0.649519], [3.125, 4.375, -0.649519], [6.25, 4.375, -0.649519], [9.375, 4.375, -0.649519], [12.5, 4.375, -0.649519], [15.625, 4.375, -0.649519], [18.75, 4.375, -0.649519], [21.875, 4.375, -0.649519], [25.0, 4.375, -0.649519], [28.125, 4.375, -0.649519], [31.25, 4.375, -0.649519], [34.375, 4.375, -0.649519], [37.5, 4.375, -0.649519], [40.625, 4.375, -0.649519], [43.75, 4.375, -0.649519], [46.875, 4.375, -0.649519], [50.0, 4.375, -0.649519], [1.03240061e-15, 4.649519, -0.375], [3.125, 4.649519, -0.375], [6.25, 4.649519, -0.375], [9.375, 4.649519, -0.375], [12.5, 4.649519, -0.375], [15.625, 4.649519, -0.375], [18.75, 4.649519, -0.375], [21.875, 4.649519, -0.375], [25.0, 4.649519, -0.375], [28.125, 4.649519, -0.375], [31.25, 4.649519, -0.375], [34.375, 4.649519, -0.375], [37.5, 4.649519, -0.375], [40.625, 4.649519, -0.375], [43.75, 4.649519, -0.375], [46.875, 4.649519, -0.375], [50.0, 4.649519, -0.375], [8.8817842e-16, 4.0, -0.75], [3.125, 4.0, -0.75], [6.25, 4.0, -0.75], [9.375, 4.0, -0.75], [12.5, 4.0, -0.75], [15.625, 4.0, -0.75], [18.75, 4.0, -0.75], [21.875, 4.0, -0.75], [25.0, 4.0, -0.75], [28.125, 4.0, -0.75], [31.25, 4.0, -0.75], [34.375, 4.0, -0.75], [37.5, 4.0, -0.75], [40.625, 4.0, -0.75], [43.75, 4.0, -0.75], [46.875, 4.0, -0.75], [50.0, 4.0, -0.75], [1.05471187e-15, 4.75, 0.0], [3.125, 4.75, 0.0], [6.25, 4.75, 0.0], [9.375, 4.75, 0.0], [12.5, 4.75, 0.0], [15.625, 4.75, 0.0], [18.75, 4.75, 0.0], [21.875, 4.75, 0.0], [25.0, 4.75, 0.0], [28.125, 4.75, 0.0], [31.25, 4.75, 0.0], [34.375, 4.75, 0.0], [37.5, 4.75, 0.0], [40.625, 4.75, 0.0], [43.75, 4.75, 0.0], [46.875, 4.75, 0.0], [50.0, 4.75, 0.0], [8.04911693e-16, 3.625, -0.649519], [3.125, 3.625, -0.649519], [6.25, 3.625, -0.649519], [9.375, 3.625, -0.649519], [12.5, 3.625, -0.649519], [15.625, 3.625, -0.649519], [18.75, 3.625, -0.649519], [21.875, 3.625, -0.649519], [25.0, 3.625, -0.649519], [28.125, 3.625, -0.649519], [31.25, 3.625, -0.649519], [34.375, 3.625, -0.649519], [37.5, 3.625, -0.649519], [40.625, 3.625, -0.649519], [43.75, 3.625, -0.649519], [46.875, 3.625, -0.649519], [50.0, 3.625, -0.649519], [1.03240061e-15, 4.649519, 0.375], [3.125, 4.649519, 0.375], [6.25, 4.649519, 0.375], [9.375, 4.649519, 0.375], [12.5, 4.649519, 0.375], [15.625, 4.649519, 0.375], [18.75, 4.649519, 0.375], [21.875, 4.649519, 0.375], [25.0, 4.649519, 0.375], [28.125, 4.649519, 0.375], [31.25, 4.649519, 0.375], [34.375, 4.649519, 0.375], [37.5, 4.649519, 0.375], [40.625, 4.649519, 0.375], [43.75, 4.649519, 0.375], [46.875, 4.649519, 0.375], [50.0, 4.649519, 0.375], [7.4395623e-16, 3.350481, -0.375], [3.125, 3.350481, -0.375], [6.25, 3.350481, -0.375], [9.375, 3.350481, -0.375], [12.5, 3.350481, -0.375], [15.625, 3.350481, -0.375], [18.75, 3.350481, -0.375], [21.875, 3.350481, -0.375], [25.0, 3.350481, -0.375], [28.125, 3.350481, -0.375], [31.25, 3.350481, -0.375], [34.375, 3.350481, -0.375], [37.5, 3.350481, -0.375], [40.625, 3.350481, -0.375], [43.75, 3.350481, -0.375], [46.875, 3.350481, -0.375], [50.0, 3.350481, -0.375], [9.71445147e-16, 4.375, 0.649519], [3.125, 4.375, 0.649519], [6.25, 4.375, 0.649519], [9.375, 4.375, 0.649519], [12.5, 4.375, 0.649519], [15.625, 4.375, 0.649519], [18.75, 4.375, 0.649519], [21.875, 4.375, 0.649519], [25.0, 4.375, 0.649519], [28.125, 4.375, 0.649519], [31.25, 4.375, 0.649519], [34.375, 4.375, 0.649519], [37.5, 4.375, 0.649519], [40.625, 4.375, 0.649519], [43.75, 4.375, 0.649519], [46.875, 4.375, 0.649519], [50.0, 4.375, 0.649519], [7.21644966e-16, 3.25, 0.0], [3.125, 3.25, 0.0], [6.25, 3.25, 0.0], [9.375, 3.25, 0.0], [12.5, 3.25, 0.0], [15.625, 3.25, 0.0], [18.75, 3.25, 0.0], [21.875, 3.25, 0.0], [25.0, 3.25, 0.0], [28.125, 3.25, 0.0], [31.25, 3.25, 0.0], [34.375, 3.25, 0.0], [37.5, 3.25, 0.0], [40.625, 3.25, 0.0], [43.75, 3.25, 0.0], [46.875, 3.25, 0.0], [50.0, 3.25, 0.0], [8.8817842e-16, 4.0, 0.75], [3.125, 4.0, 0.75], [6.25, 4.0, 0.75], [9.375, 4.0, 0.75], [12.5, 4.0, 0.75], [15.625, 4.0, 0.75], [18.75, 4.0, 0.75], [21.875, 4.0, 0.75], [25.0, 4.0, 0.75], [28.125, 4.0, 0.75], [31.25, 4.0, 0.75], [34.375, 4.0, 0.75], [37.5, 4.0, 0.75], [40.625, 4.0, 0.75], [43.75, 4.0, 0.75], [46.875, 4.0, 0.75], [50.0, 4.0, 0.75], [7.4395623e-16, 3.350481, 0.375], [3.125, 3.350481, 0.375], [6.25, 3.350481, 0.375], [9.375, 3.350481, 0.375], [12.5, 3.350481, 0.375], [15.625, 3.350481, 0.375], [18.75, 3.350481, 0.375], [21.875, 3.350481, 0.375], [25.0, 3.350481, 0.375], [28.125, 3.350481, 0.375], [31.25, 3.350481, 0.375], [34.375, 3.350481, 0.375], [37.5, 3.350481, 0.375], [40.625, 3.350481, 0.375], [43.75, 3.350481, 0.375], [46.875, 3.350481, 0.375], [50.0, 3.350481, 0.375], [8.04911693e-16, 3.625, 0.649519], [3.125, 3.625, 0.649519], [6.25, 3.625, 0.649519], [9.375, 3.625, 0.649519], [12.5, 3.625, 0.649519], [15.625, 3.625, 0.649519], [18.75, 3.625, 0.649519], [21.875, 3.625, 0.649519], [25.0, 3.625, 0.649519], [28.125, 3.625, 0.649519], [31.25, 3.625, 0.649519], [34.375, 3.625, 0.649519], [37.5, 3.625, 0.649519], [40.625, 3.625, 0.649519], [43.75, 3.625, 0.649519], [46.875, 3.625, 0.649519], [50.0, 3.625, 0.649519]]
        # self.points_ordered_in_x = [[7.21644966e-16, 3.25, 0.0], [7.4395623e-16, 3.350481, -0.375], [7.4395623e-16, 3.350481, 0.375], [8.04911693e-16, 3.625, -0.649519], [8.04911693e-16, 3.625, 0.649519], [8.8817842e-16, 4.0, -0.75], [8.8817842e-16, 4.0, 0.75], [9.71445147e-16, 4.375, -0.649519], [9.71445147e-16, 4.375, 0.649519], [1.03240061e-15, 4.649519, -0.375], [1.03240061e-15, 4.649519, 0.375], [1.05471187e-15, 4.75, 0.0], [3.125, 4.375, -0.649519], [3.125, 4.649519, -0.375], [3.125, 4.0, -0.75], [3.125, 4.75, 0.0], [3.125, 3.625, -0.649519], [3.125, 4.649519, 0.375], [3.125, 3.350481, -0.375], [3.125, 4.375, 0.649519], [3.125, 3.25, 0.0], [3.125, 4.0, 0.75], [3.125, 3.350481, 0.375], [3.125, 3.625, 0.649519], [6.25, 4.375, -0.649519], [6.25, 4.649519, -0.375], [6.25, 4.0, -0.75], [6.25, 4.75, 0.0], [6.25, 3.625, -0.649519], [6.25, 4.649519, 0.375], [6.25, 3.350481, -0.375], [6.25, 4.375, 0.649519], [6.25, 3.25, 0.0], [6.25, 4.0, 0.75], [6.25, 3.350481, 0.375], [6.25, 3.625, 0.649519], [9.375, 4.375, -0.649519], [9.375, 4.649519, -0.375], [9.375, 4.0, -0.75], [9.375, 4.75, 0.0], [9.375, 3.625, -0.649519], [9.375, 4.649519, 0.375], [9.375, 3.350481, -0.375], [9.375, 4.375, 0.649519], [9.375, 3.25, 0.0], [9.375, 4.0, 0.75], [9.375, 3.350481, 0.375], [9.375, 3.625, 0.649519], [12.5, 4.375, -0.649519], [12.5, 4.649519, -0.375], [12.5, 4.0, -0.75], [12.5, 4.75, 0.0], [12.5, 3.625, -0.649519], [12.5, 4.649519, 0.375], [12.5, 3.350481, -0.375], [12.5, 4.375, 0.649519], [12.5, 3.25, 0.0], [12.5, 4.0, 0.75], [12.5, 3.350481, 0.375], [12.5, 3.625, 0.649519], [15.625, 4.375, -0.649519], [15.625, 4.649519, -0.375], [15.625, 4.0, -0.75], [15.625, 4.75, 0.0], [15.625, 3.625, -0.649519], [15.625, 4.649519, 0.375], [15.625, 3.350481, -0.375], [15.625, 4.375, 0.649519], [15.625, 3.25, 0.0], [15.625, 4.0, 0.75], [15.625, 3.350481, 0.375], [15.625, 3.625, 0.649519], [18.75, 4.375, -0.649519], [18.75, 4.649519, -0.375], [18.75, 4.0, -0.75], [18.75, 4.75, 0.0], [18.75, 3.625, -0.649519], [18.75, 4.649519, 0.375], [18.75, 3.350481, -0.375], [18.75, 4.375, 0.649519], [18.75, 3.25, 0.0], [18.75, 4.0, 0.75], [18.75, 3.350481, 0.375], [18.75, 3.625, 0.649519], [21.875, 4.375, -0.649519], [21.875, 4.649519, -0.375], [21.875, 4.0, -0.75], [21.875, 4.75, 0.0], [21.875, 3.625, -0.649519], [21.875, 4.649519, 0.375], [21.875, 3.350481, -0.375], [21.875, 4.375, 0.649519], [21.875, 3.25, 0.0], [21.875, 4.0, 0.75], [21.875, 3.350481, 0.375], [21.875, 3.625, 0.649519], [25.0, 4.375, -0.649519], [25.0, 4.649519, -0.375], [25.0, 4.0, -0.75], [25.0, 4.75, 0.0], [25.0, 3.625, -0.649519], [25.0, 4.649519, 0.375], [25.0, 3.350481, -0.375], [25.0, 4.375, 0.649519], [25.0, 3.25, 0.0], [25.0, 4.0, 0.75], [25.0, 3.350481, 0.375], [25.0, 3.625, 0.649519], [28.125, 4.375, -0.649519], [28.125, 4.649519, -0.375], [28.125, 4.0, -0.75], [28.125, 4.75, 0.0], [28.125, 3.625, -0.649519], [28.125, 4.649519, 0.375], [28.125, 3.350481, -0.375], [28.125, 4.375, 0.649519], [28.125, 3.25, 0.0], [28.125, 4.0, 0.75], [28.125, 3.350481, 0.375], [28.125, 3.625, 0.649519], [31.25, 4.375, -0.649519], [31.25, 4.649519, -0.375], [31.25, 4.0, -0.75], [31.25, 4.75, 0.0], [31.25, 3.625, -0.649519], [31.25, 4.649519, 0.375], [31.25, 3.350481, -0.375], [31.25, 4.375, 0.649519], [31.25, 3.25, 0.0], [31.25, 4.0, 0.75], [31.25, 3.350481, 0.375], [31.25, 3.625, 0.649519], [34.375, 4.375, -0.649519], [34.375, 4.649519, -0.375], [34.375, 4.0, -0.75], [34.375, 4.75, 0.0], [34.375, 3.625, -0.649519], [34.375, 4.649519, 0.375], [34.375, 3.350481, -0.375], [34.375, 4.375, 0.649519], [34.375, 3.25, 0.0], [34.375, 4.0, 0.75], [34.375, 3.350481, 0.375], [34.375, 3.625, 0.649519], [37.5, 4.375, -0.649519], [37.5, 4.649519, -0.375], [37.5, 4.0, -0.75], [37.5, 4.75, 0.0], [37.5, 3.625, -0.649519], [37.5, 4.649519, 0.375], [37.5, 3.350481, -0.375], [37.5, 4.375, 0.649519], [37.5, 3.25, 0.0], [37.5, 4.0, 0.75], [37.5, 3.350481, 0.375], [37.5, 3.625, 0.649519], [40.625, 4.375, -0.649519], [40.625, 4.649519, -0.375], [40.625, 4.0, -0.75], [40.625, 4.75, 0.0], [40.625, 3.625, -0.649519], [40.625, 4.649519, 0.375], [40.625, 3.350481, -0.375], [40.625, 4.375, 0.649519], [40.625, 3.25, 0.0], [40.625, 4.0, 0.75], [40.625, 3.350481, 0.375], [40.625, 3.625, 0.649519], [43.75, 4.375, -0.649519], [43.75, 4.649519, -0.375], [43.75, 4.0, -0.75], [43.75, 4.75, 0.0], [43.75, 3.625, -0.649519], [43.75, 4.649519, 0.375], [43.75, 3.350481, -0.375], [43.75, 4.375, 0.649519], [43.75, 3.25, 0.0], [43.75, 4.0, 0.75], [43.75, 3.350481, 0.375], [43.75, 3.625, 0.649519], [46.875, 4.375, -0.649519], [46.875, 4.649519, -0.375], [46.875, 4.0, -0.75], [46.875, 4.75, 0.0], [46.875, 3.625, -0.649519], [46.875, 4.649519, 0.375], [46.875, 3.350481, -0.375], [46.875, 4.375, 0.649519], [46.875, 3.25, 0.0], [46.875, 4.0, 0.75], [46.875, 3.350481, 0.375], [46.875, 3.625, 0.649519], [50.0, 4.375, -0.649519], [50.0, 4.649519, -0.375], [50.0, 4.0, -0.75], [50.0, 4.75, 0.0], [50.0, 3.625, -0.649519], [50.0, 4.649519, 0.375], [50.0, 3.350481, -0.375], [50.0, 4.375, 0.649519], [50.0, 3.25, 0.0], [50.0, 4.0, 0.75], [50.0, 3.350481, 0.375], [50.0, 3.625, 0.649519]]
        # self.quads = [[748, 749, 800, 799], [749, 750, 801, 800], [750, 751, 802, 801], [751, 752, 803, 802], [752, 753, 804, 803], [753, 754, 805, 804], [754, 755, 806, 805], [755, 756, 807, 806], [756, 757, 808, 807], [757, 758, 809, 808], [758, 759, 810, 809], [759, 760, 811, 810], [760, 761, 812, 811], [761, 762, 813, 812], [762, 763, 814, 813], [763, 764, 815, 814], [408, 459, 460, 409], [409, 460, 461, 410], [410, 461, 462, 411], [411, 462, 463, 412], [412, 463, 464, 413], [413, 464, 465, 414], [414, 465, 466, 415], [415, 466, 467, 416], [416, 467, 468, 417], [417, 468, 469, 418], [418, 469, 470, 419], [419, 470, 471, 420], [420, 471, 472, 421], [421, 472, 473, 422], [422, 473, 474, 423], [423, 474, 475, 424], [510, 511, 664, 663], [511, 512, 665, 664], [512, 513, 666, 665], [513, 514, 667, 666], [514, 515, 668, 667], [515, 516, 669, 668], [516, 517, 670, 669], [517, 518, 671, 670], [518, 519, 672, 671], [519, 520, 673, 672], [520, 521, 674, 673], [521, 522, 675, 674], [522, 523, 676, 675], [523, 524, 677, 676], [524, 525, 678, 677], [525, 526, 679, 678], [663, 664, 749, 748], [664, 665, 750, 749], [665, 666, 751, 750], [666, 667, 752, 751], [667, 668, 753, 752], [668, 669, 754, 753], [669, 670, 755, 754], [670, 671, 756, 755], [671, 672, 757, 756], [672, 673, 758, 757], [673, 674, 759, 758], [674, 675, 760, 759], [675, 676, 761, 760], [676, 677, 762, 761], [677, 678, 763, 762], [678, 679, 764, 763], [374, 375, 392, 391], [375, 376, 393, 392], [376, 377, 394, 393], [377, 378, 395, 394], [378, 379, 396, 395], [379, 380, 397, 396], [380, 381, 398, 397], [381, 382, 399, 398], [382, 383, 400, 399], [383, 384, 401, 400], [384, 385, 402, 401], [385, 386, 403, 402], [386, 387, 404, 403], [387, 388, 405, 404], [388, 389, 406, 405], [389, 390, 407, 406], [374, 408, 409, 375], [375, 409, 410, 376], [376, 410, 411, 377], [377, 411, 412, 378], [378, 412, 413, 379], [379, 413, 414, 380], [380, 414, 415, 381], [381, 415, 416, 382], [382, 416, 417, 383], [383, 417, 418, 384], [384, 418, 419, 385], [385, 419, 420, 386], [386, 420, 421, 387], [387, 421, 422, 388], [388, 422, 423, 389], [389, 423, 424, 390], [459, 595, 596, 460], [460, 596, 597, 461], [461, 597, 598, 462], [462, 598, 599, 463], [463, 599, 600, 464], [464, 600, 601, 465], [465, 601, 602, 466], [466, 602, 603, 467], [467, 603, 604, 468], [468, 604, 605, 469], [469, 605, 606, 470], [470, 606, 607, 471], [471, 607, 608, 472], [472, 608, 609, 473], [473, 609, 610, 474], [474, 610, 611, 475], [595, 697, 698, 596], [596, 698, 699, 597], [597, 699, 700, 598], [598, 700, 701, 599], [599, 701, 702, 600], [600, 702, 703, 601], [601, 703, 704, 602], [602, 704, 705, 603], [603, 705, 706, 604], [604, 706, 707, 605], [605, 707, 708, 606], [606, 708, 709, 607], [607, 709, 710, 608], [608, 710, 711, 609], [609, 711, 712, 610], [610, 712, 713, 611], [697, 765, 766, 698], [698, 766, 767, 699], [699, 767, 768, 700], [700, 768, 769, 701], [701, 769, 770, 702], [702, 770, 771, 703], [703, 771, 772, 704], [704, 772, 773, 705], [705, 773, 774, 706], [706, 774, 775, 707], [707, 775, 776, 708], [708, 776, 777, 709], [709, 777, 778, 710], [710, 778, 779, 711], [711, 779, 780, 712], [712, 780, 781, 713], [765, 799, 800, 766], [766, 800, 801, 767], [767, 801, 802, 768], [768, 802, 803, 769], [769, 803, 804, 770], [770, 804, 805, 771], [771, 805, 806, 772], [772, 806, 807, 773], [773, 807, 808, 774], [774, 808, 809, 775], [775, 809, 810, 776], [776, 810, 811, 777], [777, 811, 812, 778], [778, 812, 813, 779], [779, 813, 814, 780], [780, 814, 815, 781], [442, 443, 511, 510], [443, 444, 512, 511], [444, 445, 513, 512], [445, 446, 514, 513], [446, 447, 515, 514], [447, 448, 516, 515], [448, 449, 517, 516], [449, 450, 518, 517], [450, 451, 519, 518], [451, 452, 520, 519], [452, 453, 521, 520], [453, 454, 522, 521], [454, 455, 523, 522], [455, 456, 524, 523], [456, 457, 525, 524], [457, 458, 526, 525], [391, 392, 443, 442], [392, 393, 444, 443], [393, 394, 445, 444], [394, 395, 446, 445], [395, 396, 447, 446], [396, 397, 448, 447], [397, 398, 449, 448], [398, 399, 450, 449], [399, 400, 451, 450], [400, 401, 452, 451], [401, 402, 453, 452], [402, 403, 454, 453], [403, 404, 455, 454], [404, 405, 456, 455], [405, 406, 457, 456], [406, 407, 458, 457]]
        # self.indices = [374, 375, 376, 377, 378, 379, 380, 381, 382, 383, 384, 385, 386, 387, 388, 389, 390, 391, 392, 393, 394, 395, 396, 397, 398, 399, 400, 401, 402, 403, 404, 405, 406, 407, 408, 409, 410, 411, 412, 413, 414, 415, 416, 417, 418, 419, 420, 421, 422, 423, 424, 442, 443, 444, 445, 446, 447, 448, 449, 450, 451, 452, 453, 454, 455, 456, 457, 458, 459, 460, 461, 462, 463, 464, 465, 466, 467, 468, 469, 470, 471, 472, 473, 474, 475, 510, 511, 512, 513, 514, 515, 516, 517, 518, 519, 520, 521, 522, 523, 524, 525, 526, 595, 596, 597, 598, 599, 600, 601, 602, 603, 604, 605, 606, 607, 608, 609, 610, 611, 663, 664, 665, 666, 667, 668, 669, 670, 671, 672, 673, 674, 675, 676, 677, 678, 679, 697, 698, 699, 700, 701, 702, 703, 704, 705, 706, 707, 708, 709, 710, 711, 712, 713, 748, 749, 750, 751, 752, 753, 754, 755, 756, 757, 758, 759, 760, 761, 762, 763, 764, 765, 766, 767, 768, 769, 770, 771, 772, 773, 774, 775, 776, 777, 778, 779, 780, 781, 799, 800, 801, 802, 803, 804, 805, 806, 807, 808, 809, 810, 811, 812, 813, 814, 815]

    def test_new_idx_from_conv_tab(self):
        mesh_test  = [[1 ,2 ,3 ,4], [5, 6 ,7 ,8], [9, 10 ,11, 12]]
        conv_tab_test = [[1, 11],[2, 222],[3, 4],[4, 3],[5, 10],[6, 13],[7, 24],[8, 18],[9, 19],[10, 100],[11, 1],[12, 25]]
        new_mesh = mf.new_idx_from_conv_tab(mesh = mesh_test,tab = conv_tab_test )
        new_mesh_sol = [[11, 222, 4, 3], [10, 13, 24, 18], [19, 100, 1, 25]]
        
        if new_mesh != new_mesh_sol :
            print("- Reindexation du robot mauvaise -")

        self.assertEqual(new_mesh, new_mesh_sol)


    def test_index_from_axis(self): 
        points = [[9.71445147e-16, 4.375, -0.649519], [3.125, 4.375, -0.649519], [6.25, 4.375, -0.649519], [9.375, 4.375, -0.649519], [12.5, 4.375, -0.649519], [15.625, 4.375, -0.649519], [18.75, 4.375, -0.649519], [21.875, 4.375, -0.649519], [25.0, 4.375, -0.649519], [28.125, 4.375, -0.649519], [31.25, 4.375, -0.649519], [34.375, 4.375, -0.649519], [37.5, 4.375, -0.649519], [40.625, 4.375, -0.649519], [43.75, 4.375, -0.649519], [46.875, 4.375, -0.649519], [50.0, 4.375, -0.649519], [1.03240061e-15, 4.649519, -0.375], [3.125, 4.649519, -0.375], [6.25, 4.649519, -0.375], [9.375, 4.649519, -0.375], [12.5, 4.649519, -0.375], [15.625, 4.649519, -0.375], [18.75, 4.649519, -0.375], [21.875, 4.649519, -0.375], [25.0, 4.649519, -0.375], [28.125, 4.649519, -0.375], [31.25, 4.649519, -0.375], [34.375, 4.649519, -0.375], [37.5, 4.649519, -0.375], [40.625, 4.649519, -0.375], [43.75, 4.649519, -0.375], [46.875, 4.649519, -0.375], [50.0, 4.649519, -0.375], [8.8817842e-16, 4.0, -0.75], [3.125, 4.0, -0.75], [6.25, 4.0, -0.75], [9.375, 4.0, -0.75], [12.5, 4.0, -0.75], [15.625, 4.0, -0.75], [18.75, 4.0, -0.75], [21.875, 4.0, -0.75], [25.0, 4.0, -0.75], [28.125, 4.0, -0.75], [31.25, 4.0, -0.75], [34.375, 4.0, -0.75], [37.5, 4.0, -0.75], [40.625, 4.0, -0.75], [43.75, 4.0, -0.75], [46.875, 4.0, -0.75], [50.0, 4.0, -0.75], [1.05471187e-15, 4.75, 0.0], [3.125, 4.75, 0.0], [6.25, 4.75, 0.0], [9.375, 4.75, 0.0], [12.5, 4.75, 0.0], [15.625, 4.75, 0.0], [18.75, 4.75, 0.0], [21.875, 4.75, 0.0], [25.0, 4.75, 0.0], [28.125, 4.75, 0.0], [31.25, 4.75, 0.0], [34.375, 4.75, 0.0], [37.5, 4.75, 0.0], [40.625, 4.75, 0.0], [43.75, 4.75, 0.0], [46.875, 4.75, 0.0], [50.0, 4.75, 0.0], [8.04911693e-16, 3.625, -0.649519], [3.125, 3.625, -0.649519], [6.25, 3.625, -0.649519], [9.375, 3.625, -0.649519], [12.5, 3.625, -0.649519], [15.625, 3.625, -0.649519], [18.75, 3.625, -0.649519], [21.875, 3.625, -0.649519], [25.0, 3.625, -0.649519], [28.125, 3.625, -0.649519], [31.25, 3.625, -0.649519], [34.375, 3.625, -0.649519], [37.5, 3.625, -0.649519], [40.625, 3.625, -0.649519], [43.75, 3.625, -0.649519], [46.875, 3.625, -0.649519], [50.0, 3.625, -0.649519], [1.03240061e-15, 4.649519, 0.375], [3.125, 4.649519, 0.375], [6.25, 4.649519, 0.375], [9.375, 4.649519, 0.375], [12.5, 4.649519, 0.375], [15.625, 4.649519, 0.375], [18.75, 4.649519, 0.375], [21.875, 4.649519, 0.375], [25.0, 4.649519, 0.375], [28.125, 4.649519, 0.375], [31.25, 4.649519, 0.375], [34.375, 4.649519, 0.375], [37.5, 4.649519, 0.375], [40.625, 4.649519, 0.375], [43.75, 4.649519, 0.375], [46.875, 4.649519, 0.375], [50.0, 4.649519, 0.375], [7.4395623e-16, 3.350481, -0.375], [3.125, 3.350481, -0.375], [6.25, 3.350481, -0.375], [9.375, 3.350481, -0.375], [12.5, 3.350481, -0.375], [15.625, 3.350481, -0.375], [18.75, 3.350481, -0.375], [21.875, 3.350481, -0.375], [25.0, 3.350481, -0.375], [28.125, 3.350481, -0.375], [31.25, 3.350481, -0.375], [34.375, 3.350481, -0.375], [37.5, 3.350481, -0.375], [40.625, 3.350481, -0.375], [43.75, 3.350481, -0.375], [46.875, 3.350481, -0.375], [50.0, 3.350481, -0.375], [9.71445147e-16, 4.375, 0.649519], [3.125, 4.375, 0.649519], [6.25, 4.375, 0.649519], [9.375, 4.375, 0.649519], [12.5, 4.375, 0.649519], [15.625, 4.375, 0.649519], [18.75, 4.375, 0.649519], [21.875, 4.375, 0.649519], [25.0, 4.375, 0.649519], [28.125, 4.375, 0.649519], [31.25, 4.375, 0.649519], [34.375, 4.375, 0.649519], [37.5, 4.375, 0.649519], [40.625, 4.375, 0.649519], [43.75, 4.375, 0.649519], [46.875, 4.375, 0.649519], [50.0, 4.375, 0.649519], [7.21644966e-16, 3.25, 0.0], [3.125, 3.25, 0.0], [6.25, 3.25, 0.0], [9.375, 3.25, 0.0], [12.5, 3.25, 0.0], [15.625, 3.25, 0.0], [18.75, 3.25, 0.0], [21.875, 3.25, 0.0], [25.0, 3.25, 0.0], [28.125, 3.25, 0.0], [31.25, 3.25, 0.0], [34.375, 3.25, 0.0], [37.5, 3.25, 0.0], [40.625, 3.25, 0.0], [43.75, 3.25, 0.0], [46.875, 3.25, 0.0], [50.0, 3.25, 0.0], [8.8817842e-16, 4.0, 0.75], [3.125, 4.0, 0.75], [6.25, 4.0, 0.75], [9.375, 4.0, 0.75], [12.5, 4.0, 0.75], [15.625, 4.0, 0.75], [18.75, 4.0, 0.75], [21.875, 4.0, 0.75], [25.0, 4.0, 0.75], [28.125, 4.0, 0.75], [31.25, 4.0, 0.75], [34.375, 4.0, 0.75], [37.5, 4.0, 0.75], [40.625, 4.0, 0.75], [43.75, 4.0, 0.75], [46.875, 4.0, 0.75], [50.0, 4.0, 0.75], [7.4395623e-16, 3.350481, 0.375], [3.125, 3.350481, 0.375], [6.25, 3.350481, 0.375], [9.375, 3.350481, 0.375], [12.5, 3.350481, 0.375], [15.625, 3.350481, 0.375], [18.75, 3.350481, 0.375], [21.875, 3.350481, 0.375], [25.0, 3.350481, 0.375], [28.125, 3.350481, 0.375], [31.25, 3.350481, 0.375], [34.375, 3.350481, 0.375], [37.5, 3.350481, 0.375], [40.625, 3.350481, 0.375], [43.75, 3.350481, 0.375], [46.875, 3.350481, 0.375], [50.0, 3.350481, 0.375], [8.04911693e-16, 3.625, 0.649519], [3.125, 3.625, 0.649519], [6.25, 3.625, 0.649519], [9.375, 3.625, 0.649519], [12.5, 3.625, 0.649519], [15.625, 3.625, 0.649519], [18.75, 3.625, 0.649519], [21.875, 3.625, 0.649519], [25.0, 3.625, 0.649519], [28.125, 3.625, 0.649519], [31.25, 3.625, 0.649519], [34.375, 3.625, 0.649519], [37.5, 3.625, 0.649519], [40.625, 3.625, 0.649519], [43.75, 3.625, 0.649519], [46.875, 3.625, 0.649519], [50.0, 3.625, 0.649519]]
        points_ordered_in_x = [[7.21644966e-16, 3.25, 0.0], [7.4395623e-16, 3.350481, -0.375], [7.4395623e-16, 3.350481, 0.375], [8.04911693e-16, 3.625, -0.649519], [8.04911693e-16, 3.625, 0.649519], [8.8817842e-16, 4.0, -0.75], [8.8817842e-16, 4.0, 0.75], [9.71445147e-16, 4.375, -0.649519], [9.71445147e-16, 4.375, 0.649519], [1.03240061e-15, 4.649519, -0.375], [1.03240061e-15, 4.649519, 0.375], [1.05471187e-15, 4.75, 0.0], [3.125, 4.375, -0.649519], [3.125, 4.649519, -0.375], [3.125, 4.0, -0.75], [3.125, 4.75, 0.0], [3.125, 3.625, -0.649519], [3.125, 4.649519, 0.375], [3.125, 3.350481, -0.375], [3.125, 4.375, 0.649519], [3.125, 3.25, 0.0], [3.125, 4.0, 0.75], [3.125, 3.350481, 0.375], [3.125, 3.625, 0.649519], [6.25, 4.375, -0.649519], [6.25, 4.649519, -0.375], [6.25, 4.0, -0.75], [6.25, 4.75, 0.0], [6.25, 3.625, -0.649519], [6.25, 4.649519, 0.375], [6.25, 3.350481, -0.375], [6.25, 4.375, 0.649519], [6.25, 3.25, 0.0], [6.25, 4.0, 0.75], [6.25, 3.350481, 0.375], [6.25, 3.625, 0.649519], [9.375, 4.375, -0.649519], [9.375, 4.649519, -0.375], [9.375, 4.0, -0.75], [9.375, 4.75, 0.0], [9.375, 3.625, -0.649519], [9.375, 4.649519, 0.375], [9.375, 3.350481, -0.375], [9.375, 4.375, 0.649519], [9.375, 3.25, 0.0], [9.375, 4.0, 0.75], [9.375, 3.350481, 0.375], [9.375, 3.625, 0.649519], [12.5, 4.375, -0.649519], [12.5, 4.649519, -0.375], [12.5, 4.0, -0.75], [12.5, 4.75, 0.0], [12.5, 3.625, -0.649519], [12.5, 4.649519, 0.375], [12.5, 3.350481, -0.375], [12.5, 4.375, 0.649519], [12.5, 3.25, 0.0], [12.5, 4.0, 0.75], [12.5, 3.350481, 0.375], [12.5, 3.625, 0.649519], [15.625, 4.375, -0.649519], [15.625, 4.649519, -0.375], [15.625, 4.0, -0.75], [15.625, 4.75, 0.0], [15.625, 3.625, -0.649519], [15.625, 4.649519, 0.375], [15.625, 3.350481, -0.375], [15.625, 4.375, 0.649519], [15.625, 3.25, 0.0], [15.625, 4.0, 0.75], [15.625, 3.350481, 0.375], [15.625, 3.625, 0.649519], [18.75, 4.375, -0.649519], [18.75, 4.649519, -0.375], [18.75, 4.0, -0.75], [18.75, 4.75, 0.0], [18.75, 3.625, -0.649519], [18.75, 4.649519, 0.375], [18.75, 3.350481, -0.375], [18.75, 4.375, 0.649519], [18.75, 3.25, 0.0], [18.75, 4.0, 0.75], [18.75, 3.350481, 0.375], [18.75, 3.625, 0.649519], [21.875, 4.375, -0.649519], [21.875, 4.649519, -0.375], [21.875, 4.0, -0.75], [21.875, 4.75, 0.0], [21.875, 3.625, -0.649519], [21.875, 4.649519, 0.375], [21.875, 3.350481, -0.375], [21.875, 4.375, 0.649519], [21.875, 3.25, 0.0], [21.875, 4.0, 0.75], [21.875, 3.350481, 0.375], [21.875, 3.625, 0.649519], [25.0, 4.375, -0.649519], [25.0, 4.649519, -0.375], [25.0, 4.0, -0.75], [25.0, 4.75, 0.0], [25.0, 3.625, -0.649519], [25.0, 4.649519, 0.375], [25.0, 3.350481, -0.375], [25.0, 4.375, 0.649519], [25.0, 3.25, 0.0], [25.0, 4.0, 0.75], [25.0, 3.350481, 0.375], [25.0, 3.625, 0.649519], [28.125, 4.375, -0.649519], [28.125, 4.649519, -0.375], [28.125, 4.0, -0.75], [28.125, 4.75, 0.0], [28.125, 3.625, -0.649519], [28.125, 4.649519, 0.375], [28.125, 3.350481, -0.375], [28.125, 4.375, 0.649519], [28.125, 3.25, 0.0], [28.125, 4.0, 0.75], [28.125, 3.350481, 0.375], [28.125, 3.625, 0.649519], [31.25, 4.375, -0.649519], [31.25, 4.649519, -0.375], [31.25, 4.0, -0.75], [31.25, 4.75, 0.0], [31.25, 3.625, -0.649519], [31.25, 4.649519, 0.375], [31.25, 3.350481, -0.375], [31.25, 4.375, 0.649519], [31.25, 3.25, 0.0], [31.25, 4.0, 0.75], [31.25, 3.350481, 0.375], [31.25, 3.625, 0.649519], [34.375, 4.375, -0.649519], [34.375, 4.649519, -0.375], [34.375, 4.0, -0.75], [34.375, 4.75, 0.0], [34.375, 3.625, -0.649519], [34.375, 4.649519, 0.375], [34.375, 3.350481, -0.375], [34.375, 4.375, 0.649519], [34.375, 3.25, 0.0], [34.375, 4.0, 0.75], [34.375, 3.350481, 0.375], [34.375, 3.625, 0.649519], [37.5, 4.375, -0.649519], [37.5, 4.649519, -0.375], [37.5, 4.0, -0.75], [37.5, 4.75, 0.0], [37.5, 3.625, -0.649519], [37.5, 4.649519, 0.375], [37.5, 3.350481, -0.375], [37.5, 4.375, 0.649519], [37.5, 3.25, 0.0], [37.5, 4.0, 0.75], [37.5, 3.350481, 0.375], [37.5, 3.625, 0.649519], [40.625, 4.375, -0.649519], [40.625, 4.649519, -0.375], [40.625, 4.0, -0.75], [40.625, 4.75, 0.0], [40.625, 3.625, -0.649519], [40.625, 4.649519, 0.375], [40.625, 3.350481, -0.375], [40.625, 4.375, 0.649519], [40.625, 3.25, 0.0], [40.625, 4.0, 0.75], [40.625, 3.350481, 0.375], [40.625, 3.625, 0.649519], [43.75, 4.375, -0.649519], [43.75, 4.649519, -0.375], [43.75, 4.0, -0.75], [43.75, 4.75, 0.0], [43.75, 3.625, -0.649519], [43.75, 4.649519, 0.375], [43.75, 3.350481, -0.375], [43.75, 4.375, 0.649519], [43.75, 3.25, 0.0], [43.75, 4.0, 0.75], [43.75, 3.350481, 0.375], [43.75, 3.625, 0.649519], [46.875, 4.375, -0.649519], [46.875, 4.649519, -0.375], [46.875, 4.0, -0.75], [46.875, 4.75, 0.0], [46.875, 3.625, -0.649519], [46.875, 4.649519, 0.375], [46.875, 3.350481, -0.375], [46.875, 4.375, 0.649519], [46.875, 3.25, 0.0], [46.875, 4.0, 0.75], [46.875, 3.350481, 0.375], [46.875, 3.625, 0.649519], [50.0, 4.375, -0.649519], [50.0, 4.649519, -0.375], [50.0, 4.0, -0.75], [50.0, 4.75, 0.0], [50.0, 3.625, -0.649519], [50.0, 4.649519, 0.375], [50.0, 3.350481, -0.375], [50.0, 4.375, 0.649519], [50.0, 3.25, 0.0], [50.0, 4.0, 0.75], [50.0, 3.350481, 0.375], [50.0, 3.625, 0.649519]]
        points_ordered_in_y = [[7.21644966e-16, 3.25, 0.0], [3.125, 3.25, 0.0], [6.25, 3.25, 0.0], [9.375, 3.25, 0.0], [12.5, 3.25, 0.0], [15.625, 3.25, 0.0], [18.75, 3.25, 0.0], [21.875, 3.25, 0.0], [25.0, 3.25, 0.0], [28.125, 3.25, 0.0], [31.25, 3.25, 0.0], [34.375, 3.25, 0.0], [37.5, 3.25, 0.0], [40.625, 3.25, 0.0], [43.75, 3.25, 0.0], [46.875, 3.25, 0.0], [50.0, 3.25, 0.0], [7.4395623e-16, 3.350481, -0.375], [3.125, 3.350481, -0.375], [6.25, 3.350481, -0.375], [9.375, 3.350481, -0.375], [12.5, 3.350481, -0.375], [15.625, 3.350481, -0.375], [18.75, 3.350481, -0.375], [21.875, 3.350481, -0.375], [25.0, 3.350481, -0.375], [28.125, 3.350481, -0.375], [31.25, 3.350481, -0.375], [34.375, 3.350481, -0.375], [37.5, 3.350481, -0.375], [40.625, 3.350481, -0.375], [43.75, 3.350481, -0.375], [46.875, 3.350481, -0.375], [50.0, 3.350481, -0.375], [7.4395623e-16, 3.350481, 0.375], [3.125, 3.350481, 0.375], [6.25, 3.350481, 0.375], [9.375, 3.350481, 0.375], [12.5, 3.350481, 0.375], [15.625, 3.350481, 0.375], [18.75, 3.350481, 0.375], [21.875, 3.350481, 0.375], [25.0, 3.350481, 0.375], [28.125, 3.350481, 0.375], [31.25, 3.350481, 0.375], [34.375, 3.350481, 0.375], [37.5, 3.350481, 0.375], [40.625, 3.350481, 0.375], [43.75, 3.350481, 0.375], [46.875, 3.350481, 0.375], [50.0, 3.350481, 0.375], [8.04911693e-16, 3.625, -0.649519], [3.125, 3.625, -0.649519], [6.25, 3.625, -0.649519], [9.375, 3.625, -0.649519], [12.5, 3.625, -0.649519], [15.625, 3.625, -0.649519], [18.75, 3.625, -0.649519], [21.875, 3.625, -0.649519], [25.0, 3.625, -0.649519], [28.125, 3.625, -0.649519], [31.25, 3.625, -0.649519], [34.375, 3.625, -0.649519], [37.5, 3.625, -0.649519], [40.625, 3.625, -0.649519], [43.75, 3.625, -0.649519], [46.875, 3.625, -0.649519], [50.0, 3.625, -0.649519], [8.04911693e-16, 3.625, 0.649519], [3.125, 3.625, 0.649519], [6.25, 3.625, 0.649519], [9.375, 3.625, 0.649519], [12.5, 3.625, 0.649519], [15.625, 3.625, 0.649519], [18.75, 3.625, 0.649519], [21.875, 3.625, 0.649519], [25.0, 3.625, 0.649519], [28.125, 3.625, 0.649519], [31.25, 3.625, 0.649519], [34.375, 3.625, 0.649519], [37.5, 3.625, 0.649519], [40.625, 3.625, 0.649519], [43.75, 3.625, 0.649519], [46.875, 3.625, 0.649519], [50.0, 3.625, 0.649519], [8.8817842e-16, 4.0, -0.75], [3.125, 4.0, -0.75], [6.25, 4.0, -0.75], [9.375, 4.0, -0.75], [12.5, 4.0, -0.75], [15.625, 4.0, -0.75], [18.75, 4.0, -0.75], [21.875, 4.0, -0.75], [25.0, 4.0, -0.75], [28.125, 4.0, -0.75], [31.25, 4.0, -0.75], [34.375, 4.0, -0.75], [37.5, 4.0, -0.75], [40.625, 4.0, -0.75], [43.75, 4.0, -0.75], [46.875, 4.0, -0.75], [50.0, 4.0, -0.75], [8.8817842e-16, 4.0, 0.75], [3.125, 4.0, 0.75], [6.25, 4.0, 0.75], [9.375, 4.0, 0.75], [12.5, 4.0, 0.75], [15.625, 4.0, 0.75], [18.75, 4.0, 0.75], [21.875, 4.0, 0.75], [25.0, 4.0, 0.75], [28.125, 4.0, 0.75], [31.25, 4.0, 0.75], [34.375, 4.0, 0.75], [37.5, 4.0, 0.75], [40.625, 4.0, 0.75], [43.75, 4.0, 0.75], [46.875, 4.0, 0.75], [50.0, 4.0, 0.75], [9.71445147e-16, 4.375, -0.649519], [3.125, 4.375, -0.649519], [6.25, 4.375, -0.649519], [9.375, 4.375, -0.649519], [12.5, 4.375, -0.649519], [15.625, 4.375, -0.649519], [18.75, 4.375, -0.649519], [21.875, 4.375, -0.649519], [25.0, 4.375, -0.649519], [28.125, 4.375, -0.649519], [31.25, 4.375, -0.649519], [34.375, 4.375, -0.649519], [37.5, 4.375, -0.649519], [40.625, 4.375, -0.649519], [43.75, 4.375, -0.649519], [46.875, 4.375, -0.649519], [50.0, 4.375, -0.649519], [9.71445147e-16, 4.375, 0.649519], [3.125, 4.375, 0.649519], [6.25, 4.375, 0.649519], [9.375, 4.375, 0.649519], [12.5, 4.375, 0.649519], [15.625, 4.375, 0.649519], [18.75, 4.375, 0.649519], [21.875, 4.375, 0.649519], [25.0, 4.375, 0.649519], [28.125, 4.375, 0.649519], [31.25, 4.375, 0.649519], [34.375, 4.375, 0.649519], [37.5, 4.375, 0.649519], [40.625, 4.375, 0.649519], [43.75, 4.375, 0.649519], [46.875, 4.375, 0.649519], [50.0, 4.375, 0.649519], [1.03240061e-15, 4.649519, -0.375], [3.125, 4.649519, -0.375], [6.25, 4.649519, -0.375], [9.375, 4.649519, -0.375], [12.5, 4.649519, -0.375], [15.625, 4.649519, -0.375], [18.75, 4.649519, -0.375], [21.875, 4.649519, -0.375], [25.0, 4.649519, -0.375], [28.125, 4.649519, -0.375], [31.25, 4.649519, -0.375], [34.375, 4.649519, -0.375], [37.5, 4.649519, -0.375], [40.625, 4.649519, -0.375], [43.75, 4.649519, -0.375], [46.875, 4.649519, -0.375], [50.0, 4.649519, -0.375], [1.03240061e-15, 4.649519, 0.375], [3.125, 4.649519, 0.375], [6.25, 4.649519, 0.375], [9.375, 4.649519, 0.375], [12.5, 4.649519, 0.375], [15.625, 4.649519, 0.375], [18.75, 4.649519, 0.375], [21.875, 4.649519, 0.375], [25.0, 4.649519, 0.375], [28.125, 4.649519, 0.375], [31.25, 4.649519, 0.375], [34.375, 4.649519, 0.375], [37.5, 4.649519, 0.375], [40.625, 4.649519, 0.375], [43.75, 4.649519, 0.375], [46.875, 4.649519, 0.375], [50.0, 4.649519, 0.375], [1.05471187e-15, 4.75, 0.0], [3.125, 4.75, 0.0], [6.25, 4.75, 0.0], [9.375, 4.75, 0.0], [12.5, 4.75, 0.0], [15.625, 4.75, 0.0], [18.75, 4.75, 0.0], [21.875, 4.75, 0.0], [25.0, 4.75, 0.0], [28.125, 4.75, 0.0], [31.25, 4.75, 0.0], [34.375, 4.75, 0.0], [37.5, 4.75, 0.0], [40.625, 4.75, 0.0], [43.75, 4.75, 0.0], [46.875, 4.75, 0.0], [50.0, 4.75, 0.0]]
        points_ordered_in_z = [[8.8817842e-16, 4.0, -0.75], [3.125, 4.0, -0.75], [6.25, 4.0, -0.75], [9.375, 4.0, -0.75], [12.5, 4.0, -0.75], [15.625, 4.0, -0.75], [18.75, 4.0, -0.75], [21.875, 4.0, -0.75], [25.0, 4.0, -0.75], [28.125, 4.0, -0.75], [31.25, 4.0, -0.75], [34.375, 4.0, -0.75], [37.5, 4.0, -0.75], [40.625, 4.0, -0.75], [43.75, 4.0, -0.75], [46.875, 4.0, -0.75], [50.0, 4.0, -0.75], [9.71445147e-16, 4.375, -0.649519], [3.125, 4.375, -0.649519], [6.25, 4.375, -0.649519], [9.375, 4.375, -0.649519], [12.5, 4.375, -0.649519], [15.625, 4.375, -0.649519], [18.75, 4.375, -0.649519], [21.875, 4.375, -0.649519], [25.0, 4.375, -0.649519], [28.125, 4.375, -0.649519], [31.25, 4.375, -0.649519], [34.375, 4.375, -0.649519], [37.5, 4.375, -0.649519], [40.625, 4.375, -0.649519], [43.75, 4.375, -0.649519], [46.875, 4.375, -0.649519], [50.0, 4.375, -0.649519], [8.04911693e-16, 3.625, -0.649519], [3.125, 3.625, -0.649519], [6.25, 3.625, -0.649519], [9.375, 3.625, -0.649519], [12.5, 3.625, -0.649519], [15.625, 3.625, -0.649519], [18.75, 3.625, -0.649519], [21.875, 3.625, -0.649519], [25.0, 3.625, -0.649519], [28.125, 3.625, -0.649519], [31.25, 3.625, -0.649519], [34.375, 3.625, -0.649519], [37.5, 3.625, -0.649519], [40.625, 3.625, -0.649519], [43.75, 3.625, -0.649519], [46.875, 3.625, -0.649519], [50.0, 3.625, -0.649519], [1.03240061e-15, 4.649519, -0.375], [3.125, 4.649519, -0.375], [6.25, 4.649519, -0.375], [9.375, 4.649519, -0.375], [12.5, 4.649519, -0.375], [15.625, 4.649519, -0.375], [18.75, 4.649519, -0.375], [21.875, 4.649519, -0.375], [25.0, 4.649519, -0.375], [28.125, 4.649519, -0.375], [31.25, 4.649519, -0.375], [34.375, 4.649519, -0.375], [37.5, 4.649519, -0.375], [40.625, 4.649519, -0.375], [43.75, 4.649519, -0.375], [46.875, 4.649519, -0.375], [50.0, 4.649519, -0.375], [7.4395623e-16, 3.350481, -0.375], [3.125, 3.350481, -0.375], [6.25, 3.350481, -0.375], [9.375, 3.350481, -0.375], [12.5, 3.350481, -0.375], [15.625, 3.350481, -0.375], [18.75, 3.350481, -0.375], [21.875, 3.350481, -0.375], [25.0, 3.350481, -0.375], [28.125, 3.350481, -0.375], [31.25, 3.350481, -0.375], [34.375, 3.350481, -0.375], [37.5, 3.350481, -0.375], [40.625, 3.350481, -0.375], [43.75, 3.350481, -0.375], [46.875, 3.350481, -0.375], [50.0, 3.350481, -0.375], [1.05471187e-15, 4.75, 0.0], [3.125, 4.75, 0.0], [6.25, 4.75, 0.0], [9.375, 4.75, 0.0], [12.5, 4.75, 0.0], [15.625, 4.75, 0.0], [18.75, 4.75, 0.0], [21.875, 4.75, 0.0], [25.0, 4.75, 0.0], [28.125, 4.75, 0.0], [31.25, 4.75, 0.0], [34.375, 4.75, 0.0], [37.5, 4.75, 0.0], [40.625, 4.75, 0.0], [43.75, 4.75, 0.0], [46.875, 4.75, 0.0], [50.0, 4.75, 0.0], [7.21644966e-16, 3.25, 0.0], [3.125, 3.25, 0.0], [6.25, 3.25, 0.0], [9.375, 3.25, 0.0], [12.5, 3.25, 0.0], [15.625, 3.25, 0.0], [18.75, 3.25, 0.0], [21.875, 3.25, 0.0], [25.0, 3.25, 0.0], [28.125, 3.25, 0.0], [31.25, 3.25, 0.0], [34.375, 3.25, 0.0], [37.5, 3.25, 0.0], [40.625, 3.25, 0.0], [43.75, 3.25, 0.0], [46.875, 3.25, 0.0], [50.0, 3.25, 0.0], [1.03240061e-15, 4.649519, 0.375], [3.125, 4.649519, 0.375], [6.25, 4.649519, 0.375], [9.375, 4.649519, 0.375], [12.5, 4.649519, 0.375], [15.625, 4.649519, 0.375], [18.75, 4.649519, 0.375], [21.875, 4.649519, 0.375], [25.0, 4.649519, 0.375], [28.125, 4.649519, 0.375], [31.25, 4.649519, 0.375], [34.375, 4.649519, 0.375], [37.5, 4.649519, 0.375], [40.625, 4.649519, 0.375], [43.75, 4.649519, 0.375], [46.875, 4.649519, 0.375], [50.0, 4.649519, 0.375], [7.4395623e-16, 3.350481, 0.375], [3.125, 3.350481, 0.375], [6.25, 3.350481, 0.375], [9.375, 3.350481, 0.375], [12.5, 3.350481, 0.375], [15.625, 3.350481, 0.375], [18.75, 3.350481, 0.375], [21.875, 3.350481, 0.375], [25.0, 3.350481, 0.375], [28.125, 3.350481, 0.375], [31.25, 3.350481, 0.375], [34.375, 3.350481, 0.375], [37.5, 3.350481, 0.375], [40.625, 3.350481, 0.375], [43.75, 3.350481, 0.375], [46.875, 3.350481, 0.375], [50.0, 3.350481, 0.375], [9.71445147e-16, 4.375, 0.649519], [3.125, 4.375, 0.649519], [6.25, 4.375, 0.649519], [9.375, 4.375, 0.649519], [12.5, 4.375, 0.649519], [15.625, 4.375, 0.649519], [18.75, 4.375, 0.649519], [21.875, 4.375, 0.649519], [25.0, 4.375, 0.649519], [28.125, 4.375, 0.649519], [31.25, 4.375, 0.649519], [34.375, 4.375, 0.649519], [37.5, 4.375, 0.649519], [40.625, 4.375, 0.649519], [43.75, 4.375, 0.649519], [46.875, 4.375, 0.649519], [50.0, 4.375, 0.649519], [8.04911693e-16, 3.625, 0.649519], [3.125, 3.625, 0.649519], [6.25, 3.625, 0.649519], [9.375, 3.625, 0.649519], [12.5, 3.625, 0.649519], [15.625, 3.625, 0.649519], [18.75, 3.625, 0.649519], [21.875, 3.625, 0.649519], [25.0, 3.625, 0.649519], [28.125, 3.625, 0.649519], [31.25, 3.625, 0.649519], [34.375, 3.625, 0.649519], [37.5, 3.625, 0.649519], [40.625, 3.625, 0.649519], [43.75, 3.625, 0.649519], [46.875, 3.625, 0.649519], [50.0, 3.625, 0.649519], [8.8817842e-16, 4.0, 0.75], [3.125, 4.0, 0.75], [6.25, 4.0, 0.75], [9.375, 4.0, 0.75], [12.5, 4.0, 0.75], [15.625, 4.0, 0.75], [18.75, 4.0, 0.75], [21.875, 4.0, 0.75], [25.0, 4.0, 0.75], [28.125, 4.0, 0.75], [31.25, 4.0, 0.75], [34.375, 4.0, 0.75], [37.5, 4.0, 0.75], [40.625, 4.0, 0.75], [43.75, 4.0, 0.75], [46.875, 4.0, 0.75], [50.0, 4.0, 0.75]]
        # quads = [[748, 749, 800, 799], [749, 750, 801, 800], [750, 751, 802, 801], [751, 752, 803, 802], [752, 753, 804, 803], [753, 754, 805, 804], [754, 755, 806, 805], [755, 756, 807, 806], [756, 757, 808, 807], [757, 758, 809, 808], [758, 759, 810, 809], [759, 760, 811, 810], [760, 761, 812, 811], [761, 762, 813, 812], [762, 763, 814, 813], [763, 764, 815, 814], [408, 459, 460, 409], [409, 460, 461, 410], [410, 461, 462, 411], [411, 462, 463, 412], [412, 463, 464, 413], [413, 464, 465, 414], [414, 465, 466, 415], [415, 466, 467, 416], [416, 467, 468, 417], [417, 468, 469, 418], [418, 469, 470, 419], [419, 470, 471, 420], [420, 471, 472, 421], [421, 472, 473, 422], [422, 473, 474, 423], [423, 474, 475, 424], [510, 511, 664, 663], [511, 512, 665, 664], [512, 513, 666, 665], [513, 514, 667, 666], [514, 515, 668, 667], [515, 516, 669, 668], [516, 517, 670, 669], [517, 518, 671, 670], [518, 519, 672, 671], [519, 520, 673, 672], [520, 521, 674, 673], [521, 522, 675, 674], [522, 523, 676, 675], [523, 524, 677, 676], [524, 525, 678, 677], [525, 526, 679, 678], [663, 664, 749, 748], [664, 665, 750, 749], [665, 666, 751, 750], [666, 667, 752, 751], [667, 668, 753, 752], [668, 669, 754, 753], [669, 670, 755, 754], [670, 671, 756, 755], [671, 672, 757, 756], [672, 673, 758, 757], [673, 674, 759, 758], [674, 675, 760, 759], [675, 676, 761, 760], [676, 677, 762, 761], [677, 678, 763, 762], [678, 679, 764, 763], [374, 375, 392, 391], [375, 376, 393, 392], [376, 377, 394, 393], [377, 378, 395, 394], [378, 379, 396, 395], [379, 380, 397, 396], [380, 381, 398, 397], [381, 382, 399, 398], [382, 383, 400, 399], [383, 384, 401, 400], [384, 385, 402, 401], [385, 386, 403, 402], [386, 387, 404, 403], [387, 388, 405, 404], [388, 389, 406, 405], [389, 390, 407, 406], [374, 408, 409, 375], [375, 409, 410, 376], [376, 410, 411, 377], [377, 411, 412, 378], [378, 412, 413, 379], [379, 413, 414, 380], [380, 414, 415, 381], [381, 415, 416, 382], [382, 416, 417, 383], [383, 417, 418, 384], [384, 418, 419, 385], [385, 419, 420, 386], [386, 420, 421, 387], [387, 421, 422, 388], [388, 422, 423, 389], [389, 423, 424, 390], [459, 595, 596, 460], [460, 596, 597, 461], [461, 597, 598, 462], [462, 598, 599, 463], [463, 599, 600, 464], [464, 600, 601, 465], [465, 601, 602, 466], [466, 602, 603, 467], [467, 603, 604, 468], [468, 604, 605, 469], [469, 605, 606, 470], [470, 606, 607, 471], [471, 607, 608, 472], [472, 608, 609, 473], [473, 609, 610, 474], [474, 610, 611, 475], [595, 697, 698, 596], [596, 698, 699, 597], [597, 699, 700, 598], [598, 700, 701, 599], [599, 701, 702, 600], [600, 702, 703, 601], [601, 703, 704, 602], [602, 704, 705, 603], [603, 705, 706, 604], [604, 706, 707, 605], [605, 707, 708, 606], [606, 708, 709, 607], [607, 709, 710, 608], [608, 710, 711, 609], [609, 711, 712, 610], [610, 712, 713, 611], [697, 765, 766, 698], [698, 766, 767, 699], [699, 767, 768, 700], [700, 768, 769, 701], [701, 769, 770, 702], [702, 770, 771, 703], [703, 771, 772, 704], [704, 772, 773, 705], [705, 773, 774, 706], [706, 774, 775, 707], [707, 775, 776, 708], [708, 776, 777, 709], [709, 777, 778, 710], [710, 778, 779, 711], [711, 779, 780, 712], [712, 780, 781, 713], [765, 799, 800, 766], [766, 800, 801, 767], [767, 801, 802, 768], [768, 802, 803, 769], [769, 803, 804, 770], [770, 804, 805, 771], [771, 805, 806, 772], [772, 806, 807, 773], [773, 807, 808, 774], [774, 808, 809, 775], [775, 809, 810, 776], [776, 810, 811, 777], [777, 811, 812, 778], [778, 812, 813, 779], [779, 813, 814, 780], [780, 814, 815, 781], [442, 443, 511, 510], [443, 444, 512, 511], [444, 445, 513, 512], [445, 446, 514, 513], [446, 447, 515, 514], [447, 448, 516, 515], [448, 449, 517, 516], [449, 450, 518, 517], [450, 451, 519, 518], [451, 452, 520, 519], [452, 453, 521, 520], [453, 454, 522, 521], [454, 455, 523, 522], [455, 456, 524, 523], [456, 457, 525, 524], [457, 458, 526, 525], [391, 392, 443, 442], [392, 393, 444, 443], [393, 394, 445, 444], [394, 395, 446, 445], [395, 396, 447, 446], [396, 397, 448, 447], [397, 398, 449, 448], [398, 399, 450, 449], [399, 400, 451, 450], [400, 401, 452, 451], [401, 402, 453, 452], [402, 403, 454, 453], [403, 404, 455, 454], [404, 405, 456, 455], [405, 406, 457, 456], [406, 407, 458, 457]]
        indices = [374, 375, 376, 377, 378, 379, 380, 381, 382, 383, 384, 385, 386, 387, 388, 389, 390, 391, 392, 393, 394, 395, 396, 397, 398, 399, 400, 401, 402, 403, 404, 405, 406, 407, 408, 409, 410, 411, 412, 413, 414, 415, 416, 417, 418, 419, 420, 421, 422, 423, 424, 442, 443, 444, 445, 446, 447, 448, 449, 450, 451, 452, 453, 454, 455, 456, 457, 458, 459, 460, 461, 462, 463, 464, 465, 466, 467, 468, 469, 470, 471, 472, 473, 474, 475, 510, 511, 512, 513, 514, 515, 516, 517, 518, 519, 520, 521, 522, 523, 524, 525, 526, 595, 596, 597, 598, 599, 600, 601, 602, 603, 604, 605, 606, 607, 608, 609, 610, 611, 663, 664, 665, 666, 667, 668, 669, 670, 671, 672, 673, 674, 675, 676, 677, 678, 679, 697, 698, 699, 700, 701, 702, 703, 704, 705, 706, 707, 708, 709, 710, 711, 712, 713, 748, 749, 750, 751, 752, 753, 754, 755, 756, 757, 758, 759, 760, 761, 762, 763, 764, 765, 766, 767, 768, 769, 770, 771, 772, 773, 774, 775, 776, 777, 778, 779, 780, 781, 799, 800, 801, 802, 803, 804, 805, 806, 807, 808, 809, 810, 811, 812, 813, 814, 815]

        [points_in_x, conv_tab_x ] = mf.index_from_axis(points = points ,axis=0,old_indices = indices)
        if points_in_x != points_ordered_in_x :
            print("- Reordonnation des points celon x fausse -")
        self.assertEqual(points_in_x, points_ordered_in_x)

        [points_in_y, conv_tab_y ] = mf.index_from_axis(points = points ,axis=1,old_indices = indices)
        if points_in_y != points_ordered_in_y :
            print("- Reordonnation des points celon y fausse -")
        self.assertEqual(points_in_y, points_ordered_in_y)

        [points_in_z, conv_tab_z ] = mf.index_from_axis(points = points ,axis=2,old_indices = indices)
        if points_in_z != points_ordered_in_z :
            print("- Reordonnation des points celon z fausse -")
        self.assertEqual(points_in_z, points_ordered_in_z)


    def test_quad_2_triangles(self) :
        quads = [[748, 749, 800, 799], [749, 750, 801, 800], [750, 751, 802, 801], [751, 752, 803, 802], [752, 753, 804, 803], [753, 754, 805, 804], [754, 755, 806, 805], [755, 756, 807, 806], [756, 757, 808, 807], [757, 758, 809, 808], [758, 759, 810, 809], [759, 760, 811, 810], [760, 761, 812, 811], [761, 762, 813, 812], [762, 763, 814, 813], [763, 764, 815, 814], [408, 459, 460, 409], [409, 460, 461, 410], [410, 461, 462, 411], [411, 462, 463, 412], [412, 463, 464, 413], [413, 464, 465, 414], [414, 465, 466, 415], [415, 466, 467, 416], [416, 467, 468, 417], [417, 468, 469, 418], [418, 469, 470, 419], [419, 470, 471, 420], [420, 471, 472, 421], [421, 472, 473, 422], [422, 473, 474, 423], [423, 474, 475, 424], [510, 511, 664, 663], [511, 512, 665, 664], [512, 513, 666, 665], [513, 514, 667, 666], [514, 515, 668, 667], [515, 516, 669, 668], [516, 517, 670, 669], [517, 518, 671, 670], [518, 519, 672, 671], [519, 520, 673, 672], [520, 521, 674, 673], [521, 522, 675, 674], [522, 523, 676, 675], [523, 524, 677, 676], [524, 525, 678, 677], [525, 526, 679, 678], [663, 664, 749, 748], [664, 665, 750, 749], [665, 666, 751, 750], [666, 667, 752, 751], [667, 668, 753, 752], [668, 669, 754, 753], [669, 670, 755, 754], [670, 671, 756, 755], [671, 672, 757, 756], [672, 673, 758, 757], [673, 674, 759, 758], [674, 675, 760, 759], [675, 676, 761, 760], [676, 677, 762, 761], [677, 678, 763, 762], [678, 679, 764, 763], [374, 375, 392, 391], [375, 376, 393, 392], [376, 377, 394, 393], [377, 378, 395, 394], [378, 379, 396, 395], [379, 380, 397, 396], [380, 381, 398, 397], [381, 382, 399, 398], [382, 383, 400, 399], [383, 384, 401, 400], [384, 385, 402, 401], [385, 386, 403, 402], [386, 387, 404, 403], [387, 388, 405, 404], [388, 389, 406, 405], [389, 390, 407, 406], [374, 408, 409, 375], [375, 409, 410, 376], [376, 410, 411, 377], [377, 411, 412, 378], [378, 412, 413, 379], [379, 413, 414, 380], [380, 414, 415, 381], [381, 415, 416, 382], [382, 416, 417, 383], [383, 417, 418, 384], [384, 418, 419, 385], [385, 419, 420, 386], [386, 420, 421, 387], [387, 421, 422, 388], [388, 422, 423, 389], [389, 423, 424, 390], [459, 595, 596, 460], [460, 596, 597, 461], [461, 597, 598, 462], [462, 598, 599, 463], [463, 599, 600, 464], [464, 600, 601, 465], [465, 601, 602, 466], [466, 602, 603, 467], [467, 603, 604, 468], [468, 604, 605, 469], [469, 605, 606, 470], [470, 606, 607, 471], [471, 607, 608, 472], [472, 608, 609, 473], [473, 609, 610, 474], [474, 610, 611, 475], [595, 697, 698, 596], [596, 698, 699, 597], [597, 699, 700, 598], [598, 700, 701, 599], [599, 701, 702, 600], [600, 702, 703, 601], [601, 703, 704, 602], [602, 704, 705, 603], [603, 705, 706, 604], [604, 706, 707, 605], [605, 707, 708, 606], [606, 708, 709, 607], [607, 709, 710, 608], [608, 710, 711, 609], [609, 711, 712, 610], [610, 712, 713, 611], [697, 765, 766, 698], [698, 766, 767, 699], [699, 767, 768, 700], [700, 768, 769, 701], [701, 769, 770, 702], [702, 770, 771, 703], [703, 771, 772, 704], [704, 772, 773, 705], [705, 773, 774, 706], [706, 774, 775, 707], [707, 775, 776, 708], [708, 776, 777, 709], [709, 777, 778, 710], [710, 778, 779, 711], [711, 779, 780, 712], [712, 780, 781, 713], [765, 799, 800, 766], [766, 800, 801, 767], [767, 801, 802, 768], [768, 802, 803, 769], [769, 803, 804, 770], [770, 804, 805, 771], [771, 805, 806, 772], [772, 806, 807, 773], [773, 807, 808, 774], [774, 808, 809, 775], [775, 809, 810, 776], [776, 810, 811, 777], [777, 811, 812, 778], [778, 812, 813, 779], [779, 813, 814, 780], [780, 814, 815, 781], [442, 443, 511, 510], [443, 444, 512, 511], [444, 445, 513, 512], [445, 446, 514, 513], [446, 447, 515, 514], [447, 448, 516, 515], [448, 449, 517, 516], [449, 450, 518, 517], [450, 451, 519, 518], [451, 452, 520, 519], [452, 453, 521, 520], [453, 454, 522, 521], [454, 455, 523, 522], [455, 456, 524, 523], [456, 457, 525, 524], [457, 458, 526, 525], [391, 392, 443, 442], [392, 393, 444, 443], [393, 394, 445, 444], [394, 395, 446, 445], [395, 396, 447, 446], [396, 397, 448, 447], [397, 398, 449, 448], [398, 399, 450, 449], [399, 400, 451, 450], [400, 401, 452, 451], [401, 402, 453, 452], [402, 403, 454, 453], [403, 404, 455, 454], [404, 405, 456, 455], [405, 406, 457, 456], [406, 407, 458, 457]]
        triangles = [[748, 749, 800], [800, 799, 748], [749, 750, 801], [801, 800, 749], [750, 751, 802], [802, 801, 750], [751, 752, 803], [803, 802, 751], [752, 753, 804], [804, 803, 752], [753, 754, 805], [805, 804, 753], [754, 755, 806], [806, 805, 754], [755, 756, 807], [807, 806, 755], [756, 757, 808], [808, 807, 756], [757, 758, 809], [809, 808, 757], [758, 759, 810], [810, 809, 758], [759, 760, 811], [811, 810, 759], [760, 761, 812], [812, 811, 760], [761, 762, 813], [813, 812, 761], [762, 763, 814], [814, 813, 762], [763, 764, 815], [815, 814, 763], [408, 459, 460], [460, 409, 408], [409, 460, 461], [461, 410, 409], [410, 461, 462], [462, 411, 410], [411, 462, 463], [463, 412, 411], [412, 463, 464], [464, 413, 412], [413, 464, 465], [465, 414, 413], [414, 465, 466], [466, 415, 414], [415, 466, 467], [467, 416, 415], [416, 467, 468], [468, 417, 416], [417, 468, 469], [469, 418, 417], [418, 469, 470], [470, 419, 418], [419, 470, 471], [471, 420, 419], [420, 471, 472], [472, 421, 420], [421, 472, 473], [473, 422, 421], [422, 473, 474], [474, 423, 422], [423, 474, 475], [475, 424, 423], [510, 511, 664], [664, 663, 510], [511, 512, 665], [665, 664, 511], [512, 513, 666], [666, 665, 512], [513, 514, 667], [667, 666, 513], [514, 515, 668], [668, 667, 514], [515, 516, 669], [669, 668, 515], [516, 517, 670], [670, 669, 516], [517, 518, 671], [671, 670, 517], [518, 519, 672], [672, 671, 518], [519, 520, 673], [673, 672, 519], [520, 521, 674], [674, 673, 520], [521, 522, 675], [675, 674, 521], [522, 523, 676], [676, 675, 522], [523, 524, 677], [677, 676, 523], [524, 525, 678], [678, 677, 524], [525, 526, 679], [679, 678, 525], [663, 664, 749], [749, 748, 663], [664, 665, 750], [750, 749, 664], [665, 666, 751], [751, 750, 665], [666, 667, 752], [752, 751, 666], [667, 668, 753], [753, 752, 667], [668, 669, 754], [754, 753, 668], [669, 670, 755], [755, 754, 669], [670, 671, 756], [756, 755, 670], [671, 672, 757], [757, 756, 671], [672, 673, 758], [758, 757, 672], [673, 674, 759], [759, 758, 673], [674, 675, 760], [760, 759, 674], [675, 676, 761], [761, 760, 675], [676, 677, 762], [762, 761, 676], [677, 678, 763], [763, 762, 677], [678, 679, 764], [764, 763, 678], [374, 375, 392], [392, 391, 374], [375, 376, 393], [393, 392, 375], [376, 377, 394], [394, 393, 376], [377, 378, 395], [395, 394, 377], [378, 379, 396], [396, 395, 378], [379, 380, 397], [397, 396, 379], [380, 381, 398], [398, 397, 380], [381, 382, 399], [399, 398, 381], [382, 383, 400], [400, 399, 382], [383, 384, 401], [401, 400, 383], [384, 385, 402], [402, 401, 384], [385, 386, 403], [403, 402, 385], [386, 387, 404], [404, 403, 386], [387, 388, 405], [405, 404, 387], [388, 389, 406], [406, 405, 388], [389, 390, 407], [407, 406, 389], [374, 408, 409], [409, 375, 374], [375, 409, 410], [410, 376, 375], [376, 410, 411], [411, 377, 376], [377, 411, 412], [412, 378, 377], [378, 412, 413], [413, 379, 378], [379, 413, 414], [414, 380, 379], [380, 414, 415], [415, 381, 380], [381, 415, 416], [416, 382, 381], [382, 416, 417], [417, 383, 382], [383, 417, 418], [418, 384, 383], [384, 418, 419], [419, 385, 384], [385, 419, 420], [420, 386, 385], [386, 420, 421], [421, 387, 386], [387, 421, 422], [422, 388, 387], [388, 422, 423], [423, 389, 388], [389, 423, 424], [424, 390, 389], [459, 595, 596], [596, 460, 459], [460, 596, 597], [597, 461, 460], [461, 597, 598], [598, 462, 461], [462, 598, 599], [599, 463, 462], [463, 599, 600], [600, 464, 463], [464, 600, 601], [601, 465, 464], [465, 601, 602], [602, 466, 465], [466, 602, 603], [603, 467, 466], [467, 603, 604], [604, 468, 467], [468, 604, 605], [605, 469, 468], [469, 605, 606], [606, 470, 469], [470, 606, 607], [607, 471, 470], [471, 607, 608], [608, 472, 471], [472, 608, 609], [609, 473, 472], [473, 609, 610], [610, 474, 473], [474, 610, 611], [611, 475, 474], [595, 697, 698], [698, 596, 595], [596, 698, 699], [699, 597, 596], [597, 699, 700], [700, 598, 597], [598, 700, 701], [701, 599, 598], [599, 701, 702], [702, 600, 599], [600, 702, 703], [703, 601, 600], [601, 703, 704], [704, 602, 601], [602, 704, 705], [705, 603, 602], [603, 705, 706], [706, 604, 603], [604, 706, 707], [707, 605, 604], [605, 707, 708], [708, 606, 605], [606, 708, 709], [709, 607, 606], [607, 709, 710], [710, 608, 607], [608, 710, 711], [711, 609, 608], [609, 711, 712], [712, 610, 609], [610, 712, 713], [713, 611, 610], [697, 765, 766], [766, 698, 697], [698, 766, 767], [767, 699, 698], [699, 767, 768], [768, 700, 699], [700, 768, 769], [769, 701, 700], [701, 769, 770], [770, 702, 701], [702, 770, 771], [771, 703, 702], [703, 771, 772], [772, 704, 703], [704, 772, 773], [773, 705, 704], [705, 773, 774], [774, 706, 705], [706, 774, 775], [775, 707, 706], [707, 775, 776], [776, 708, 707], [708, 776, 777], [777, 709, 708], [709, 777, 778], [778, 710, 709], [710, 778, 779], [779, 711, 710], [711, 779, 780], [780, 712, 711], [712, 780, 781], [781, 713, 712], [765, 799, 800], [800, 766, 765], [766, 800, 801], [801, 767, 766], [767, 801, 802], [802, 768, 767], [768, 802, 803], [803, 769, 768], [769, 803, 804], [804, 770, 769], [770, 804, 805], [805, 771, 770], [771, 805, 806], [806, 772, 771], [772, 806, 807], [807, 773, 772], [773, 807, 808], [808, 774, 773], [774, 808, 809], [809, 775, 774], [775, 809, 810], [810, 776, 775], [776, 810, 811], [811, 777, 776], [777, 811, 812], [812, 778, 777], [778, 812, 813], [813, 779, 778], [779, 813, 814], [814, 780, 779], [780, 814, 815], [815, 781, 780], [442, 443, 511], [511, 510, 442], [443, 444, 512], [512, 511, 443], [444, 445, 513], [513, 512, 444], [445, 446, 514], [514, 513, 445], [446, 447, 515], [515, 514, 446], [447, 448, 516], [516, 515, 447], [448, 449, 517], [517, 516, 448], [449, 450, 518], [518, 517, 449], [450, 451, 519], [519, 518, 450], [451, 452, 520], [520, 519, 451], [452, 453, 521], [521, 520, 452], [453, 454, 522], [522, 521, 453], [454, 455, 523], [523, 522, 454], [455, 456, 524], [524, 523, 455], [456, 457, 525], [525, 524, 456], [457, 458, 526], [526, 525, 457], [391, 392, 443], [443, 442, 391], [392, 393, 444], [444, 443, 392], [393, 394, 445], [445, 444, 393], [394, 395, 446], [446, 445, 394], [395, 396, 447], [447, 446, 395], [396, 397, 448], [448, 447, 396], [397, 398, 449], [449, 448, 397], [398, 399, 450], [450, 449, 398], [399, 400, 451], [451, 450, 399], [400, 401, 452], [452, 451, 400], [401, 402, 453], [453, 452, 401], [402, 403, 454], [454, 453, 402], [403, 404, 455], [455, 454, 403], [404, 405, 456], [456, 455, 404], [405, 406, 457], [457, 456, 405], [406, 407, 458], [458, 457, 406]]

        triangles_from_quads = mf.quad_2_triangles(quads = quads)
        if triangles_from_quads != triangles :
            print("- Passage de quads  triangles faux -")
        self.assertEqual(triangles_from_quads, triangles)

    def test_reindex_mesh(self):
        quads = [[748, 749, 800, 799], [749, 750, 801, 800], [750, 751, 802, 801], [751, 752, 803, 802], [752, 753, 804, 803], [753, 754, 805, 804], [754, 755, 806, 805], [755, 756, 807, 806], [756, 757, 808, 807], [757, 758, 809, 808], [758, 759, 810, 809], [759, 760, 811, 810], [760, 761, 812, 811], [761, 762, 813, 812], [762, 763, 814, 813], [763, 764, 815, 814], [408, 459, 460, 409], [409, 460, 461, 410], [410, 461, 462, 411], [411, 462, 463, 412], [412, 463, 464, 413], [413, 464, 465, 414], [414, 465, 466, 415], [415, 466, 467, 416], [416, 467, 468, 417], [417, 468, 469, 418], [418, 469, 470, 419], [419, 470, 471, 420], [420, 471, 472, 421], [421, 472, 473, 422], [422, 473, 474, 423], [423, 474, 475, 424], [510, 511, 664, 663], [511, 512, 665, 664], [512, 513, 666, 665], [513, 514, 667, 666], [514, 515, 668, 667], [515, 516, 669, 668], [516, 517, 670, 669], [517, 518, 671, 670], [518, 519, 672, 671], [519, 520, 673, 672], [520, 521, 674, 673], [521, 522, 675, 674], [522, 523, 676, 675], [523, 524, 677, 676], [524, 525, 678, 677], [525, 526, 679, 678], [663, 664, 749, 748], [664, 665, 750, 749], [665, 666, 751, 750], [666, 667, 752, 751], [667, 668, 753, 752], [668, 669, 754, 753], [669, 670, 755, 754], [670, 671, 756, 755], [671, 672, 757, 756], [672, 673, 758, 757], [673, 674, 759, 758], [674, 675, 760, 759], [675, 676, 761, 760], [676, 677, 762, 761], [677, 678, 763, 762], [678, 679, 764, 763], [374, 375, 392, 391], [375, 376, 393, 392], [376, 377, 394, 393], [377, 378, 395, 394], [378, 379, 396, 395], [379, 380, 397, 396], [380, 381, 398, 397], [381, 382, 399, 398], [382, 383, 400, 399], [383, 384, 401, 400], [384, 385, 402, 401], [385, 386, 403, 402], [386, 387, 404, 403], [387, 388, 405, 404], [388, 389, 406, 405], [389, 390, 407, 406], [374, 408, 409, 375], [375, 409, 410, 376], [376, 410, 411, 377], [377, 411, 412, 378], [378, 412, 413, 379], [379, 413, 414, 380], [380, 414, 415, 381], [381, 415, 416, 382], [382, 416, 417, 383], [383, 417, 418, 384], [384, 418, 419, 385], [385, 419, 420, 386], [386, 420, 421, 387], [387, 421, 422, 388], [388, 422, 423, 389], [389, 423, 424, 390], [459, 595, 596, 460], [460, 596, 597, 461], [461, 597, 598, 462], [462, 598, 599, 463], [463, 599, 600, 464], [464, 600, 601, 465], [465, 601, 602, 466], [466, 602, 603, 467], [467, 603, 604, 468], [468, 604, 605, 469], [469, 605, 606, 470], [470, 606, 607, 471], [471, 607, 608, 472], [472, 608, 609, 473], [473, 609, 610, 474], [474, 610, 611, 475], [595, 697, 698, 596], [596, 698, 699, 597], [597, 699, 700, 598], [598, 700, 701, 599], [599, 701, 702, 600], [600, 702, 703, 601], [601, 703, 704, 602], [602, 704, 705, 603], [603, 705, 706, 604], [604, 706, 707, 605], [605, 707, 708, 606], [606, 708, 709, 607], [607, 709, 710, 608], [608, 710, 711, 609], [609, 711, 712, 610], [610, 712, 713, 611], [697, 765, 766, 698], [698, 766, 767, 699], [699, 767, 768, 700], [700, 768, 769, 701], [701, 769, 770, 702], [702, 770, 771, 703], [703, 771, 772, 704], [704, 772, 773, 705], [705, 773, 774, 706], [706, 774, 775, 707], [707, 775, 776, 708], [708, 776, 777, 709], [709, 777, 778, 710], [710, 778, 779, 711], [711, 779, 780, 712], [712, 780, 781, 713], [765, 799, 800, 766], [766, 800, 801, 767], [767, 801, 802, 768], [768, 802, 803, 769], [769, 803, 804, 770], [770, 804, 805, 771], [771, 805, 806, 772], [772, 806, 807, 773], [773, 807, 808, 774], [774, 808, 809, 775], [775, 809, 810, 776], [776, 810, 811, 777], [777, 811, 812, 778], [778, 812, 813, 779], [779, 813, 814, 780], [780, 814, 815, 781], [442, 443, 511, 510], [443, 444, 512, 511], [444, 445, 513, 512], [445, 446, 514, 513], [446, 447, 515, 514], [447, 448, 516, 515], [448, 449, 517, 516], [449, 450, 518, 517], [450, 451, 519, 518], [451, 452, 520, 519], [452, 453, 521, 520], [453, 454, 522, 521], [454, 455, 523, 522], [455, 456, 524, 523], [456, 457, 525, 524], [457, 458, 526, 525], [391, 392, 443, 442], [392, 393, 444, 443], [393, 394, 445, 444], [394, 395, 446, 445], [395, 396, 447, 446], [396, 397, 448, 447], [397, 398, 449, 448], [398, 399, 450, 449], [399, 400, 451, 450], [400, 401, 452, 451], [401, 402, 453, 452], [402, 403, 454, 453], [403, 404, 455, 454], [404, 405, 456, 455], [405, 406, 457, 456], [406, 407, 458, 457]]
        new_index_quads = [[187, 188, 171, 170], [188, 189, 172, 171], [189, 190, 173, 172], [190, 191, 174, 173], [191, 192, 175, 174], [192, 193, 176, 175], [193, 194, 177, 176], [194, 195, 178, 177], [195, 196, 179, 178], [196, 197, 180, 179], [197, 198, 181, 180], [198, 199, 182, 181], [199, 200, 183, 182], [200, 201, 184, 183], [201, 202, 185, 184], [202, 203, 186, 185], [0, 34, 35, 1], [1, 35, 36, 2], [2, 36, 37, 3], [3, 37, 38, 4], [4, 38, 39, 5], [5, 39, 40, 6], [6, 40, 41, 7], [7, 41, 42, 8], [8, 42, 43, 9], [9, 43, 44, 10], [10, 44, 45, 11], [11, 45, 46, 12], [12, 46, 47, 13], [13, 47, 48, 14], [14, 48, 49, 15], [15, 49, 50, 16], [119, 120, 154, 153], [120, 121, 155, 154], [121, 122, 156, 155], [122, 123, 157, 156], [123, 124, 158, 157], [124, 125, 159, 158], [125, 126, 160, 159], [126, 127, 161, 160], [127, 128, 162, 161], [128, 129, 163, 162], [129, 130, 164, 163], [130, 131, 165, 164], [131, 132, 166, 165], [132, 133, 167, 166], [133, 134, 168, 167], [134, 135, 169, 168], [153, 154, 188, 187], [154, 155, 189, 188], [155, 156, 190, 189], [156, 157, 191, 190], [157, 158, 192, 191], [158, 159, 193, 192], [159, 160, 194, 193], [160, 161, 195, 194], [161, 162, 196, 195], [162, 163, 197, 196], [163, 164, 198, 197], [164, 165, 199, 198], [165, 166, 200, 199], [166, 167, 201, 200], [167, 168, 202, 201], [168, 169, 203, 202], [17, 18, 52, 51], [18, 19, 53, 52], [19, 20, 54, 53], [20, 21, 55, 54], [21, 22, 56, 55], [22, 23, 57, 56], [23, 24, 58, 57], [24, 25, 59, 58], [25, 26, 60, 59], [26, 27, 61, 60], [27, 28, 62, 61], [28, 29, 63, 62], [29, 30, 64, 63], [30, 31, 65, 64], [31, 32, 66, 65], [32, 33, 67, 66], [17, 0, 1, 18], [18, 1, 2, 19], [19, 2, 3, 20], [20, 3, 4, 21], [21, 4, 5, 22], [22, 5, 6, 23], [23, 6, 7, 24], [24, 7, 8, 25], [25, 8, 9, 26], [26, 9, 10, 27], [27, 10, 11, 28], [28, 11, 12, 29], [29, 12, 13, 30], [30, 13, 14, 31], [31, 14, 15, 32], [32, 15, 16, 33], [34, 68, 69, 35], [35, 69, 70, 36], [36, 70, 71, 37], [37, 71, 72, 38], [38, 72, 73, 39], [39, 73, 74, 40], [40, 74, 75, 41], [41, 75, 76, 42], [42, 76, 77, 43], [43, 77, 78, 44], [44, 78, 79, 45], [45, 79, 80, 46], [46, 80, 81, 47], [47, 81, 82, 48], [48, 82, 83, 49], [49, 83, 84, 50], [68, 102, 103, 69], [69, 103, 104, 70], [70, 104, 105, 71], [71, 105, 106, 72], [72, 106, 107, 73], [73, 107, 108, 74], [74, 108, 109, 75], [75, 109, 110, 76], [76, 110, 111, 77], [77, 111, 112, 78], [78, 112, 113, 79], [79, 113, 114, 80], [80, 114, 115, 81], [81, 115, 116, 82], [82, 116, 117, 83], [83, 117, 118, 84], [102, 136, 137, 103], [103, 137, 138, 104], [104, 138, 139, 105], [105, 139, 140, 106], [106, 140, 141, 107], [107, 141, 142, 108], [108, 142, 143, 109], [109, 143, 144, 110], [110, 144, 145, 111], [111, 145, 146, 112], [112, 146, 147, 113], [113, 147, 148, 114], [114, 148, 149, 115], [115, 149, 150, 116], [116, 150, 151, 117], [117, 151, 152, 118], [136, 170, 171, 137], [137, 171, 172, 138], [138, 172, 173, 139], [139, 173, 174, 140], [140, 174, 175, 141], [141, 175, 176, 142], [142, 176, 177, 143], [143, 177, 178, 144], [144, 178, 179, 145], [145, 179, 180, 146], [146, 180, 181, 147], [147, 181, 182, 148], [148, 182, 183, 149], [149, 183, 184, 150], [150, 184, 185, 151], [151, 185, 186, 152], [85, 86, 120, 119], [86, 87, 121, 120], [87, 88, 122, 121], [88, 89, 123, 122], [89, 90, 124, 123], [90, 91, 125, 124], [91, 92, 126, 125], [92, 93, 127, 126], [93, 94, 128, 127], [94, 95, 129, 128], [95, 96, 130, 129], [96, 97, 131, 130], [97, 98, 132, 131], [98, 99, 133, 132], [99, 100, 134, 133], [100, 101, 135, 134], [51, 52, 86, 85], [52, 53, 87, 86], [53, 54, 88, 87], [54, 55, 89, 88], [55, 56, 90, 89], [56, 57, 91, 90], [57, 58, 92, 91], [58, 59, 93, 92], [59, 60, 94, 93], [60, 61, 95, 94], [61, 62, 96, 95], [62, 63, 97, 96], [63, 64, 98, 97], [64, 65, 99, 98], [65, 66, 100, 99], [66, 67, 101, 100]]
        conv_tab = [[[8.8817842e-16, 4.0, -0.75], 408], [[3.125, 4.0, -0.75], 409], [[6.25, 4.0, -0.75], 410], [[9.375, 4.0, -0.75], 411], [[12.5, 4.0, -0.75], 412], [[15.625, 4.0, -0.75], 413], [[18.75, 4.0, -0.75], 414], [[21.875, 4.0, -0.75], 415], [[25.0, 4.0, -0.75], 416], [[28.125, 4.0, -0.75], 417], [[31.25, 4.0, -0.75], 418], [[34.375, 4.0, -0.75], 419], [[37.5, 4.0, -0.75], 420], [[40.625, 4.0, -0.75], 421], [[43.75, 4.0, -0.75], 422], [[46.875, 4.0, -0.75], 423], [[50.0, 4.0, -0.75], 424], [[9.71445147e-16, 4.375, -0.649519], 374], [[3.125, 4.375, -0.649519], 375], [[6.25, 4.375, -0.649519], 376], [[9.375, 4.375, -0.649519], 377], [[12.5, 4.375, -0.649519], 378], [[15.625, 4.375, -0.649519], 379], [[18.75, 4.375, -0.649519], 380], [[21.875, 4.375, -0.649519], 381], [[25.0, 4.375, -0.649519], 382], [[28.125, 4.375, -0.649519], 383], [[31.25, 4.375, -0.649519], 384], [[34.375, 4.375, -0.649519], 385], [[37.5, 4.375, -0.649519], 386], [[40.625, 4.375, -0.649519], 387], [[43.75, 4.375, -0.649519], 388], [[46.875, 4.375, -0.649519], 389], [[50.0, 4.375, -0.649519], 390], [[8.04911693e-16, 3.625, -0.649519], 459], [[3.125, 3.625, -0.649519], 460], [[6.25, 3.625, -0.649519], 461], [[9.375, 3.625, -0.649519], 462], [[12.5, 3.625, -0.649519], 463], [[15.625, 3.625, -0.649519], 464], [[18.75, 3.625, -0.649519], 465], [[21.875, 3.625, -0.649519], 466], [[25.0, 3.625, -0.649519], 467], [[28.125, 3.625, -0.649519], 468], [[31.25, 3.625, -0.649519], 469], [[34.375, 3.625, -0.649519], 470], [[37.5, 3.625, -0.649519], 471], [[40.625, 3.625, -0.649519], 472], [[43.75, 3.625, -0.649519], 473], [[46.875, 3.625, -0.649519], 474], [[50.0, 3.625, -0.649519], 475], [[1.03240061e-15, 4.649519, -0.375], 391], [[3.125, 4.649519, -0.375], 392], [[6.25, 4.649519, -0.375], 393], [[9.375, 4.649519, -0.375], 394], [[12.5, 4.649519, -0.375], 395], [[15.625, 4.649519, -0.375], 396], [[18.75, 4.649519, -0.375], 397], [[21.875, 4.649519, -0.375], 398], [[25.0, 4.649519, -0.375], 399], [[28.125, 4.649519, -0.375], 400], [[31.25, 4.649519, -0.375], 401], [[34.375, 4.649519, -0.375], 402], [[37.5, 4.649519, -0.375], 403], [[40.625, 4.649519, -0.375], 404], [[43.75, 4.649519, -0.375], 405], [[46.875, 4.649519, -0.375], 406], [[50.0, 4.649519, -0.375], 407], [[7.4395623e-16, 3.350481, -0.375], 595], [[3.125, 3.350481, -0.375], 596], [[6.25, 3.350481, -0.375], 597], [[9.375, 3.350481, -0.375], 598], [[12.5, 3.350481, -0.375], 599], [[15.625, 3.350481, -0.375], 600], [[18.75, 3.350481, -0.375], 601], [[21.875, 3.350481, -0.375], 602], [[25.0, 3.350481, -0.375], 603], [[28.125, 3.350481, -0.375], 604], [[31.25, 3.350481, -0.375], 605], [[34.375, 3.350481, -0.375], 606], [[37.5, 3.350481, -0.375], 607], [[40.625, 3.350481, -0.375], 608], [[43.75, 3.350481, -0.375], 609], [[46.875, 3.350481, -0.375], 610], [[50.0, 3.350481, -0.375], 611], [[1.05471187e-15, 4.75, 0.0], 442], [[3.125, 4.75, 0.0], 443], [[6.25, 4.75, 0.0], 444], [[9.375, 4.75, 0.0], 445], [[12.5, 4.75, 0.0], 446], [[15.625, 4.75, 0.0], 447], [[18.75, 4.75, 0.0], 448], [[21.875, 4.75, 0.0], 449], [[25.0, 4.75, 0.0], 450], [[28.125, 4.75, 0.0], 451], [[31.25, 4.75, 0.0], 452], [[34.375, 4.75, 0.0], 453], [[37.5, 4.75, 0.0], 454], [[40.625, 4.75, 0.0], 455], [[43.75, 4.75, 0.0], 456], [[46.875, 4.75, 0.0], 457], [[50.0, 4.75, 0.0], 458], [[7.21644966e-16, 3.25, 0.0], 697], [[3.125, 3.25, 0.0], 698], [[6.25, 3.25, 0.0], 699], [[9.375, 3.25, 0.0], 700], [[12.5, 3.25, 0.0], 701], [[15.625, 3.25, 0.0], 702], [[18.75, 3.25, 0.0], 703], [[21.875, 3.25, 0.0], 704], [[25.0, 3.25, 0.0], 705], [[28.125, 3.25, 0.0], 706], [[31.25, 3.25, 0.0], 707], [[34.375, 3.25, 0.0], 708], [[37.5, 3.25, 0.0], 709], [[40.625, 3.25, 0.0], 710], [[43.75, 3.25, 0.0], 711], [[46.875, 3.25, 0.0], 712], [[50.0, 3.25, 0.0], 713], [[1.03240061e-15, 4.649519, 0.375], 510], [[3.125, 4.649519, 0.375], 511], [[6.25, 4.649519, 0.375], 512], [[9.375, 4.649519, 0.375], 513], [[12.5, 4.649519, 0.375], 514], [[15.625, 4.649519, 0.375], 515], [[18.75, 4.649519, 0.375], 516], [[21.875, 4.649519, 0.375], 517], [[25.0, 4.649519, 0.375], 518], [[28.125, 4.649519, 0.375], 519], [[31.25, 4.649519, 0.375], 520], [[34.375, 4.649519, 0.375], 521], [[37.5, 4.649519, 0.375], 522], [[40.625, 4.649519, 0.375], 523], [[43.75, 4.649519, 0.375], 524], [[46.875, 4.649519, 0.375], 525], [[50.0, 4.649519, 0.375], 526], [[7.4395623e-16, 3.350481, 0.375], 765], [[3.125, 3.350481, 0.375], 766], [[6.25, 3.350481, 0.375], 767], [[9.375, 3.350481, 0.375], 768], [[12.5, 3.350481, 0.375], 769], [[15.625, 3.350481, 0.375], 770], [[18.75, 3.350481, 0.375], 771], [[21.875, 3.350481, 0.375], 772], [[25.0, 3.350481, 0.375], 773], [[28.125, 3.350481, 0.375], 774], [[31.25, 3.350481, 0.375], 775], [[34.375, 3.350481, 0.375], 776], [[37.5, 3.350481, 0.375], 777], [[40.625, 3.350481, 0.375], 778], [[43.75, 3.350481, 0.375], 779], [[46.875, 3.350481, 0.375], 780], [[50.0, 3.350481, 0.375], 781], [[9.71445147e-16, 4.375, 0.649519], 663], [[3.125, 4.375, 0.649519], 664], [[6.25, 4.375, 0.649519], 665], [[9.375, 4.375, 0.649519], 666], [[12.5, 4.375, 0.649519], 667], [[15.625, 4.375, 0.649519], 668], [[18.75, 4.375, 0.649519], 669], [[21.875, 4.375, 0.649519], 670], [[25.0, 4.375, 0.649519], 671], [[28.125, 4.375, 0.649519], 672], [[31.25, 4.375, 0.649519], 673], [[34.375, 4.375, 0.649519], 674], [[37.5, 4.375, 0.649519], 675], [[40.625, 4.375, 0.649519], 676], [[43.75, 4.375, 0.649519], 677], [[46.875, 4.375, 0.649519], 678], [[50.0, 4.375, 0.649519], 679], [[8.04911693e-16, 3.625, 0.649519], 799], [[3.125, 3.625, 0.649519], 800], [[6.25, 3.625, 0.649519], 801], [[9.375, 3.625, 0.649519], 802], [[12.5, 3.625, 0.649519], 803], [[15.625, 3.625, 0.649519], 804], [[18.75, 3.625, 0.649519], 805], [[21.875, 3.625, 0.649519], 806], [[25.0, 3.625, 0.649519], 807], [[28.125, 3.625, 0.649519], 808], [[31.25, 3.625, 0.649519], 809], [[34.375, 3.625, 0.649519], 810], [[37.5, 3.625, 0.649519], 811], [[40.625, 3.625, 0.649519], 812], [[43.75, 3.625, 0.649519], 813], [[46.875, 3.625, 0.649519], 814], [[50.0, 3.625, 0.649519], 815], [[8.8817842e-16, 4.0, 0.75], 748], [[3.125, 4.0, 0.75], 749], [[6.25, 4.0, 0.75], 750], [[9.375, 4.0, 0.75], 751], [[12.5, 4.0, 0.75], 752], [[15.625, 4.0, 0.75], 753], [[18.75, 4.0, 0.75], 754], [[21.875, 4.0, 0.75], 755], [[25.0, 4.0, 0.75], 756], [[28.125, 4.0, 0.75], 757], [[31.25, 4.0, 0.75], 758], [[34.375, 4.0, 0.75], 759], [[37.5, 4.0, 0.75], 760], [[40.625, 4.0, 0.75], 761], [[43.75, 4.0, 0.75], 762], [[46.875, 4.0, 0.75], 763], [[50.0, 4.0, 0.75], 764]]

        new_quads = mf.reindex_mesh(conv_tab=conv_tab,mesh=quads)

        if new_quads != new_index_quads :
            print("- Reindexation du maillage celon un tableau de conversion faux -")
        self.assertEqual(new_quads, new_index_quads)

        triangles = [[748, 749, 800], [800, 799, 748], [749, 750, 801], [801, 800, 749], [750, 751, 802], [802, 801, 750], [751, 752, 803], [803, 802, 751], [752, 753, 804], [804, 803, 752], [753, 754, 805], [805, 804, 753], [754, 755, 806], [806, 805, 754], [755, 756, 807], [807, 806, 755], [756, 757, 808], [808, 807, 756], [757, 758, 809], [809, 808, 757], [758, 759, 810], [810, 809, 758], [759, 760, 811], [811, 810, 759], [760, 761, 812], [812, 811, 760], [761, 762, 813], [813, 812, 761], [762, 763, 814], [814, 813, 762], [763, 764, 815], [815, 814, 763], [408, 459, 460], [460, 409, 408], [409, 460, 461], [461, 410, 409], [410, 461, 462], [462, 411, 410], [411, 462, 463], [463, 412, 411], [412, 463, 464], [464, 413, 412], [413, 464, 465], [465, 414, 413], [414, 465, 466], [466, 415, 414], [415, 466, 467], [467, 416, 415], [416, 467, 468], [468, 417, 416], [417, 468, 469], [469, 418, 417], [418, 469, 470], [470, 419, 418], [419, 470, 471], [471, 420, 419], [420, 471, 472], [472, 421, 420], [421, 472, 473], [473, 422, 421], [422, 473, 474], [474, 423, 422], [423, 474, 475], [475, 424, 423], [510, 511, 664], [664, 663, 510], [511, 512, 665], [665, 664, 511], [512, 513, 666], [666, 665, 512], [513, 514, 667], [667, 666, 513], [514, 515, 668], [668, 667, 514], [515, 516, 669], [669, 668, 515], [516, 517, 670], [670, 669, 516], [517, 518, 671], [671, 670, 517], [518, 519, 672], [672, 671, 518], [519, 520, 673], [673, 672, 519], [520, 521, 674], [674, 673, 520], [521, 522, 675], [675, 674, 521], [522, 523, 676], [676, 675, 522], [523, 524, 677], [677, 676, 523], [524, 525, 678], [678, 677, 524], [525, 526, 679], [679, 678, 525], [663, 664, 749], [749, 748, 663], [664, 665, 750], [750, 749, 664], [665, 666, 751], [751, 750, 665], [666, 667, 752], [752, 751, 666], [667, 668, 753], [753, 752, 667], [668, 669, 754], [754, 753, 668], [669, 670, 755], [755, 754, 669], [670, 671, 756], [756, 755, 670], [671, 672, 757], [757, 756, 671], [672, 673, 758], [758, 757, 672], [673, 674, 759], [759, 758, 673], [674, 675, 760], [760, 759, 674], [675, 676, 761], [761, 760, 675], [676, 677, 762], [762, 761, 676], [677, 678, 763], [763, 762, 677], [678, 679, 764], [764, 763, 678], [374, 375, 392], [392, 391, 374], [375, 376, 393], [393, 392, 375], [376, 377, 394], [394, 393, 376], [377, 378, 395], [395, 394, 377], [378, 379, 396], [396, 395, 378], [379, 380, 397], [397, 396, 379], [380, 381, 398], [398, 397, 380], [381, 382, 399], [399, 398, 381], [382, 383, 400], [400, 399, 382], [383, 384, 401], [401, 400, 383], [384, 385, 402], [402, 401, 384], [385, 386, 403], [403, 402, 385], [386, 387, 404], [404, 403, 386], [387, 388, 405], [405, 404, 387], [388, 389, 406], [406, 405, 388], [389, 390, 407], [407, 406, 389], [374, 408, 409], [409, 375, 374], [375, 409, 410], [410, 376, 375], [376, 410, 411], [411, 377, 376], [377, 411, 412], [412, 378, 377], [378, 412, 413], [413, 379, 378], [379, 413, 414], [414, 380, 379], [380, 414, 415], [415, 381, 380], [381, 415, 416], [416, 382, 381], [382, 416, 417], [417, 383, 382], [383, 417, 418], [418, 384, 383], [384, 418, 419], [419, 385, 384], [385, 419, 420], [420, 386, 385], [386, 420, 421], [421, 387, 386], [387, 421, 422], [422, 388, 387], [388, 422, 423], [423, 389, 388], [389, 423, 424], [424, 390, 389], [459, 595, 596], [596, 460, 459], [460, 596, 597], [597, 461, 460], [461, 597, 598], [598, 462, 461], [462, 598, 599], [599, 463, 462], [463, 599, 600], [600, 464, 463], [464, 600, 601], [601, 465, 464], [465, 601, 602], [602, 466, 465], [466, 602, 603], [603, 467, 466], [467, 603, 604], [604, 468, 467], [468, 604, 605], [605, 469, 468], [469, 605, 606], [606, 470, 469], [470, 606, 607], [607, 471, 470], [471, 607, 608], [608, 472, 471], [472, 608, 609], [609, 473, 472], [473, 609, 610], [610, 474, 473], [474, 610, 611], [611, 475, 474], [595, 697, 698], [698, 596, 595], [596, 698, 699], [699, 597, 596], [597, 699, 700], [700, 598, 597], [598, 700, 701], [701, 599, 598], [599, 701, 702], [702, 600, 599], [600, 702, 703], [703, 601, 600], [601, 703, 704], [704, 602, 601], [602, 704, 705], [705, 603, 602], [603, 705, 706], [706, 604, 603], [604, 706, 707], [707, 605, 604], [605, 707, 708], [708, 606, 605], [606, 708, 709], [709, 607, 606], [607, 709, 710], [710, 608, 607], [608, 710, 711], [711, 609, 608], [609, 711, 712], [712, 610, 609], [610, 712, 713], [713, 611, 610], [697, 765, 766], [766, 698, 697], [698, 766, 767], [767, 699, 698], [699, 767, 768], [768, 700, 699], [700, 768, 769], [769, 701, 700], [701, 769, 770], [770, 702, 701], [702, 770, 771], [771, 703, 702], [703, 771, 772], [772, 704, 703], [704, 772, 773], [773, 705, 704], [705, 773, 774], [774, 706, 705], [706, 774, 775], [775, 707, 706], [707, 775, 776], [776, 708, 707], [708, 776, 777], [777, 709, 708], [709, 777, 778], [778, 710, 709], [710, 778, 779], [779, 711, 710], [711, 779, 780], [780, 712, 711], [712, 780, 781], [781, 713, 712], [765, 799, 800], [800, 766, 765], [766, 800, 801], [801, 767, 766], [767, 801, 802], [802, 768, 767], [768, 802, 803], [803, 769, 768], [769, 803, 804], [804, 770, 769], [770, 804, 805], [805, 771, 770], [771, 805, 806], [806, 772, 771], [772, 806, 807], [807, 773, 772], [773, 807, 808], [808, 774, 773], [774, 808, 809], [809, 775, 774], [775, 809, 810], [810, 776, 775], [776, 810, 811], [811, 777, 776], [777, 811, 812], [812, 778, 777], [778, 812, 813], [813, 779, 778], [779, 813, 814], [814, 780, 779], [780, 814, 815], [815, 781, 780], [442, 443, 511], [511, 510, 442], [443, 444, 512], [512, 511, 443], [444, 445, 513], [513, 512, 444], [445, 446, 514], [514, 513, 445], [446, 447, 515], [515, 514, 446], [447, 448, 516], [516, 515, 447], [448, 449, 517], [517, 516, 448], [449, 450, 518], [518, 517, 449], [450, 451, 519], [519, 518, 450], [451, 452, 520], [520, 519, 451], [452, 453, 521], [521, 520, 452], [453, 454, 522], [522, 521, 453], [454, 455, 523], [523, 522, 454], [455, 456, 524], [524, 523, 455], [456, 457, 525], [525, 524, 456], [457, 458, 526], [526, 525, 457], [391, 392, 443], [443, 442, 391], [392, 393, 444], [444, 443, 392], [393, 394, 445], [445, 444, 393], [394, 395, 446], [446, 445, 394], [395, 396, 447], [447, 446, 395], [396, 397, 448], [448, 447, 396], [397, 398, 449], [449, 448, 397], [398, 399, 450], [450, 449, 398], [399, 400, 451], [451, 450, 399], [400, 401, 452], [452, 451, 400], [401, 402, 453], [453, 452, 401], [402, 403, 454], [454, 453, 402], [403, 404, 455], [455, 454, 403], [404, 405, 456], [456, 455, 404], [405, 406, 457], [457, 456, 405], [406, 407, 458], [458, 457, 406]]
        new_index_triangles = [[187, 188, 171], [171, 170, 187], [188, 189, 172], [172, 171, 188], [189, 190, 173], [173, 172, 189], [190, 191, 174], [174, 173, 190], [191, 192, 175], [175, 174, 191], [192, 193, 176], [176, 175, 192], [193, 194, 177], [177, 176, 193], [194, 195, 178], [178, 177, 194], [195, 196, 179], [179, 178, 195], [196, 197, 180], [180, 179, 196], [197, 198, 181], [181, 180, 197], [198, 199, 182], [182, 181, 198], [199, 200, 183], [183, 182, 199], [200, 201, 184], [184, 183, 200], [201, 202, 185], [185, 184, 201], [202, 203, 186], [186, 185, 202], [0, 34, 35], [35, 1, 0], [1, 35, 36], [36, 2, 1], [2, 36, 37], [37, 3, 2], [3, 37, 38], [38, 4, 3], [4, 38, 39], [39, 5, 4], [5, 39, 40], [40, 6, 5], [6, 40, 41], [41, 7, 6], [7, 41, 42], [42, 8, 7], [8, 42, 43], [43, 9, 8], [9, 43, 44], [44, 10, 9], [10, 44, 45], [45, 11, 10], [11, 45, 46], [46, 12, 11], [12, 46, 47], [47, 13, 12], [13, 47, 48], [48, 14, 13], [14, 48, 49], [49, 15, 14], [15, 49, 50], [50, 16, 15], [119, 120, 154], [154, 153, 119], [120, 121, 155], [155, 154, 120], [121, 122, 156], [156, 155, 121], [122, 123, 157], [157, 156, 122], [123, 124, 158], [158, 157, 123], [124, 125, 159], [159, 158, 124], [125, 126, 160], [160, 159, 125], [126, 127, 161], [161, 160, 126], [127, 128, 162], [162, 161, 127], [128, 129, 163], [163, 162, 128], [129, 130, 164], [164, 163, 129], [130, 131, 165], [165, 164, 130], [131, 132, 166], [166, 165, 131], [132, 133, 167], [167, 166, 132], [133, 134, 168], [168, 167, 133], [134, 135, 169], [169, 168, 134], [153, 154, 188], [188, 187, 153], [154, 155, 189], [189, 188, 154], [155, 156, 190], [190, 189, 155], [156, 157, 191], [191, 190, 156], [157, 158, 192], [192, 191, 157], [158, 159, 193], [193, 192, 158], [159, 160, 194], [194, 193, 159], [160, 161, 195], [195, 194, 160], [161, 162, 196], [196, 195, 161], [162, 163, 197], [197, 196, 162], [163, 164, 198], [198, 197, 163], [164, 165, 199], [199, 198, 164], [165, 166, 200], [200, 199, 165], [166, 167, 201], [201, 200, 166], [167, 168, 202], [202, 201, 167], [168, 169, 203], [203, 202, 168], [17, 18, 52], [52, 51, 17], [18, 19, 53], [53, 52, 18], [19, 20, 54], [54, 53, 19], [20, 21, 55], [55, 54, 20], [21, 22, 56], [56, 55, 21], [22, 23, 57], [57, 56, 22], [23, 24, 58], [58, 57, 23], [24, 25, 59], [59, 58, 24], [25, 26, 60], [60, 59, 25], [26, 27, 61], [61, 60, 26], [27, 28, 62], [62, 61, 27], [28, 29, 63], [63, 62, 28], [29, 30, 64], [64, 63, 29], [30, 31, 65], [65, 64, 30], [31, 32, 66], [66, 65, 31], [32, 33, 67], [67, 66, 32], [17, 0, 1], [1, 18, 17], [18, 1, 2], [2, 19, 18], [19, 2, 3], [3, 20, 19], [20, 3, 4], [4, 21, 20], [21, 4, 5], [5, 22, 21], [22, 5, 6], [6, 23, 22], [23, 6, 7], [7, 24, 23], [24, 7, 8], [8, 25, 24], [25, 8, 9], [9, 26, 25], [26, 9, 10], [10, 27, 26], [27, 10, 11], [11, 28, 27], [28, 11, 12], [12, 29, 28], [29, 12, 13], [13, 30, 29], [30, 13, 14], [14, 31, 30], [31, 14, 15], [15, 32, 31], [32, 15, 16], [16, 33, 32], [34, 68, 69], [69, 35, 34], [35, 69, 70], [70, 36, 35], [36, 70, 71], [71, 37, 36], [37, 71, 72], [72, 38, 37], [38, 72, 73], [73, 39, 38], [39, 73, 74], [74, 40, 39], [40, 74, 75], [75, 41, 40], [41, 75, 76], [76, 42, 41], [42, 76, 77], [77, 43, 42], [43, 77, 78], [78, 44, 43], [44, 78, 79], [79, 45, 44], [45, 79, 80], [80, 46, 45], [46, 80, 81], [81, 47, 46], [47, 81, 82], [82, 48, 47], [48, 82, 83], [83, 49, 48], [49, 83, 84], [84, 50, 49], [68, 102, 103], [103, 69, 68], [69, 103, 104], [104, 70, 69], [70, 104, 105], [105, 71, 70], [71, 105, 106], [106, 72, 71], [72, 106, 107], [107, 73, 72], [73, 107, 108], [108, 74, 73], [74, 108, 109], [109, 75, 74], [75, 109, 110], [110, 76, 75], [76, 110, 111], [111, 77, 76], [77, 111, 112], [112, 78, 77], [78, 112, 113], [113, 79, 78], [79, 113, 114], [114, 80, 79], [80, 114, 115], [115, 81, 80], [81, 115, 116], [116, 82, 81], [82, 116, 117], [117, 83, 82], [83, 117, 118], [118, 84, 83], [102, 136, 137], [137, 103, 102], [103, 137, 138], [138, 104, 103], [104, 138, 139], [139, 105, 104], [105, 139, 140], [140, 106, 105], [106, 140, 141], [141, 107, 106], [107, 141, 142], [142, 108, 107], [108, 142, 143], [143, 109, 108], [109, 143, 144], [144, 110, 109], [110, 144, 145], [145, 111, 110], [111, 145, 146], [146, 112, 111], [112, 146, 147], [147, 113, 112], [113, 147, 148], [148, 114, 113], [114, 148, 149], [149, 115, 114], [115, 149, 150], [150, 116, 115], [116, 150, 151], [151, 117, 116], [117, 151, 152], [152, 118, 117], [136, 170, 171], [171, 137, 136], [137, 171, 172], [172, 138, 137], [138, 172, 173], [173, 139, 138], [139, 173, 174], [174, 140, 139], [140, 174, 175], [175, 141, 140], [141, 175, 176], [176, 142, 141], [142, 176, 177], [177, 143, 142], [143, 177, 178], [178, 144, 143], [144, 178, 179], [179, 145, 144], [145, 179, 180], [180, 146, 145], [146, 180, 181], [181, 147, 146], [147, 181, 182], [182, 148, 147], [148, 182, 183], [183, 149, 148], [149, 183, 184], [184, 150, 149], [150, 184, 185], [185, 151, 150], [151, 185, 186], [186, 152, 151], [85, 86, 120], [120, 119, 85], [86, 87, 121], [121, 120, 86], [87, 88, 122], [122, 121, 87], [88, 89, 123], [123, 122, 88], [89, 90, 124], [124, 123, 89], [90, 91, 125], [125, 124, 90], [91, 92, 126], [126, 125, 91], [92, 93, 127], [127, 126, 92], [93, 94, 128], [128, 127, 93], [94, 95, 129], [129, 128, 94], [95, 96, 130], [130, 129, 95], [96, 97, 131], [131, 130, 96], [97, 98, 132], [132, 131, 97], [98, 99, 133], [133, 132, 98], [99, 100, 134], [134, 133, 99], [100, 101, 135], [135, 134, 100], [51, 52, 86], [86, 85, 51], [52, 53, 87], [87, 86, 52], [53, 54, 88], [88, 87, 53], [54, 55, 89], [89, 88, 54], [55, 56, 90], [90, 89, 55], [56, 57, 91], [91, 90, 56], [57, 58, 92], [92, 91, 57], [58, 59, 93], [93, 92, 58], [59, 60, 94], [94, 93, 59], [60, 61, 95], [95, 94, 60], [61, 62, 96], [96, 95, 61], [62, 63, 97], [97, 96, 62], [63, 64, 98], [98, 97, 63], [64, 65, 99], [99, 98, 64], [65, 66, 100], [100, 99, 65], [66, 67, 101], [101, 100, 66]]

        new_triangles = mf.reindex_mesh(conv_tab=conv_tab,mesh=triangles)

        if new_triangles != new_index_triangles :
            print("- Reindexation du maillage cecd ..lon un tableau de conversion faux -")
        self.assertEqual(new_triangles, new_index_triangles)

    def test_remesh_from_axis(self):
        quads = [[748, 749, 800, 799], [749, 750, 801, 800], [750, 751, 802, 801], [751, 752, 803, 802], [752, 753, 804, 803], [753, 754, 805, 804], [754, 755, 806, 805], [755, 756, 807, 806], [756, 757, 808, 807], [757, 758, 809, 808], [758, 759, 810, 809], [759, 760, 811, 810], [760, 761, 812, 811], [761, 762, 813, 812], [762, 763, 814, 813], [763, 764, 815, 814], [408, 459, 460, 409], [409, 460, 461, 410], [410, 461, 462, 411], [411, 462, 463, 412], [412, 463, 464, 413], [413, 464, 465, 414], [414, 465, 466, 415], [415, 466, 467, 416], [416, 467, 468, 417], [417, 468, 469, 418], [418, 469, 470, 419], [419, 470, 471, 420], [420, 471, 472, 421], [421, 472, 473, 422], [422, 473, 474, 423], [423, 474, 475, 424], [510, 511, 664, 663], [511, 512, 665, 664], [512, 513, 666, 665], [513, 514, 667, 666], [514, 515, 668, 667], [515, 516, 669, 668], [516, 517, 670, 669], [517, 518, 671, 670], [518, 519, 672, 671], [519, 520, 673, 672], [520, 521, 674, 673], [521, 522, 675, 674], [522, 523, 676, 675], [523, 524, 677, 676], [524, 525, 678, 677], [525, 526, 679, 678], [663, 664, 749, 748], [664, 665, 750, 749], [665, 666, 751, 750], [666, 667, 752, 751], [667, 668, 753, 752], [668, 669, 754, 753], [669, 670, 755, 754], [670, 671, 756, 755], [671, 672, 757, 756], [672, 673, 758, 757], [673, 674, 759, 758], [674, 675, 760, 759], [675, 676, 761, 760], [676, 677, 762, 761], [677, 678, 763, 762], [678, 679, 764, 763], [374, 375, 392, 391], [375, 376, 393, 392], [376, 377, 394, 393], [377, 378, 395, 394], [378, 379, 396, 395], [379, 380, 397, 396], [380, 381, 398, 397], [381, 382, 399, 398], [382, 383, 400, 399], [383, 384, 401, 400], [384, 385, 402, 401], [385, 386, 403, 402], [386, 387, 404, 403], [387, 388, 405, 404], [388, 389, 406, 405], [389, 390, 407, 406], [374, 408, 409, 375], [375, 409, 410, 376], [376, 410, 411, 377], [377, 411, 412, 378], [378, 412, 413, 379], [379, 413, 414, 380], [380, 414, 415, 381], [381, 415, 416, 382], [382, 416, 417, 383], [383, 417, 418, 384], [384, 418, 419, 385], [385, 419, 420, 386], [386, 420, 421, 387], [387, 421, 422, 388], [388, 422, 423, 389], [389, 423, 424, 390], [459, 595, 596, 460], [460, 596, 597, 461], [461, 597, 598, 462], [462, 598, 599, 463], [463, 599, 600, 464], [464, 600, 601, 465], [465, 601, 602, 466], [466, 602, 603, 467], [467, 603, 604, 468], [468, 604, 605, 469], [469, 605, 606, 470], [470, 606, 607, 471], [471, 607, 608, 472], [472, 608, 609, 473], [473, 609, 610, 474], [474, 610, 611, 475], [595, 697, 698, 596], [596, 698, 699, 597], [597, 699, 700, 598], [598, 700, 701, 599], [599, 701, 702, 600], [600, 702, 703, 601], [601, 703, 704, 602], [602, 704, 705, 603], [603, 705, 706, 604], [604, 706, 707, 605], [605, 707, 708, 606], [606, 708, 709, 607], [607, 709, 710, 608], [608, 710, 711, 609], [609, 711, 712, 610], [610, 712, 713, 611], [697, 765, 766, 698], [698, 766, 767, 699], [699, 767, 768, 700], [700, 768, 769, 701], [701, 769, 770, 702], [702, 770, 771, 703], [703, 771, 772, 704], [704, 772, 773, 705], [705, 773, 774, 706], [706, 774, 775, 707], [707, 775, 776, 708], [708, 776, 777, 709], [709, 777, 778, 710], [710, 778, 779, 711], [711, 779, 780, 712], [712, 780, 781, 713], [765, 799, 800, 766], [766, 800, 801, 767], [767, 801, 802, 768], [768, 802, 803, 769], [769, 803, 804, 770], [770, 804, 805, 771], [771, 805, 806, 772], [772, 806, 807, 773], [773, 807, 808, 774], [774, 808, 809, 775], [775, 809, 810, 776], [776, 810, 811, 777], [777, 811, 812, 778], [778, 812, 813, 779], [779, 813, 814, 780], [780, 814, 815, 781], [442, 443, 511, 510], [443, 444, 512, 511], [444, 445, 513, 512], [445, 446, 514, 513], [446, 447, 515, 514], [447, 448, 516, 515], [448, 449, 517, 516], [449, 450, 518, 517], [450, 451, 519, 518], [451, 452, 520, 519], [452, 453, 521, 520], [453, 454, 522, 521], [454, 455, 523, 522], [455, 456, 524, 523], [456, 457, 525, 524], [457, 458, 526, 525], [391, 392, 443, 442], [392, 393, 444, 443], [393, 394, 445, 444], [394, 395, 446, 445], [395, 396, 447, 446], [396, 397, 448, 447], [397, 398, 449, 448], [398, 399, 450, 449], [399, 400, 451, 450], [400, 401, 452, 451], [401, 402, 453, 452], [402, 403, 454, 453], [403, 404, 455, 454], [404, 405, 456, 455], [405, 406, 457, 456], [406, 407, 458, 457]]
        quads_from_x = [[6, 21, 23, 4], [21, 33, 35, 23], [33, 45, 47, 35], [45, 57, 59, 47], [57, 69, 71, 59], [69, 81, 83, 71], [81, 93, 95, 83], [93, 105, 107, 95], [105, 117, 119, 107], [117, 129, 131, 119], [129, 141, 143, 131], [141, 153, 155, 143], [153, 165, 167, 155], [165, 177, 179, 167], [177, 189, 191, 179], [189, 201, 203, 191], [5, 3, 16, 14], [14, 16, 28, 26], [26, 28, 40, 38], [38, 40, 52, 50], [50, 52, 64, 62], [62, 64, 76, 74], [74, 76, 88, 86], [86, 88, 100, 98], [98, 100, 112, 110], [110, 112, 124, 122], [122, 124, 136, 134], [134, 136, 148, 146], [146, 148, 160, 158], [158, 160, 172, 170], [170, 172, 184, 182], [182, 184, 196, 194], [10, 17, 19, 8], [17, 29, 31, 19], [29, 41, 43, 31], [41, 53, 55, 43], [53, 65, 67, 55], [65, 77, 79, 67], [77, 89, 91, 79], [89, 101, 103, 91], [101, 113, 115, 103], [113, 125, 127, 115], [125, 137, 139, 127], [137, 149, 151, 139], [149, 161, 163, 151], [161, 173, 175, 163], [173, 185, 187, 175], [185, 197, 199, 187], [8, 19, 21, 6], [19, 31, 33, 21], [31, 43, 45, 33], [43, 55, 57, 45], [55, 67, 69, 57], [67, 79, 81, 69], [79, 91, 93, 81], [91, 103, 105, 93], [103, 115, 117, 105], [115, 127, 129, 117], [127, 139, 141, 129], [139, 151, 153, 141], [151, 163, 165, 153], [163, 175, 177, 165], [175, 187, 189, 177], [187, 199, 201, 189], [7, 12, 13, 9], [12, 24, 25, 13], [24, 36, 37, 25], [36, 48, 49, 37], [48, 60, 61, 49], [60, 72, 73, 61], [72, 84, 85, 73], [84, 96, 97, 85], [96, 108, 109, 97], [108, 120, 121, 109], [120, 132, 133, 121], [132, 144, 145, 133], [144, 156, 157, 145], [156, 168, 169, 157], [168, 180, 181, 169], [180, 192, 193, 181], [7, 5, 14, 12], [12, 14, 26, 24], [24, 26, 38, 36], [36, 38, 50, 48], [48, 50, 62, 60], [60, 62, 74, 72], [72, 74, 86, 84], [84, 86, 98, 96], [96, 98, 110, 108], [108, 110, 122, 120], [120, 122, 134, 132], [132, 134, 146, 144], [144, 146, 158, 156], [156, 158, 170, 168], [168, 170, 182, 180], [180, 182, 194, 192], [3, 1, 18, 16], [16, 18, 30, 28], [28, 30, 42, 40], [40, 42, 54, 52], [52, 54, 66, 64], [64, 66, 78, 76], [76, 78, 90, 88], [88, 90, 102, 100], [100, 102, 114, 112], [112, 114, 126, 124], [124, 126, 138, 136], [136, 138, 150, 148], [148, 150, 162, 160], [160, 162, 174, 172], [172, 174, 186, 184], [184, 186, 198, 196], [1, 0, 20, 18], [18, 20, 32, 30], [30, 32, 44, 42], [42, 44, 56, 54], [54, 56, 68, 66], [66, 68, 80, 78], [78, 80, 92, 90], [90, 92, 104, 102], [102, 104, 116, 114], [114, 116, 128, 126], [126, 128, 140, 138], [138, 140, 152, 150], [150, 152, 164, 162], [162, 164, 176, 174], [174, 176, 188, 186], [186, 188, 200, 198], [0, 2, 22, 20], [20, 22, 34, 32], [32, 34, 46, 44], [44, 46, 58, 56], [56, 58, 70, 68], [68, 70, 82, 80], [80, 82, 94, 92], [92, 94, 106, 104], [104, 106, 118, 116], [116, 118, 130, 128], [128, 130, 142, 140], [140, 142, 154, 152], [152, 154, 166, 164], [164, 166, 178, 176], [176, 178, 190, 188], [188, 190, 202, 200], [2, 4, 23, 22], [22, 23, 35, 34], [34, 35, 47, 46], [46, 47, 59, 58], [58, 59, 71, 70], [70, 71, 83, 82], [82, 83, 95, 94], [94, 95, 107, 106], [106, 107, 119, 118], [118, 119, 131, 130], [130, 131, 143, 142], [142, 143, 155, 154], [154, 155, 167, 166], [166, 167, 179, 178], [178, 179, 191, 190], [190, 191, 203, 202], [11, 15, 17, 10], [15, 27, 29, 17], [27, 39, 41, 29], [39, 51, 53, 41], [51, 63, 65, 53], [63, 75, 77, 65], [75, 87, 89, 77], [87, 99, 101, 89], [99, 111, 113, 101], [111, 123, 125, 113], [123, 135, 137, 125], [135, 147, 149, 137], [147, 159, 161, 149], [159, 171, 173, 161], [171, 183, 185, 173], [183, 195, 197, 185], [9, 13, 15, 11], [13, 25, 27, 15], [25, 37, 39, 27], [37, 49, 51, 39], [49, 61, 63, 51], [61, 73, 75, 63], [73, 85, 87, 75], [85, 97, 99, 87], [97, 109, 111, 99], [109, 121, 123, 111], [121, 133, 135, 123], [133, 145, 147, 135], [145, 157, 159, 147], [157, 169, 171, 159], [169, 181, 183, 171], [181, 193, 195, 183]]
        points = [[9.71445147e-16, 4.375, -0.649519], [3.125, 4.375, -0.649519], [6.25, 4.375, -0.649519], [9.375, 4.375, -0.649519], [12.5, 4.375, -0.649519], [15.625, 4.375, -0.649519], [18.75, 4.375, -0.649519], [21.875, 4.375, -0.649519], [25.0, 4.375, -0.649519], [28.125, 4.375, -0.649519], [31.25, 4.375, -0.649519], [34.375, 4.375, -0.649519], [37.5, 4.375, -0.649519], [40.625, 4.375, -0.649519], [43.75, 4.375, -0.649519], [46.875, 4.375, -0.649519], [50.0, 4.375, -0.649519], [1.03240061e-15, 4.649519, -0.375], [3.125, 4.649519, -0.375], [6.25, 4.649519, -0.375], [9.375, 4.649519, -0.375], [12.5, 4.649519, -0.375], [15.625, 4.649519, -0.375], [18.75, 4.649519, -0.375], [21.875, 4.649519, -0.375], [25.0, 4.649519, -0.375], [28.125, 4.649519, -0.375], [31.25, 4.649519, -0.375], [34.375, 4.649519, -0.375], [37.5, 4.649519, -0.375], [40.625, 4.649519, -0.375], [43.75, 4.649519, -0.375], [46.875, 4.649519, -0.375], [50.0, 4.649519, -0.375], [8.8817842e-16, 4.0, -0.75], [3.125, 4.0, -0.75], [6.25, 4.0, -0.75], [9.375, 4.0, -0.75], [12.5, 4.0, -0.75], [15.625, 4.0, -0.75], [18.75, 4.0, -0.75], [21.875, 4.0, -0.75], [25.0, 4.0, -0.75], [28.125, 4.0, -0.75], [31.25, 4.0, -0.75], [34.375, 4.0, -0.75], [37.5, 4.0, -0.75], [40.625, 4.0, -0.75], [43.75, 4.0, -0.75], [46.875, 4.0, -0.75], [50.0, 4.0, -0.75], [1.05471187e-15, 4.75, 0.0], [3.125, 4.75, 0.0], [6.25, 4.75, 0.0], [9.375, 4.75, 0.0], [12.5, 4.75, 0.0], [15.625, 4.75, 0.0], [18.75, 4.75, 0.0], [21.875, 4.75, 0.0], [25.0, 4.75, 0.0], [28.125, 4.75, 0.0], [31.25, 4.75, 0.0], [34.375, 4.75, 0.0], [37.5, 4.75, 0.0], [40.625, 4.75, 0.0], [43.75, 4.75, 0.0], [46.875, 4.75, 0.0], [50.0, 4.75, 0.0], [8.04911693e-16, 3.625, -0.649519], [3.125, 3.625, -0.649519], [6.25, 3.625, -0.649519], [9.375, 3.625, -0.649519], [12.5, 3.625, -0.649519], [15.625, 3.625, -0.649519], [18.75, 3.625, -0.649519], [21.875, 3.625, -0.649519], [25.0, 3.625, -0.649519], [28.125, 3.625, -0.649519], [31.25, 3.625, -0.649519], [34.375, 3.625, -0.649519], [37.5, 3.625, -0.649519], [40.625, 3.625, -0.649519], [43.75, 3.625, -0.649519], [46.875, 3.625, -0.649519], [50.0, 3.625, -0.649519], [1.03240061e-15, 4.649519, 0.375], [3.125, 4.649519, 0.375], [6.25, 4.649519, 0.375], [9.375, 4.649519, 0.375], [12.5, 4.649519, 0.375], [15.625, 4.649519, 0.375], [18.75, 4.649519, 0.375], [21.875, 4.649519, 0.375], [25.0, 4.649519, 0.375], [28.125, 4.649519, 0.375], [31.25, 4.649519, 0.375], [34.375, 4.649519, 0.375], [37.5, 4.649519, 0.375], [40.625, 4.649519, 0.375], [43.75, 4.649519, 0.375], [46.875, 4.649519, 0.375], [50.0, 4.649519, 0.375], [7.4395623e-16, 3.350481, -0.375], [3.125, 3.350481, -0.375], [6.25, 3.350481, -0.375], [9.375, 3.350481, -0.375], [12.5, 3.350481, -0.375], [15.625, 3.350481, -0.375], [18.75, 3.350481, -0.375], [21.875, 3.350481, -0.375], [25.0, 3.350481, -0.375], [28.125, 3.350481, -0.375], [31.25, 3.350481, -0.375], [34.375, 3.350481, -0.375], [37.5, 3.350481, -0.375], [40.625, 3.350481, -0.375], [43.75, 3.350481, -0.375], [46.875, 3.350481, -0.375], [50.0, 3.350481, -0.375], [9.71445147e-16, 4.375, 0.649519], [3.125, 4.375, 0.649519], [6.25, 4.375, 0.649519], [9.375, 4.375, 0.649519], [12.5, 4.375, 0.649519], [15.625, 4.375, 0.649519], [18.75, 4.375, 0.649519], [21.875, 4.375, 0.649519], [25.0, 4.375, 0.649519], [28.125, 4.375, 0.649519], [31.25, 4.375, 0.649519], [34.375, 4.375, 0.649519], [37.5, 4.375, 0.649519], [40.625, 4.375, 0.649519], [43.75, 4.375, 0.649519], [46.875, 4.375, 0.649519], [50.0, 4.375, 0.649519], [7.21644966e-16, 3.25, 0.0], [3.125, 3.25, 0.0], [6.25, 3.25, 0.0], [9.375, 3.25, 0.0], [12.5, 3.25, 0.0], [15.625, 3.25, 0.0], [18.75, 3.25, 0.0], [21.875, 3.25, 0.0], [25.0, 3.25, 0.0], [28.125, 3.25, 0.0], [31.25, 3.25, 0.0], [34.375, 3.25, 0.0], [37.5, 3.25, 0.0], [40.625, 3.25, 0.0], [43.75, 3.25, 0.0], [46.875, 3.25, 0.0], [50.0, 3.25, 0.0], [8.8817842e-16, 4.0, 0.75], [3.125, 4.0, 0.75], [6.25, 4.0, 0.75], [9.375, 4.0, 0.75], [12.5, 4.0, 0.75], [15.625, 4.0, 0.75], [18.75, 4.0, 0.75], [21.875, 4.0, 0.75], [25.0, 4.0, 0.75], [28.125, 4.0, 0.75], [31.25, 4.0, 0.75], [34.375, 4.0, 0.75], [37.5, 4.0, 0.75], [40.625, 4.0, 0.75], [43.75, 4.0, 0.75], [46.875, 4.0, 0.75], [50.0, 4.0, 0.75], [7.4395623e-16, 3.350481, 0.375], [3.125, 3.350481, 0.375], [6.25, 3.350481, 0.375], [9.375, 3.350481, 0.375], [12.5, 3.350481, 0.375], [15.625, 3.350481, 0.375], [18.75, 3.350481, 0.375], [21.875, 3.350481, 0.375], [25.0, 3.350481, 0.375], [28.125, 3.350481, 0.375], [31.25, 3.350481, 0.375], [34.375, 3.350481, 0.375], [37.5, 3.350481, 0.375], [40.625, 3.350481, 0.375], [43.75, 3.350481, 0.375], [46.875, 3.350481, 0.375], [50.0, 3.350481, 0.375], [8.04911693e-16, 3.625, 0.649519], [3.125, 3.625, 0.649519], [6.25, 3.625, 0.649519], [9.375, 3.625, 0.649519], [12.5, 3.625, 0.649519], [15.625, 3.625, 0.649519], [18.75, 3.625, 0.649519], [21.875, 3.625, 0.649519], [25.0, 3.625, 0.649519], [28.125, 3.625, 0.649519], [31.25, 3.625, 0.649519], [34.375, 3.625, 0.649519], [37.5, 3.625, 0.649519], [40.625, 3.625, 0.649519], [43.75, 3.625, 0.649519], [46.875, 3.625, 0.649519], [50.0, 3.625, 0.649519]]
        indices = [374, 375, 376, 377, 378, 379, 380, 381, 382, 383, 384, 385, 386, 387, 388, 389, 390, 391, 392, 393, 394, 395, 396, 397, 398, 399, 400, 401, 402, 403, 404, 405, 406, 407, 408, 409, 410, 411, 412, 413, 414, 415, 416, 417, 418, 419, 420, 421, 422, 423, 424, 442, 443, 444, 445, 446, 447, 448, 449, 450, 451, 452, 453, 454, 455, 456, 457, 458, 459, 460, 461, 462, 463, 464, 465, 466, 467, 468, 469, 470, 471, 472, 473, 474, 475, 510, 511, 512, 513, 514, 515, 516, 517, 518, 519, 520, 521, 522, 523, 524, 525, 526, 595, 596, 597, 598, 599, 600, 601, 602, 603, 604, 605, 606, 607, 608, 609, 610, 611, 663, 664, 665, 666, 667, 668, 669, 670, 671, 672, 673, 674, 675, 676, 677, 678, 679, 697, 698, 699, 700, 701, 702, 703, 704, 705, 706, 707, 708, 709, 710, 711, 712, 713, 748, 749, 750, 751, 752, 753, 754, 755, 756, 757, 758, 759, 760, 761, 762, 763, 764, 765, 766, 767, 768, 769, 770, 771, 772, 773, 774, 775, 776, 777, 778, 779, 780, 781, 799, 800, 801, 802, 803, 804, 805, 806, 807, 808, 809, 810, 811, 812, 813, 814, 815]

        [new_points_from_x, conv_tab ,new_quads_from_x] = mf.remesh_from_axis(points = points, mesh = quads,axis = 0,old_indices = indices)

        if new_quads_from_x != quads_from_x :
            print("- Remeshing des quads celon x faux - #004 ")
        self.assertEqual(new_quads_from_x, quads_from_x)

        [new_points, new_conv_tab] = mf.index_from_axis(points = points, axis = 0,old_indices = indices)
        new_quads = mf.reindex_mesh(conv_tab=new_conv_tab,mesh=quads)

        # print(new_quads)

        if new_points != new_points_from_x :
            print("- Erreur - Reordonnation des points celon x diffrent #001")
        self.assertEqual(new_points, new_points_from_x)

        if new_conv_tab != conv_tab :
            print("- Erreur - Tableau de conversion faux #002")
        self.assertEqual(new_conv_tab, conv_tab)

        if new_quads_from_x != new_quads :
            print("- Erreur - Remeshing des quads faux #003")
        self.assertEqual(new_quads_from_x, new_quads)

        default_indices = [k for k in range(204)]

        # print(default_indices)

        [new_points_from_x_d, conv_tab_d ,new_quads_from_x_d] = mf.remesh_from_axis(points = points, mesh = new_quads,axis = 1)

        [new_points_d, new_conv_tab_d] = mf.index_from_axis(points = points, axis = 1,old_indices = default_indices)
        new_quads_d = mf.reindex_mesh(conv_tab=new_conv_tab_d,mesh=new_quads)

        if new_points_d != new_points_from_x_d :
            print("- Erreur - Reordonnation des points celon x diffrent #005")
        self.assertEqual(new_points_d, new_points_from_x_d)

        if new_conv_tab_d != conv_tab_d :
            print("- Erreur - Tableau de conversion faux #006")
        self.assertEqual(new_conv_tab, conv_tab)

        if new_quads_d != new_quads_from_x_d :
            print("- Erreur - Remeshing des quads faux #007")
        self.assertEqual(new_quads_from_x, new_quads)


    def test_circle_detection_regular(self):
        points = [[9.71445147e-16, 4.375, -0.649519], [3.125, 4.375, -0.649519], [6.25, 4.375, -0.649519], [9.375, 4.375, -0.649519], [12.5, 4.375, -0.649519], [15.625, 4.375, -0.649519], [18.75, 4.375, -0.649519], [21.875, 4.375, -0.649519], [25.0, 4.375, -0.649519], [28.125, 4.375, -0.649519], [31.25, 4.375, -0.649519], [34.375, 4.375, -0.649519], [37.5, 4.375, -0.649519], [40.625, 4.375, -0.649519], [43.75, 4.375, -0.649519], [46.875, 4.375, -0.649519], [50.0, 4.375, -0.649519], [1.03240061e-15, 4.649519, -0.375], [3.125, 4.649519, -0.375], [6.25, 4.649519, -0.375], [9.375, 4.649519, -0.375], [12.5, 4.649519, -0.375], [15.625, 4.649519, -0.375], [18.75, 4.649519, -0.375], [21.875, 4.649519, -0.375], [25.0, 4.649519, -0.375], [28.125, 4.649519, -0.375], [31.25, 4.649519, -0.375], [34.375, 4.649519, -0.375], [37.5, 4.649519, -0.375], [40.625, 4.649519, -0.375], [43.75, 4.649519, -0.375], [46.875, 4.649519, -0.375], [50.0, 4.649519, -0.375], [8.8817842e-16, 4.0, -0.75], [3.125, 4.0, -0.75], [6.25, 4.0, -0.75], [9.375, 4.0, -0.75], [12.5, 4.0, -0.75], [15.625, 4.0, -0.75], [18.75, 4.0, -0.75], [21.875, 4.0, -0.75], [25.0, 4.0, -0.75], [28.125, 4.0, -0.75], [31.25, 4.0, -0.75], [34.375, 4.0, -0.75], [37.5, 4.0, -0.75], [40.625, 4.0, -0.75], [43.75, 4.0, -0.75], [46.875, 4.0, -0.75], [50.0, 4.0, -0.75], [1.05471187e-15, 4.75, 0.0], [3.125, 4.75, 0.0], [6.25, 4.75, 0.0], [9.375, 4.75, 0.0], [12.5, 4.75, 0.0], [15.625, 4.75, 0.0], [18.75, 4.75, 0.0], [21.875, 4.75, 0.0], [25.0, 4.75, 0.0], [28.125, 4.75, 0.0], [31.25, 4.75, 0.0], [34.375, 4.75, 0.0], [37.5, 4.75, 0.0], [40.625, 4.75, 0.0], [43.75, 4.75, 0.0], [46.875, 4.75, 0.0], [50.0, 4.75, 0.0], [8.04911693e-16, 3.625, -0.649519], [3.125, 3.625, -0.649519], [6.25, 3.625, -0.649519], [9.375, 3.625, -0.649519], [12.5, 3.625, -0.649519], [15.625, 3.625, -0.649519], [18.75, 3.625, -0.649519], [21.875, 3.625, -0.649519], [25.0, 3.625, -0.649519], [28.125, 3.625, -0.649519], [31.25, 3.625, -0.649519], [34.375, 3.625, -0.649519], [37.5, 3.625, -0.649519], [40.625, 3.625, -0.649519], [43.75, 3.625, -0.649519], [46.875, 3.625, -0.649519], [50.0, 3.625, -0.649519], [1.03240061e-15, 4.649519, 0.375], [3.125, 4.649519, 0.375], [6.25, 4.649519, 0.375], [9.375, 4.649519, 0.375], [12.5, 4.649519, 0.375], [15.625, 4.649519, 0.375], [18.75, 4.649519, 0.375], [21.875, 4.649519, 0.375], [25.0, 4.649519, 0.375], [28.125, 4.649519, 0.375], [31.25, 4.649519, 0.375], [34.375, 4.649519, 0.375], [37.5, 4.649519, 0.375], [40.625, 4.649519, 0.375], [43.75, 4.649519, 0.375], [46.875, 4.649519, 0.375], [50.0, 4.649519, 0.375], [7.4395623e-16, 3.350481, -0.375], [3.125, 3.350481, -0.375], [6.25, 3.350481, -0.375], [9.375, 3.350481, -0.375], [12.5, 3.350481, -0.375], [15.625, 3.350481, -0.375], [18.75, 3.350481, -0.375], [21.875, 3.350481, -0.375], [25.0, 3.350481, -0.375], [28.125, 3.350481, -0.375], [31.25, 3.350481, -0.375], [34.375, 3.350481, -0.375], [37.5, 3.350481, -0.375], [40.625, 3.350481, -0.375], [43.75, 3.350481, -0.375], [46.875, 3.350481, -0.375], [50.0, 3.350481, -0.375], [9.71445147e-16, 4.375, 0.649519], [3.125, 4.375, 0.649519], [6.25, 4.375, 0.649519], [9.375, 4.375, 0.649519], [12.5, 4.375, 0.649519], [15.625, 4.375, 0.649519], [18.75, 4.375, 0.649519], [21.875, 4.375, 0.649519], [25.0, 4.375, 0.649519], [28.125, 4.375, 0.649519], [31.25, 4.375, 0.649519], [34.375, 4.375, 0.649519], [37.5, 4.375, 0.649519], [40.625, 4.375, 0.649519], [43.75, 4.375, 0.649519], [46.875, 4.375, 0.649519], [50.0, 4.375, 0.649519], [7.21644966e-16, 3.25, 0.0], [3.125, 3.25, 0.0], [6.25, 3.25, 0.0], [9.375, 3.25, 0.0], [12.5, 3.25, 0.0], [15.625, 3.25, 0.0], [18.75, 3.25, 0.0], [21.875, 3.25, 0.0], [25.0, 3.25, 0.0], [28.125, 3.25, 0.0], [31.25, 3.25, 0.0], [34.375, 3.25, 0.0], [37.5, 3.25, 0.0], [40.625, 3.25, 0.0], [43.75, 3.25, 0.0], [46.875, 3.25, 0.0], [50.0, 3.25, 0.0], [8.8817842e-16, 4.0, 0.75], [3.125, 4.0, 0.75], [6.25, 4.0, 0.75], [9.375, 4.0, 0.75], [12.5, 4.0, 0.75], [15.625, 4.0, 0.75], [18.75, 4.0, 0.75], [21.875, 4.0, 0.75], [25.0, 4.0, 0.75], [28.125, 4.0, 0.75], [31.25, 4.0, 0.75], [34.375, 4.0, 0.75], [37.5, 4.0, 0.75], [40.625, 4.0, 0.75], [43.75, 4.0, 0.75], [46.875, 4.0, 0.75], [50.0, 4.0, 0.75], [7.4395623e-16, 3.350481, 0.375], [3.125, 3.350481, 0.375], [6.25, 3.350481, 0.375], [9.375, 3.350481, 0.375], [12.5, 3.350481, 0.375], [15.625, 3.350481, 0.375], [18.75, 3.350481, 0.375], [21.875, 3.350481, 0.375], [25.0, 3.350481, 0.375], [28.125, 3.350481, 0.375], [31.25, 3.350481, 0.375], [34.375, 3.350481, 0.375], [37.5, 3.350481, 0.375], [40.625, 3.350481, 0.375], [43.75, 3.350481, 0.375], [46.875, 3.350481, 0.375], [50.0, 3.350481, 0.375], [8.04911693e-16, 3.625, 0.649519], [3.125, 3.625, 0.649519], [6.25, 3.625, 0.649519], [9.375, 3.625, 0.649519], [12.5, 3.625, 0.649519], [15.625, 3.625, 0.649519], [18.75, 3.625, 0.649519], [21.875, 3.625, 0.649519], [25.0, 3.625, 0.649519], [28.125, 3.625, 0.649519], [31.25, 3.625, 0.649519], [34.375, 3.625, 0.649519], [37.5, 3.625, 0.649519], [40.625, 3.625, 0.649519], [43.75, 3.625, 0.649519], [46.875, 3.625, 0.649519], [50.0, 3.625, 0.649519]]
        pt_per_slice = 12
        point_tab_sorted_circles = [[[7.21644966e-16, 3.25, 0.0], [7.4395623e-16, 3.350481, -0.375], [7.4395623e-16, 3.350481, 0.375], [8.04911693e-16, 3.625, -0.649519], [8.04911693e-16, 3.625, 0.649519], [8.8817842e-16, 4.0, -0.75], [8.8817842e-16, 4.0, 0.75], [9.71445147e-16, 4.375, -0.649519], [9.71445147e-16, 4.375, 0.649519], [1.03240061e-15, 4.649519, -0.375], [1.03240061e-15, 4.649519, 0.375], [1.05471187e-15, 4.75, 0.0]], [[3.125, 4.375, -0.649519], [3.125, 4.649519, -0.375], [3.125, 4.0, -0.75], [3.125, 4.75, 0.0], [3.125, 3.625, -0.649519], [3.125, 4.649519, 0.375], [3.125, 3.350481, -0.375], [3.125, 4.375, 0.649519], [3.125, 3.25, 0.0], [3.125, 4.0, 0.75], [3.125, 3.350481, 0.375], [3.125, 3.625, 0.649519]], [[6.25, 4.375, -0.649519], [6.25, 4.649519, -0.375], [6.25, 4.0, -0.75], [6.25, 4.75, 0.0], [6.25, 3.625, -0.649519], [6.25, 4.649519, 0.375], [6.25, 3.350481, -0.375], [6.25, 4.375, 0.649519], [6.25, 3.25, 0.0], [6.25, 4.0, 0.75], [6.25, 3.350481, 0.375], [6.25, 3.625, 0.649519]], [[9.375, 4.375, -0.649519], [9.375, 4.649519, -0.375], [9.375, 4.0, -0.75], [9.375, 4.75, 0.0], [9.375, 3.625, -0.649519], [9.375, 4.649519, 0.375], [9.375, 3.350481, -0.375], [9.375, 4.375, 0.649519], [9.375, 3.25, 0.0], [9.375, 4.0, 0.75], [9.375, 3.350481, 0.375], [9.375, 3.625, 0.649519]], [[12.5, 4.375, -0.649519], [12.5, 4.649519, -0.375], [12.5, 4.0, -0.75], [12.5, 4.75, 0.0], [12.5, 3.625, -0.649519], [12.5, 4.649519, 0.375], [12.5, 3.350481, -0.375], [12.5, 4.375, 0.649519], [12.5, 3.25, 0.0], [12.5, 4.0, 0.75], [12.5, 3.350481, 0.375], [12.5, 3.625, 0.649519]], [[15.625, 4.375, -0.649519], [15.625, 4.649519, -0.375], [15.625, 4.0, -0.75], [15.625, 4.75, 0.0], [15.625, 3.625, -0.649519], [15.625, 4.649519, 0.375], [15.625, 3.350481, -0.375], [15.625, 4.375, 0.649519], [15.625, 3.25, 0.0], [15.625, 4.0, 0.75], [15.625, 3.350481, 0.375], [15.625, 3.625, 0.649519]], [[18.75, 4.375, -0.649519], [18.75, 4.649519, -0.375], [18.75, 4.0, -0.75], [18.75, 4.75, 0.0], [18.75, 3.625, -0.649519], [18.75, 4.649519, 0.375], [18.75, 3.350481, -0.375], [18.75, 4.375, 0.649519], [18.75, 3.25, 0.0], [18.75, 4.0, 0.75], [18.75, 3.350481, 0.375], [18.75, 3.625, 0.649519]], [[21.875, 4.375, -0.649519], [21.875, 4.649519, -0.375], [21.875, 4.0, -0.75], [21.875, 4.75, 0.0], [21.875, 3.625, -0.649519], [21.875, 4.649519, 0.375], [21.875, 3.350481, -0.375], [21.875, 4.375, 0.649519], [21.875, 3.25, 0.0], [21.875, 4.0, 0.75], [21.875, 3.350481, 0.375], [21.875, 3.625, 0.649519]], [[25.0, 4.375, -0.649519], [25.0, 4.649519, -0.375], [25.0, 4.0, -0.75], [25.0, 4.75, 0.0], [25.0, 3.625, -0.649519], [25.0, 4.649519, 0.375], [25.0, 3.350481, -0.375], [25.0, 4.375, 0.649519], [25.0, 3.25, 0.0], [25.0, 4.0, 0.75], [25.0, 3.350481, 0.375], [25.0, 3.625, 0.649519]], [[28.125, 4.375, -0.649519], [28.125, 4.649519, -0.375], [28.125, 4.0, -0.75], [28.125, 4.75, 0.0], [28.125, 3.625, -0.649519], [28.125, 4.649519, 0.375], [28.125, 3.350481, -0.375], [28.125, 4.375, 0.649519], [28.125, 3.25, 0.0], [28.125, 4.0, 0.75], [28.125, 3.350481, 0.375], [28.125, 3.625, 0.649519]], [[31.25, 4.375, -0.649519], [31.25, 4.649519, -0.375], [31.25, 4.0, -0.75], [31.25, 4.75, 0.0], [31.25, 3.625, -0.649519], [31.25, 4.649519, 0.375], [31.25, 3.350481, -0.375], [31.25, 4.375, 0.649519], [31.25, 3.25, 0.0], [31.25, 4.0, 0.75], [31.25, 3.350481, 0.375], [31.25, 3.625, 0.649519]], [[34.375, 4.375, -0.649519], [34.375, 4.649519, -0.375], [34.375, 4.0, -0.75], [34.375, 4.75, 0.0], [34.375, 3.625, -0.649519], [34.375, 4.649519, 0.375], [34.375, 3.350481, -0.375], [34.375, 4.375, 0.649519], [34.375, 3.25, 0.0], [34.375, 4.0, 0.75], [34.375, 3.350481, 0.375], [34.375, 3.625, 0.649519]], [[37.5, 4.375, -0.649519], [37.5, 4.649519, -0.375], [37.5, 4.0, -0.75], [37.5, 4.75, 0.0], [37.5, 3.625, -0.649519], [37.5, 4.649519, 0.375], [37.5, 3.350481, -0.375], [37.5, 4.375, 0.649519], [37.5, 3.25, 0.0], [37.5, 4.0, 0.75], [37.5, 3.350481, 0.375], [37.5, 3.625, 0.649519]], [[40.625, 4.375, -0.649519], [40.625, 4.649519, -0.375], [40.625, 4.0, -0.75], [40.625, 4.75, 0.0], [40.625, 3.625, -0.649519], [40.625, 4.649519, 0.375], [40.625, 3.350481, -0.375], [40.625, 4.375, 0.649519], [40.625, 3.25, 0.0], [40.625, 4.0, 0.75], [40.625, 3.350481, 0.375], [40.625, 3.625, 0.649519]], [[43.75, 4.375, -0.649519], [43.75, 4.649519, -0.375], [43.75, 4.0, -0.75], [43.75, 4.75, 0.0], [43.75, 3.625, -0.649519], [43.75, 4.649519, 0.375], [43.75, 3.350481, -0.375], [43.75, 4.375, 0.649519], [43.75, 3.25, 0.0], [43.75, 4.0, 0.75], [43.75, 3.350481, 0.375], [43.75, 3.625, 0.649519]], [[46.875, 4.375, -0.649519], [46.875, 4.649519, -0.375], [46.875, 4.0, -0.75], [46.875, 4.75, 0.0], [46.875, 3.625, -0.649519], [46.875, 4.649519, 0.375], [46.875, 3.350481, -0.375], [46.875, 4.375, 0.649519], [46.875, 3.25, 0.0], [46.875, 4.0, 0.75], [46.875, 3.350481, 0.375], [46.875, 3.625, 0.649519]], [[50.0, 4.375, -0.649519], [50.0, 4.649519, -0.375], [50.0, 4.0, -0.75], [50.0, 4.75, 0.0], [50.0, 3.625, -0.649519], [50.0, 4.649519, 0.375], [50.0, 3.350481, -0.375], [50.0, 4.375, 0.649519], [50.0, 3.25, 0.0], [50.0, 4.0, 0.75], [50.0, 3.350481, 0.375], [50.0, 3.625, 0.649519]]]
        ind_tab_sorted_circles = [[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35], [36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47], [48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59], [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71], [72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83], [84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95], [96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107], [108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119], [120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131], [132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143], [144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155], [156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167], [168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179], [180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191], [192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203]]
        indices = [374, 375, 376, 377, 378, 379, 380, 381, 382, 383, 384, 385, 386, 387, 388, 389, 390, 391, 392, 393, 394, 395, 396, 397, 398, 399, 400, 401, 402, 403, 404, 405, 406, 407, 408, 409, 410, 411, 412, 413, 414, 415, 416, 417, 418, 419, 420, 421, 422, 423, 424, 442, 443, 444, 445, 446, 447, 448, 449, 450, 451, 452, 453, 454, 455, 456, 457, 458, 459, 460, 461, 462, 463, 464, 465, 466, 467, 468, 469, 470, 471, 472, 473, 474, 475, 510, 511, 512, 513, 514, 515, 516, 517, 518, 519, 520, 521, 522, 523, 524, 525, 526, 595, 596, 597, 598, 599, 600, 601, 602, 603, 604, 605, 606, 607, 608, 609, 610, 611, 663, 664, 665, 666, 667, 668, 669, 670, 671, 672, 673, 674, 675, 676, 677, 678, 679, 697, 698, 699, 700, 701, 702, 703, 704, 705, 706, 707, 708, 709, 710, 711, 712, 713, 748, 749, 750, 751, 752, 753, 754, 755, 756, 757, 758, 759, 760, 761, 762, 763, 764, 765, 766, 767, 768, 769, 770, 771, 772, 773, 774, 775, 776, 777, 778, 779, 780, 781, 799, 800, 801, 802, 803, 804, 805, 806, 807, 808, 809, 810, 811, 812, 813, 814, 815]
        ind_tab_sorted_circles_i = [[697, 595, 765, 459, 799, 408, 748, 374, 663, 391, 510, 442], [375, 392, 409, 443, 460, 511, 596, 664, 698, 749, 766, 800], [376, 393, 410, 444, 461, 512, 597, 665, 699, 750, 767, 801], [377, 394, 411, 445, 462, 513, 598, 666, 700, 751, 768, 802], [378, 395, 412, 446, 463, 514, 599, 667, 701, 752, 769, 803], [379, 396, 413, 447, 464, 515, 600, 668, 702, 753, 770, 804], [380, 397, 414, 448, 465, 516, 601, 669, 703, 754, 771, 805], [381, 398, 415, 449, 466, 517, 602, 670, 704, 755, 772, 806], [382, 399, 416, 450, 467, 518, 603, 671, 705, 756, 773, 807], [383, 400, 417, 451, 468, 519, 604, 672, 706, 757, 774, 808], [384, 401, 418, 452, 469, 520, 605, 673, 707, 758, 775, 809], [385, 402, 419, 453, 470, 521, 606, 674, 708, 759, 776, 810], [386, 403, 420, 454, 471, 522, 607, 675, 709, 760, 777, 811], [387, 404, 421, 455, 472, 523, 608, 676, 710, 761, 778, 812], [388, 405, 422, 456, 473, 524, 609, 677, 711, 762, 779, 813], [389, 406, 423, 457, 474, 525, 610, 678, 712, 763, 780, 814], [390, 407, 424, 458, 475, 526, 611, 679, 713, 764, 781, 815]]
        ind_tab_sorted_c = [[136, 102, 170, 68, 187, 34, 153, 0, 119, 17, 85, 51], [1, 18, 35, 52, 69, 86, 103, 120, 137, 154, 171, 188], [2, 19, 36, 53, 70, 87, 104, 121, 138, 155, 172, 189], [3, 20, 37, 54, 71, 88, 105, 122, 139, 156, 173, 190], [4, 21, 38, 55, 72, 89, 106, 123, 140, 157, 174, 191], [5, 22, 39, 56, 73, 90, 107, 124, 141, 158, 175, 192], [6, 23, 40, 57, 74, 91, 108, 125, 142, 159, 176, 193], [7, 24, 41, 58, 75, 92, 109, 126, 143, 160, 177, 194], [8, 25, 42, 59, 76, 93, 110, 127, 144, 161, 178, 195], [9, 26, 43, 60, 77, 94, 111, 128, 145, 162, 179, 196], [10, 27, 44, 61, 78, 95, 112, 129, 146, 163, 180, 197], [11, 28, 45, 62, 79, 96, 113, 130, 147, 164, 181, 198], [12, 29, 46, 63, 80, 97, 114, 131, 148, 165, 182, 199], [13, 30, 47, 64, 81, 98, 115, 132, 149, 166, 183, 200], [14, 31, 48, 65, 82, 99, 116, 133, 150, 167, 184, 201], [15, 32, 49, 66, 83, 100, 117, 134, 151, 168, 185, 202], [16, 33, 50, 67, 84, 101, 118, 135, 152, 169, 186, 203]]


        [new_points, conv_tab] = mf.index_from_axis(points = points, axis = 0)
        [points_tab, ind_tab] = mf.circle_detection_regular(points = new_points, pt_per_slice=pt_per_slice)

        # print(points_tab)
        # print(ind_tab)

        if points_tab != point_tab_sorted_circles :
            print("- Erreur - Tri des cercles - Points #009")
        self.assertEqual(points_tab, point_tab_sorted_circles)

        if ind_tab != ind_tab_sorted_circles :
            print("- Erreur - Tri des cercles - Indices #010")
        self.assertEqual(ind_tab, ind_tab_sorted_circles)

        [new_points_c, conv_tab_c] = mf.index_from_axis(points = points, axis = 0)
        [points_tab_c, ind_tab_c] = mf.circle_detection_regular(points = new_points, pt_per_slice=pt_per_slice,indices = conv_tab_c)

        # print(points_tab_c)
        # print(ind_tab_c)

        if points_tab_c != point_tab_sorted_circles :
            print("- Erreur - Tri des cercles - Points #009")
        self.assertEqual(points_tab_c, point_tab_sorted_circles)

        if ind_tab_c != ind_tab_sorted_c :
            print("- Erreur - Tri des cercles - Indices #010")
        self.assertEqual(ind_tab_c, ind_tab_sorted_c)

        [new_points_i, conv_tab_i] = mf.index_from_axis(points = points, axis = 0,old_indices = indices)
        [points_tab_i, ind_tab_i] = mf.circle_detection_regular(points = new_points_i, pt_per_slice=pt_per_slice,indices = conv_tab_i)

        # print(ind_tab_i)

        if points_tab_i != point_tab_sorted_circles :
            print("- Erreur - Tri des cercles - Points #011")
        self.assertEqual(points_tab_i, point_tab_sorted_circles)

        if ind_tab_i != ind_tab_sorted_circles_i :
            print("- Erreur - Tri des cercles - Indices #012")
        self.assertEqual(ind_tab_i, ind_tab_sorted_circles_i)

    def test_circle_detection_axis(self):
        points = [[9.71445147e-16, 4.375, -0.649519], [3.125, 4.375, -0.649519], [6.25, 4.375, -0.649519], [9.375, 4.375, -0.649519], [12.5, 4.375, -0.649519], [15.625, 4.375, -0.649519], [18.75, 4.375, -0.649519], [21.875, 4.375, -0.649519], [25.0, 4.375, -0.649519], [28.125, 4.375, -0.649519], [31.25, 4.375, -0.649519], [34.375, 4.375, -0.649519], [37.5, 4.375, -0.649519], [40.625, 4.375, -0.649519], [43.75, 4.375, -0.649519], [46.875, 4.375, -0.649519], [50.0, 4.375, -0.649519], [1.03240061e-15, 4.649519, -0.375], [3.125, 4.649519, -0.375], [6.25, 4.649519, -0.375], [9.375, 4.649519, -0.375], [12.5, 4.649519, -0.375], [15.625, 4.649519, -0.375], [18.75, 4.649519, -0.375], [21.875, 4.649519, -0.375], [25.0, 4.649519, -0.375], [28.125, 4.649519, -0.375], [31.25, 4.649519, -0.375], [34.375, 4.649519, -0.375], [37.5, 4.649519, -0.375], [40.625, 4.649519, -0.375], [43.75, 4.649519, -0.375], [46.875, 4.649519, -0.375], [50.0, 4.649519, -0.375], [8.8817842e-16, 4.0, -0.75], [3.125, 4.0, -0.75], [6.25, 4.0, -0.75], [9.375, 4.0, -0.75], [12.5, 4.0, -0.75], [15.625, 4.0, -0.75], [18.75, 4.0, -0.75], [21.875, 4.0, -0.75], [25.0, 4.0, -0.75], [28.125, 4.0, -0.75], [31.25, 4.0, -0.75], [34.375, 4.0, -0.75], [37.5, 4.0, -0.75], [40.625, 4.0, -0.75], [43.75, 4.0, -0.75], [46.875, 4.0, -0.75], [50.0, 4.0, -0.75], [1.05471187e-15, 4.75, 0.0], [3.125, 4.75, 0.0], [6.25, 4.75, 0.0], [9.375, 4.75, 0.0], [12.5, 4.75, 0.0], [15.625, 4.75, 0.0], [18.75, 4.75, 0.0], [21.875, 4.75, 0.0], [25.0, 4.75, 0.0], [28.125, 4.75, 0.0], [31.25, 4.75, 0.0], [34.375, 4.75, 0.0], [37.5, 4.75, 0.0], [40.625, 4.75, 0.0], [43.75, 4.75, 0.0], [46.875, 4.75, 0.0], [50.0, 4.75, 0.0], [8.04911693e-16, 3.625, -0.649519], [3.125, 3.625, -0.649519], [6.25, 3.625, -0.649519], [9.375, 3.625, -0.649519], [12.5, 3.625, -0.649519], [15.625, 3.625, -0.649519], [18.75, 3.625, -0.649519], [21.875, 3.625, -0.649519], [25.0, 3.625, -0.649519], [28.125, 3.625, -0.649519], [31.25, 3.625, -0.649519], [34.375, 3.625, -0.649519], [37.5, 3.625, -0.649519], [40.625, 3.625, -0.649519], [43.75, 3.625, -0.649519], [46.875, 3.625, -0.649519], [50.0, 3.625, -0.649519], [1.03240061e-15, 4.649519, 0.375], [3.125, 4.649519, 0.375], [6.25, 4.649519, 0.375], [9.375, 4.649519, 0.375], [12.5, 4.649519, 0.375], [15.625, 4.649519, 0.375], [18.75, 4.649519, 0.375], [21.875, 4.649519, 0.375], [25.0, 4.649519, 0.375], [28.125, 4.649519, 0.375], [31.25, 4.649519, 0.375], [34.375, 4.649519, 0.375], [37.5, 4.649519, 0.375], [40.625, 4.649519, 0.375], [43.75, 4.649519, 0.375], [46.875, 4.649519, 0.375], [50.0, 4.649519, 0.375], [7.4395623e-16, 3.350481, -0.375], [3.125, 3.350481, -0.375], [6.25, 3.350481, -0.375], [9.375, 3.350481, -0.375], [12.5, 3.350481, -0.375], [15.625, 3.350481, -0.375], [18.75, 3.350481, -0.375], [21.875, 3.350481, -0.375], [25.0, 3.350481, -0.375], [28.125, 3.350481, -0.375], [31.25, 3.350481, -0.375], [34.375, 3.350481, -0.375], [37.5, 3.350481, -0.375], [40.625, 3.350481, -0.375], [43.75, 3.350481, -0.375], [46.875, 3.350481, -0.375], [50.0, 3.350481, -0.375], [9.71445147e-16, 4.375, 0.649519], [3.125, 4.375, 0.649519], [6.25, 4.375, 0.649519], [9.375, 4.375, 0.649519], [12.5, 4.375, 0.649519], [15.625, 4.375, 0.649519], [18.75, 4.375, 0.649519], [21.875, 4.375, 0.649519], [25.0, 4.375, 0.649519], [28.125, 4.375, 0.649519], [31.25, 4.375, 0.649519], [34.375, 4.375, 0.649519], [37.5, 4.375, 0.649519], [40.625, 4.375, 0.649519], [43.75, 4.375, 0.649519], [46.875, 4.375, 0.649519], [50.0, 4.375, 0.649519], [7.21644966e-16, 3.25, 0.0], [3.125, 3.25, 0.0], [6.25, 3.25, 0.0], [9.375, 3.25, 0.0], [12.5, 3.25, 0.0], [15.625, 3.25, 0.0], [18.75, 3.25, 0.0], [21.875, 3.25, 0.0], [25.0, 3.25, 0.0], [28.125, 3.25, 0.0], [31.25, 3.25, 0.0], [34.375, 3.25, 0.0], [37.5, 3.25, 0.0], [40.625, 3.25, 0.0], [43.75, 3.25, 0.0], [46.875, 3.25, 0.0], [50.0, 3.25, 0.0], [8.8817842e-16, 4.0, 0.75], [3.125, 4.0, 0.75], [6.25, 4.0, 0.75], [9.375, 4.0, 0.75], [12.5, 4.0, 0.75], [15.625, 4.0, 0.75], [18.75, 4.0, 0.75], [21.875, 4.0, 0.75], [25.0, 4.0, 0.75], [28.125, 4.0, 0.75], [31.25, 4.0, 0.75], [34.375, 4.0, 0.75], [37.5, 4.0, 0.75], [40.625, 4.0, 0.75], [43.75, 4.0, 0.75], [46.875, 4.0, 0.75], [50.0, 4.0, 0.75], [7.4395623e-16, 3.350481, 0.375], [3.125, 3.350481, 0.375], [6.25, 3.350481, 0.375], [9.375, 3.350481, 0.375], [12.5, 3.350481, 0.375], [15.625, 3.350481, 0.375], [18.75, 3.350481, 0.375], [21.875, 3.350481, 0.375], [25.0, 3.350481, 0.375], [28.125, 3.350481, 0.375], [31.25, 3.350481, 0.375], [34.375, 3.350481, 0.375], [37.5, 3.350481, 0.375], [40.625, 3.350481, 0.375], [43.75, 3.350481, 0.375], [46.875, 3.350481, 0.375], [50.0, 3.350481, 0.375], [8.04911693e-16, 3.625, 0.649519], [3.125, 3.625, 0.649519], [6.25, 3.625, 0.649519], [9.375, 3.625, 0.649519], [12.5, 3.625, 0.649519], [15.625, 3.625, 0.649519], [18.75, 3.625, 0.649519], [21.875, 3.625, 0.649519], [25.0, 3.625, 0.649519], [28.125, 3.625, 0.649519], [31.25, 3.625, 0.649519], [34.375, 3.625, 0.649519], [37.5, 3.625, 0.649519], [40.625, 3.625, 0.649519], [43.75, 3.625, 0.649519], [46.875, 3.625, 0.649519], [50.0, 3.625, 0.649519]]
        pt_per_slice = 12
        point_tab_sorted_circles = [[[7.21644966e-16, 3.25, 0.0], [7.4395623e-16, 3.350481, -0.375], [7.4395623e-16, 3.350481, 0.375], [8.04911693e-16, 3.625, -0.649519], [8.04911693e-16, 3.625, 0.649519], [8.8817842e-16, 4.0, -0.75], [8.8817842e-16, 4.0, 0.75], [9.71445147e-16, 4.375, -0.649519], [9.71445147e-16, 4.375, 0.649519], [1.03240061e-15, 4.649519, -0.375], [1.03240061e-15, 4.649519, 0.375], [1.05471187e-15, 4.75, 0.0]], [[3.125, 4.375, -0.649519], [3.125, 4.649519, -0.375], [3.125, 4.0, -0.75], [3.125, 4.75, 0.0], [3.125, 3.625, -0.649519], [3.125, 4.649519, 0.375], [3.125, 3.350481, -0.375], [3.125, 4.375, 0.649519], [3.125, 3.25, 0.0], [3.125, 4.0, 0.75], [3.125, 3.350481, 0.375], [3.125, 3.625, 0.649519]], [[6.25, 4.375, -0.649519], [6.25, 4.649519, -0.375], [6.25, 4.0, -0.75], [6.25, 4.75, 0.0], [6.25, 3.625, -0.649519], [6.25, 4.649519, 0.375], [6.25, 3.350481, -0.375], [6.25, 4.375, 0.649519], [6.25, 3.25, 0.0], [6.25, 4.0, 0.75], [6.25, 3.350481, 0.375], [6.25, 3.625, 0.649519]], [[9.375, 4.375, -0.649519], [9.375, 4.649519, -0.375], [9.375, 4.0, -0.75], [9.375, 4.75, 0.0], [9.375, 3.625, -0.649519], [9.375, 4.649519, 0.375], [9.375, 3.350481, -0.375], [9.375, 4.375, 0.649519], [9.375, 3.25, 0.0], [9.375, 4.0, 0.75], [9.375, 3.350481, 0.375], [9.375, 3.625, 0.649519]], [[12.5, 4.375, -0.649519], [12.5, 4.649519, -0.375], [12.5, 4.0, -0.75], [12.5, 4.75, 0.0], [12.5, 3.625, -0.649519], [12.5, 4.649519, 0.375], [12.5, 3.350481, -0.375], [12.5, 4.375, 0.649519], [12.5, 3.25, 0.0], [12.5, 4.0, 0.75], [12.5, 3.350481, 0.375], [12.5, 3.625, 0.649519]], [[15.625, 4.375, -0.649519], [15.625, 4.649519, -0.375], [15.625, 4.0, -0.75], [15.625, 4.75, 0.0], [15.625, 3.625, -0.649519], [15.625, 4.649519, 0.375], [15.625, 3.350481, -0.375], [15.625, 4.375, 0.649519], [15.625, 3.25, 0.0], [15.625, 4.0, 0.75], [15.625, 3.350481, 0.375], [15.625, 3.625, 0.649519]], [[18.75, 4.375, -0.649519], [18.75, 4.649519, -0.375], [18.75, 4.0, -0.75], [18.75, 4.75, 0.0], [18.75, 3.625, -0.649519], [18.75, 4.649519, 0.375], [18.75, 3.350481, -0.375], [18.75, 4.375, 0.649519], [18.75, 3.25, 0.0], [18.75, 4.0, 0.75], [18.75, 3.350481, 0.375], [18.75, 3.625, 0.649519]], [[21.875, 4.375, -0.649519], [21.875, 4.649519, -0.375], [21.875, 4.0, -0.75], [21.875, 4.75, 0.0], [21.875, 3.625, -0.649519], [21.875, 4.649519, 0.375], [21.875, 3.350481, -0.375], [21.875, 4.375, 0.649519], [21.875, 3.25, 0.0], [21.875, 4.0, 0.75], [21.875, 3.350481, 0.375], [21.875, 3.625, 0.649519]], [[25.0, 4.375, -0.649519], [25.0, 4.649519, -0.375], [25.0, 4.0, -0.75], [25.0, 4.75, 0.0], [25.0, 3.625, -0.649519], [25.0, 4.649519, 0.375], [25.0, 3.350481, -0.375], [25.0, 4.375, 0.649519], [25.0, 3.25, 0.0], [25.0, 4.0, 0.75], [25.0, 3.350481, 0.375], [25.0, 3.625, 0.649519]], [[28.125, 4.375, -0.649519], [28.125, 4.649519, -0.375], [28.125, 4.0, -0.75], [28.125, 4.75, 0.0], [28.125, 3.625, -0.649519], [28.125, 4.649519, 0.375], [28.125, 3.350481, -0.375], [28.125, 4.375, 0.649519], [28.125, 3.25, 0.0], [28.125, 4.0, 0.75], [28.125, 3.350481, 0.375], [28.125, 3.625, 0.649519]], [[31.25, 4.375, -0.649519], [31.25, 4.649519, -0.375], [31.25, 4.0, -0.75], [31.25, 4.75, 0.0], [31.25, 3.625, -0.649519], [31.25, 4.649519, 0.375], [31.25, 3.350481, -0.375], [31.25, 4.375, 0.649519], [31.25, 3.25, 0.0], [31.25, 4.0, 0.75], [31.25, 3.350481, 0.375], [31.25, 3.625, 0.649519]], [[34.375, 4.375, -0.649519], [34.375, 4.649519, -0.375], [34.375, 4.0, -0.75], [34.375, 4.75, 0.0], [34.375, 3.625, -0.649519], [34.375, 4.649519, 0.375], [34.375, 3.350481, -0.375], [34.375, 4.375, 0.649519], [34.375, 3.25, 0.0], [34.375, 4.0, 0.75], [34.375, 3.350481, 0.375], [34.375, 3.625, 0.649519]], [[37.5, 4.375, -0.649519], [37.5, 4.649519, -0.375], [37.5, 4.0, -0.75], [37.5, 4.75, 0.0], [37.5, 3.625, -0.649519], [37.5, 4.649519, 0.375], [37.5, 3.350481, -0.375], [37.5, 4.375, 0.649519], [37.5, 3.25, 0.0], [37.5, 4.0, 0.75], [37.5, 3.350481, 0.375], [37.5, 3.625, 0.649519]], [[40.625, 4.375, -0.649519], [40.625, 4.649519, -0.375], [40.625, 4.0, -0.75], [40.625, 4.75, 0.0], [40.625, 3.625, -0.649519], [40.625, 4.649519, 0.375], [40.625, 3.350481, -0.375], [40.625, 4.375, 0.649519], [40.625, 3.25, 0.0], [40.625, 4.0, 0.75], [40.625, 3.350481, 0.375], [40.625, 3.625, 0.649519]], [[43.75, 4.375, -0.649519], [43.75, 4.649519, -0.375], [43.75, 4.0, -0.75], [43.75, 4.75, 0.0], [43.75, 3.625, -0.649519], [43.75, 4.649519, 0.375], [43.75, 3.350481, -0.375], [43.75, 4.375, 0.649519], [43.75, 3.25, 0.0], [43.75, 4.0, 0.75], [43.75, 3.350481, 0.375], [43.75, 3.625, 0.649519]], [[46.875, 4.375, -0.649519], [46.875, 4.649519, -0.375], [46.875, 4.0, -0.75], [46.875, 4.75, 0.0], [46.875, 3.625, -0.649519], [46.875, 4.649519, 0.375], [46.875, 3.350481, -0.375], [46.875, 4.375, 0.649519], [46.875, 3.25, 0.0], [46.875, 4.0, 0.75], [46.875, 3.350481, 0.375], [46.875, 3.625, 0.649519]], [[50.0, 4.375, -0.649519], [50.0, 4.649519, -0.375], [50.0, 4.0, -0.75], [50.0, 4.75, 0.0], [50.0, 3.625, -0.649519], [50.0, 4.649519, 0.375], [50.0, 3.350481, -0.375], [50.0, 4.375, 0.649519], [50.0, 3.25, 0.0], [50.0, 4.0, 0.75], [50.0, 3.350481, 0.375], [50.0, 3.625, 0.649519]]]
        ind_tab_sorted_circles = [[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35], [36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47], [48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59], [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71], [72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83], [84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95], [96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107], [108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119], [120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131], [132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143], [144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155], [156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167], [168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179], [180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191], [192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203]]
        indices = [374, 375, 376, 377, 378, 379, 380, 381, 382, 383, 384, 385, 386, 387, 388, 389, 390, 391, 392, 393, 394, 395, 396, 397, 398, 399, 400, 401, 402, 403, 404, 405, 406, 407, 408, 409, 410, 411, 412, 413, 414, 415, 416, 417, 418, 419, 420, 421, 422, 423, 424, 442, 443, 444, 445, 446, 447, 448, 449, 450, 451, 452, 453, 454, 455, 456, 457, 458, 459, 460, 461, 462, 463, 464, 465, 466, 467, 468, 469, 470, 471, 472, 473, 474, 475, 510, 511, 512, 513, 514, 515, 516, 517, 518, 519, 520, 521, 522, 523, 524, 525, 526, 595, 596, 597, 598, 599, 600, 601, 602, 603, 604, 605, 606, 607, 608, 609, 610, 611, 663, 664, 665, 666, 667, 668, 669, 670, 671, 672, 673, 674, 675, 676, 677, 678, 679, 697, 698, 699, 700, 701, 702, 703, 704, 705, 706, 707, 708, 709, 710, 711, 712, 713, 748, 749, 750, 751, 752, 753, 754, 755, 756, 757, 758, 759, 760, 761, 762, 763, 764, 765, 766, 767, 768, 769, 770, 771, 772, 773, 774, 775, 776, 777, 778, 779, 780, 781, 799, 800, 801, 802, 803, 804, 805, 806, 807, 808, 809, 810, 811, 812, 813, 814, 815]
        ind_tab_sorted_circles_i = [[697, 595, 765, 459, 799, 408, 748, 374, 663, 391, 510, 442], [375, 392, 409, 443, 460, 511, 596, 664, 698, 749, 766, 800], [376, 393, 410, 444, 461, 512, 597, 665, 699, 750, 767, 801], [377, 394, 411, 445, 462, 513, 598, 666, 700, 751, 768, 802], [378, 395, 412, 446, 463, 514, 599, 667, 701, 752, 769, 803], [379, 396, 413, 447, 464, 515, 600, 668, 702, 753, 770, 804], [380, 397, 414, 448, 465, 516, 601, 669, 703, 754, 771, 805], [381, 398, 415, 449, 466, 517, 602, 670, 704, 755, 772, 806], [382, 399, 416, 450, 467, 518, 603, 671, 705, 756, 773, 807], [383, 400, 417, 451, 468, 519, 604, 672, 706, 757, 774, 808], [384, 401, 418, 452, 469, 520, 605, 673, 707, 758, 775, 809], [385, 402, 419, 453, 470, 521, 606, 674, 708, 759, 776, 810], [386, 403, 420, 454, 471, 522, 607, 675, 709, 760, 777, 811], [387, 404, 421, 455, 472, 523, 608, 676, 710, 761, 778, 812], [388, 405, 422, 456, 473, 524, 609, 677, 711, 762, 779, 813], [389, 406, 423, 457, 474, 525, 610, 678, 712, 763, 780, 814], [390, 407, 424, 458, 475, 526, 611, 679, 713, 764, 781, 815]]
        ind_tab_sorted_c = [[136, 102, 170, 68, 187, 34, 153, 0, 119, 17, 85, 51], [1, 18, 35, 52, 69, 86, 103, 120, 137, 154, 171, 188], [2, 19, 36, 53, 70, 87, 104, 121, 138, 155, 172, 189], [3, 20, 37, 54, 71, 88, 105, 122, 139, 156, 173, 190], [4, 21, 38, 55, 72, 89, 106, 123, 140, 157, 174, 191], [5, 22, 39, 56, 73, 90, 107, 124, 141, 158, 175, 192], [6, 23, 40, 57, 74, 91, 108, 125, 142, 159, 176, 193], [7, 24, 41, 58, 75, 92, 109, 126, 143, 160, 177, 194], [8, 25, 42, 59, 76, 93, 110, 127, 144, 161, 178, 195], [9, 26, 43, 60, 77, 94, 111, 128, 145, 162, 179, 196], [10, 27, 44, 61, 78, 95, 112, 129, 146, 163, 180, 197], [11, 28, 45, 62, 79, 96, 113, 130, 147, 164, 181, 198], [12, 29, 46, 63, 80, 97, 114, 131, 148, 165, 182, 199], [13, 30, 47, 64, 81, 98, 115, 132, 149, 166, 183, 200], [14, 31, 48, 65, 82, 99, 116, 133, 150, 167, 184, 201], [15, 32, 49, 66, 83, 100, 117, 134, 151, 168, 185, 202], [16, 33, 50, 67, 84, 101, 118, 135, 152, 169, 186, 203]]

        # [new_points, conv_tab] = mf.index_from_axis(points = points, axis = 2)
        [points_tab, ind_tab] = mf.circle_detection_axis(points=points, axis=0,tolerance = 0.1)

        # print(points_tab)
        # print(ind_tab)

        if points_tab != point_tab_sorted_circles :
            print("- Erreur - Tri des cercles - Points #013")
        self.assertEqual(points_tab, point_tab_sorted_circles)

        if ind_tab != ind_tab_sorted_c :
            print("- Erreur - Tri des cercles - Indices #014")
        self.assertEqual(ind_tab, ind_tab_sorted_c)

        [points_tab_i, ind_tab_i] = mf.circle_detection_axis(points=points, axis=0,tolerance = 0.1,indices = indices)

        # print(ind_tab_i)
        # print(points_tab_i)

        if points_tab_i != point_tab_sorted_circles :
            print("- Erreur - Tri des cercles - Points #015")
        self.assertEqual(points_tab_i, point_tab_sorted_circles)

        if ind_tab_i != ind_tab_sorted_circles_i :
            print("- Erreur - Tri des cercles - Indices #016")
        self.assertEqual(ind_tab_i, ind_tab_sorted_circles_i)

    def test_ordering_circle(self):
    # ordering_circles(circle,ind_tab,x=1,y=2): #
        cercle01 = [[7.21644966e-16, 3.25, 0.0], [7.4395623e-16, 3.350481, -0.375], [7.4395623e-16, 3.350481, 0.375], [8.04911693e-16, 3.625, -0.649519], [8.04911693e-16, 3.625, 0.649519], [8.8817842e-16, 4.0, -0.75], [8.8817842e-16, 4.0, 0.75], [9.71445147e-16, 4.375, -0.649519], [9.71445147e-16, 4.375, 0.649519], [1.03240061e-15, 4.649519, -0.375], [1.03240061e-15, 4.649519, 0.375], [1.05471187e-15, 4.75, 0.0]]
        indices01 = [k for k in range(12)]
        [new_circle_pt,new_ind_tab] = mf.ordering_circle(cercle01,indices01)
        circle_pt = [[9.71445147e-16, 4.375, -0.649519], [1.03240061e-15, 4.649519, -0.375], [1.05471187e-15, 4.75, 0.0], [1.03240061e-15, 4.649519, 0.375], [9.71445147e-16, 4.375, 0.649519], [8.8817842e-16, 4.0, 0.75], [8.04911693e-16, 3.625, 0.649519], [7.4395623e-16, 3.350481, 0.375], [7.21644966e-16, 3.25, 0.0], [7.4395623e-16, 3.350481, -0.375], [8.04911693e-16, 3.625, -0.649519], [8.8817842e-16, 4.0, -0.75]]
        ind_tab = [7, 9, 11, 10, 8, 6, 4, 2, 0, 1, 3, 5]
        if new_circle_pt != circle_pt :
            print("- Erreur - Ordonnement des points d'un cercle #017")
        self.assertEqual(new_circle_pt, circle_pt)
        if new_ind_tab != ind_tab :
            print("- Erreur - Ordonnement des points d'un cercle - Indices #018")
        self.assertEqual(new_ind_tab, ind_tab)

        cercle02 =  [(math.cos(angle), math.sin(angle)) for angle in [math.pi / 4, 5* math.pi/4, 7*math.pi/4,  2*math.pi/4 , 3*math.pi / 4 , math.pi , 0, 3*math.pi/2  ]]
        indices02 = [k for k in range(8)]
        [new_circle_pt2,new_ind_tab2] = mf.ordering_circle(cercle02,indices02,x_ref=0,y_ref=1)
        circle_pt2 = [(0.7071067811865474, -0.7071067811865477), (1.0, 0.0), (0.7071067811865476, 0.7071067811865475), (6.123233995736766e-17, 1.0), (-0.7071067811865475, 0.7071067811865476), (-1.0, 1.2246467991473532e-16), (-0.7071067811865477, -0.7071067811865475), (-1.8369701987210297e-16, -1.0)]
        ind_tab2 = [2, 6, 0, 3, 4, 5, 1, 7]
        if new_circle_pt2 != circle_pt2 :
            print("- Erreur - Ordonnement des points d'un cercle #019")
        self.assertEqual(new_circle_pt2, circle_pt2)
        if new_ind_tab2 != ind_tab2 :
            print("- Erreur - Ordonnement des points d'un cercle - Indices #020")
        self.assertEqual(new_ind_tab2, ind_tab2)


    def test_invers_normal(self):
        new_quad = [[6, 21, 23, 4], [21, 33, 35, 23], [33, 45, 47, 35], [45, 57, 59, 47], [57, 69, 71, 59], [69, 81, 83, 71], [81, 93, 95, 83], [93, 105, 107, 95], [105, 117, 119, 107], [117, 129, 131, 119], [129, 141, 143, 131], [141, 153, 155, 143], [153, 165, 167, 155], [165, 177, 179, 167], [177, 189, 191, 179], [189, 201, 203, 191], [5, 3, 16, 14], [14, 16, 28, 26], [26, 28, 40, 38], [38, 40, 52, 50], [50, 52, 64, 62], [62, 64, 76, 74], [74, 76, 88, 86], [86, 88, 100, 98], [98, 100, 112, 110], [110, 112, 124, 122], [122, 124, 136, 134], [134, 136, 148, 146], [146, 148, 160, 158], [158, 160, 172, 170], [170, 172, 184, 182], [182, 184, 196, 194], [10, 17, 19, 8], [17, 29, 31, 19], [29, 41, 43, 31], [41, 53, 55, 43], [53, 65, 67, 55], [65, 77, 79, 67], [77, 89, 91, 79], [89, 101, 103, 91], [101, 113, 115, 103], [113, 125, 127, 115], [125, 137, 139, 127], [137, 149, 151, 139], [149, 161, 163, 151], [161, 173, 175, 163], [173, 185, 187, 175], [185, 197, 199, 187], [8, 19, 21, 6], [19, 31, 33, 21], [31, 43, 45, 33], [43, 55, 57, 45], [55, 67, 69, 57], [67, 79, 81, 69], [79, 91, 93, 81], [91, 103, 105, 93], [103, 115, 117, 105], [115, 127, 129, 117], [127, 139, 141, 129], [139, 151, 153, 141], [151, 163, 165, 153], [163, 175, 177, 165], [175, 187, 189, 177], [187, 199, 201, 189], [7, 12, 13, 9], [12, 24, 25, 13], [24, 36, 37, 25], [36, 48, 49, 37], [48, 60, 61, 49], [60, 72, 73, 61], [72, 84, 85, 73], [84, 96, 97, 85], [96, 108, 109, 97], [108, 120, 121, 109], [120, 132, 133, 121], [132, 144, 145, 133], [144, 156, 157, 145], [156, 168, 169, 157], [168, 180, 181, 169], [180, 192, 193, 181], [7, 5, 14, 12], [12, 14, 26, 24], [24, 26, 38, 36], [36, 38, 50, 48], [48, 50, 62, 60], [60, 62, 74, 72], [72, 74, 86, 84], [84, 86, 98, 96], [96, 98, 110, 108], [108, 110, 122, 120], [120, 122, 134, 132], [132, 134, 146, 144], [144, 146, 158, 156], [156, 158, 170, 168], [168, 170, 182, 180], [180, 182, 194, 192], [3, 1, 18, 16], [16, 18, 30, 28], [28, 30, 42, 40], [40, 42, 54, 52], [52, 54, 66, 64], [64, 66, 78, 76], [76, 78, 90, 88], [88, 90, 102, 100], [100, 102, 114, 112], [112, 114, 126, 124], [124, 126, 138, 136], [136, 138, 150, 148], [148, 150, 162, 160], [160, 162, 174, 172], [172, 174, 186, 184], [184, 186, 198, 196], [1, 0, 20, 18], [18, 20, 32, 30], [30, 32, 44, 42], [42, 44, 56, 54], [54, 56, 68, 66], [66, 68, 80, 78], [78, 80, 92, 90], [90, 92, 104, 102], [102, 104, 116, 114], [114, 116, 128, 126], [126, 128, 140, 138], [138, 140, 152, 150], [150, 152, 164, 162], [162, 164, 176, 174], [174, 176, 188, 186], [186, 188, 200, 198], [0, 2, 22, 20], [20, 22, 34, 32], [32, 34, 46, 44], [44, 46, 58, 56], [56, 58, 70, 68], [68, 70, 82, 80], [80, 82, 94, 92], [92, 94, 106, 104], [104, 106, 118, 116], [116, 118, 130, 128], [128, 130, 142, 140], [140, 142, 154, 152], [152, 154, 166, 164], [164, 166, 178, 176], [176, 178, 190, 188], [188, 190, 202, 200], [2, 4, 23, 22], [22, 23, 35, 34], [34, 35, 47, 46], [46, 47, 59, 58], [58, 59, 71, 70], [70, 71, 83, 82], [82, 83, 95, 94], [94, 95, 107, 106], [106, 107, 119, 118], [118, 119, 131, 130], [130, 131, 143, 142], [142, 143, 155, 154], [154, 155, 167, 166], [166, 167, 179, 178], [178, 179, 191, 190], [190, 191, 203, 202], [11, 15, 17, 10], [15, 27, 29, 17], [27, 39, 41, 29], [39, 51, 53, 41], [51, 63, 65, 53], [63, 75, 77, 65], [75, 87, 89, 77], [87, 99, 101, 89], [99, 111, 113, 101], [111, 123, 125, 113], [123, 135, 137, 125], [135, 147, 149, 137], [147, 159, 161, 149], [159, 171, 173, 161], [171, 183, 185, 173], [183, 195, 197, 185], [9, 13, 15, 11], [13, 25, 27, 15], [25, 37, 39, 27], [37, 49, 51, 39], [49, 61, 63, 51], [61, 73, 75, 63], [73, 85, 87, 75], [85, 97, 99, 87], [97, 109, 111, 99], [109, 121, 123, 111], [121, 133, 135, 123], [133, 145, 147, 135], [145, 157, 159, 147], [157, 169, 171, 159], [169, 181, 183, 171], [181, 193, 195, 183]]
        inv_quad_sol = [[4, 23, 21, 6], [23, 35, 33, 21], [35, 47, 45, 33], [47, 59, 57, 45], [59, 71, 69, 57], [71, 83, 81, 69], [83, 95, 93, 81], [95, 107, 105, 93], [107, 119, 117, 105], [119, 131, 129, 117], [131, 143, 141, 129], [143, 155, 153, 141], [155, 167, 165, 153], [167, 179, 177, 165], [179, 191, 189, 177], [191, 203, 201, 189], [14, 16, 3, 5], [26, 28, 16, 14], [38, 40, 28, 26], [50, 52, 40, 38], [62, 64, 52, 50], [74, 76, 64, 62], [86, 88, 76, 74], [98, 100, 88, 86], [110, 112, 100, 98], [122, 124, 112, 110], [134, 136, 124, 122], [146, 148, 136, 134], [158, 160, 148, 146], [170, 172, 160, 158], [182, 184, 172, 170], [194, 196, 184, 182], [8, 19, 17, 10], [19, 31, 29, 17], [31, 43, 41, 29], [43, 55, 53, 41], [55, 67, 65, 53], [67, 79, 77, 65], [79, 91, 89, 77], [91, 103, 101, 89], [103, 115, 113, 101], [115, 127, 125, 113], [127, 139, 137, 125], [139, 151, 149, 137], [151, 163, 161, 149], [163, 175, 173, 161], [175, 187, 185, 173], [187, 199, 197, 185], [6, 21, 19, 8], [21, 33, 31, 19], [33, 45, 43, 31], [45, 57, 55, 43], [57, 69, 67, 55], [69, 81, 79, 67], [81, 93, 91, 79], [93, 105, 103, 91], [105, 117, 115, 103], [117, 129, 127, 115], [129, 141, 139, 127], [141, 153, 151, 139], [153, 165, 163, 151], [165, 177, 175, 163], [177, 189, 187, 175], [189, 201, 199, 187], [9, 13, 12, 7], [13, 25, 24, 12], [25, 37, 36, 24], [37, 49, 48, 36], [49, 61, 60, 48], [61, 73, 72, 60], [73, 85, 84, 72], [85, 97, 96, 84], [97, 109, 108, 96], [109, 121, 120, 108], [121, 133, 132, 120], [133, 145, 144, 132], [145, 157, 156, 144], [157, 169, 168, 156], [169, 181, 180, 168], [181, 193, 192, 180], [12, 14, 5, 7], [24, 26, 14, 12], [36, 38, 26, 24], [48, 50, 38, 36], [60, 62, 50, 48], [72, 74, 62, 60], [84, 86, 74, 72], [96, 98, 86, 84], [108, 110, 98, 96], [120, 122, 110, 108], [132, 134, 122, 120], [144, 146, 134, 132], [156, 158, 146, 144], [168, 170, 158, 156], [180, 182, 170, 168], [192, 194, 182, 180], [16, 18, 1, 3], [28, 30, 18, 16], [40, 42, 30, 28], [52, 54, 42, 40], [64, 66, 54, 52], [76, 78, 66, 64], [88, 90, 78, 76], [100, 102, 90, 88], [112, 114, 102, 100], [124, 126, 114, 112], [136, 138, 126, 124], [148, 150, 138, 136], [160, 162, 150, 148], [172, 174, 162, 160], [184, 186, 174, 172], [196, 198, 186, 184], [18, 20, 0, 1], [30, 32, 20, 18], [42, 44, 32, 30], [54, 56, 44, 42], [66, 68, 56, 54], [78, 80, 68, 66], [90, 92, 80, 78], [102, 104, 92, 90], [114, 116, 104, 102], [126, 128, 116, 114], [138, 140, 128, 126], [150, 152, 140, 138], [162, 164, 152, 150], [174, 176, 164, 162], [186, 188, 176, 174], [198, 200, 188, 186], [20, 22, 2, 0], [32, 34, 22, 20], [44, 46, 34, 32], [56, 58, 46, 44], [68, 70, 58, 56], [80, 82, 70, 68], [92, 94, 82, 80], [104, 106, 94, 92], [116, 118, 106, 104], [128, 130, 118, 116], [140, 142, 130, 128], [152, 154, 142, 140], [164, 166, 154, 152], [176, 178, 166, 164], [188, 190, 178, 176], [200, 202, 190, 188], [22, 23, 4, 2], [34, 35, 23, 22], [46, 47, 35, 34], [58, 59, 47, 46], [70, 71, 59, 58], [82, 83, 71, 70], [94, 95, 83, 82], [106, 107, 95, 94], [118, 119, 107, 106], [130, 131, 119, 118], [142, 143, 131, 130], [154, 155, 143, 142], [166, 167, 155, 154], [178, 179, 167, 166], [190, 191, 179, 178], [202, 203, 191, 190], [10, 17, 15, 11], [17, 29, 27, 15], [29, 41, 39, 27], [41, 53, 51, 39], [53, 65, 63, 51], [65, 77, 75, 63], [77, 89, 87, 75], [89, 101, 99, 87], [101, 113, 111, 99], [113, 125, 123, 111], [125, 137, 135, 123], [137, 149, 147, 135], [149, 161, 159, 147], [161, 173, 171, 159], [173, 185, 183, 171], [185, 197, 195, 183], [11, 15, 13, 9], [15, 27, 25, 13], [27, 39, 37, 25], [39, 51, 49, 37], [51, 63, 61, 49], [63, 75, 73, 61], [75, 87, 85, 73], [87, 99, 97, 85], [99, 111, 109, 97], [111, 123, 121, 109], [123, 135, 133, 121], [135, 147, 145, 133], [147, 159, 157, 145], [159, 171, 169, 157], [171, 183, 181, 169], [183, 195, 193, 181]]
        inv_quad = mf.invers_normal(new_quad)
        if inv_quad != inv_quad_sol :
            print("- Erreur - Inversion des normales du maillage quad test faux #021")
        self.assertEqual(inv_quad, inv_quad_sol)

        new_triangles = [[6, 21, 23], [23, 4, 6], [21, 33, 35], [35, 23, 21], [33, 45, 47], [47, 35, 33], [45, 57, 59], [59, 47, 45], [57, 69, 71], [71, 59, 57], [69, 81, 83], [83, 71, 69], [81, 93, 95], [95, 83, 81], [93, 105, 107], [107, 95, 93], [105, 117, 119], [119, 107, 105], [117, 129, 131], [131, 119, 117], [129, 141, 143], [143, 131, 129], [141, 153, 155], [155, 143, 141], [153, 165, 167], [167, 155, 153], [165, 177, 179], [179, 167, 165], [177, 189, 191], [191, 179, 177], [189, 201, 203], [203, 191, 189], [5, 3, 16], [16, 14, 5], [14, 16, 28], [28, 26, 14], [26, 28, 40], [40, 38, 26], [38, 40, 52], [52, 50, 38], [50, 52, 64], [64, 62, 50], [62, 64, 76], [76, 74, 62], [74, 76, 88], [88, 86, 74], [86, 88, 100], [100, 98, 86], [98, 100, 112], [112, 110, 98], [110, 112, 124], [124, 122, 110], [122, 124, 136], [136, 134, 122], [134, 136, 148], [148, 146, 134], [146, 148, 160], [160, 158, 146], [158, 160, 172], [172, 170, 158], [170, 172, 184], [184, 182, 170], [182, 184, 196], [196, 194, 182], [10, 17, 19], [19, 8, 10], [17, 29, 31], [31, 19, 17], [29, 41, 43], [43, 31, 29], [41, 53, 55], [55, 43, 41], [53, 65, 67], [67, 55, 53], [65, 77, 79], [79, 67, 65], [77, 89, 91], [91, 79, 77], [89, 101, 103], [103, 91, 89], [101, 113, 115], [115, 103, 101], [113, 125, 127], [127, 115, 113], [125, 137, 139], [139, 127, 125], [137, 149, 151], [151, 139, 137], [149, 161, 163], [163, 151, 149], [161, 173, 175], [175, 163, 161], [173, 185, 187], [187, 175, 173], [185, 197, 199], [199, 187, 185], [8, 19, 21], [21, 6, 8], [19, 31, 33], [33, 21, 19], [31, 43, 45], [45, 33, 31], [43, 55, 57], [57, 45, 43], [55, 67, 69], [69, 57, 55], [67, 79, 81], [81, 69, 67], [79, 91, 93], [93, 81, 79], [91, 103, 105], [105, 93, 91], [103, 115, 117], [117, 105, 103], [115, 127, 129], [129, 117, 115], [127, 139, 141], [141, 129, 127], [139, 151, 153], [153, 141, 139], [151, 163, 165], [165, 153, 151], [163, 175, 177], [177, 165, 163], [175, 187, 189], [189, 177, 175], [187, 199, 201], [201, 189, 187], [7, 12, 13], [13, 9, 7], [12, 24, 25], [25, 13, 12], [24, 36, 37], [37, 25, 24], [36, 48, 49], [49, 37, 36], [48, 60, 61], [61, 49, 48], [60, 72, 73], [73, 61, 60], [72, 84, 85], [85, 73, 72], [84, 96, 97], [97, 85, 84], [96, 108, 109], [109, 97, 96], [108, 120, 121], [121, 109, 108], [120, 132, 133], [133, 121, 120], [132, 144, 145], [145, 133, 132], [144, 156, 157], [157, 145, 144], [156, 168, 169], [169, 157, 156], [168, 180, 181], [181, 169, 168], [180, 192, 193], [193, 181, 180], [7, 5, 14], [14, 12, 7], [12, 14, 26], [26, 24, 12], [24, 26, 38], [38, 36, 24], [36, 38, 50], [50, 48, 36], [48, 50, 62], [62, 60, 48], [60, 62, 74], [74, 72, 60], [72, 74, 86], [86, 84, 72], [84, 86, 98], [98, 96, 84], [96, 98, 110], [110, 108, 96], [108, 110, 122], [122, 120, 108], [120, 122, 134], [134, 132, 120], [132, 134, 146], [146, 144, 132], [144, 146, 158], [158, 156, 144], [156, 158, 170], [170, 168, 156], [168, 170, 182], [182, 180, 168], [180, 182, 194], [194, 192, 180], [3, 1, 18], [18, 16, 3], [16, 18, 30], [30, 28, 16], [28, 30, 42], [42, 40, 28], [40, 42, 54], [54, 52, 40], [52, 54, 66], [66, 64, 52], [64, 66, 78], [78, 76, 64], [76, 78, 90], [90, 88, 76], [88, 90, 102], [102, 100, 88], [100, 102, 114], [114, 112, 100], [112, 114, 126], [126, 124, 112], [124, 126, 138], [138, 136, 124], [136, 138, 150], [150, 148, 136], [148, 150, 162], [162, 160, 148], [160, 162, 174], [174, 172, 160], [172, 174, 186], [186, 184, 172], [184, 186, 198], [198, 196, 184], [1, 0, 20], [20, 18, 1], [18, 20, 32], [32, 30, 18], [30, 32, 44], [44, 42, 30], [42, 44, 56], [56, 54, 42], [54, 56, 68], [68, 66, 54], [66, 68, 80], [80, 78, 66], [78, 80, 92], [92, 90, 78], [90, 92, 104], [104, 102, 90], [102, 104, 116], [116, 114, 102], [114, 116, 128], [128, 126, 114], [126, 128, 140], [140, 138, 126], [138, 140, 152], [152, 150, 138], [150, 152, 164], [164, 162, 150], [162, 164, 176], [176, 174, 162], [174, 176, 188], [188, 186, 174], [186, 188, 200], [200, 198, 186], [0, 2, 22], [22, 20, 0], [20, 22, 34], [34, 32, 20], [32, 34, 46], [46, 44, 32], [44, 46, 58], [58, 56, 44], [56, 58, 70], [70, 68, 56], [68, 70, 82], [82, 80, 68], [80, 82, 94], [94, 92, 80], [92, 94, 106], [106, 104, 92], [104, 106, 118], [118, 116, 104], [116, 118, 130], [130, 128, 116], [128, 130, 142], [142, 140, 128], [140, 142, 154], [154, 152, 140], [152, 154, 166], [166, 164, 152], [164, 166, 178], [178, 176, 164], [176, 178, 190], [190, 188, 176], [188, 190, 202], [202, 200, 188], [2, 4, 23], [23, 22, 2], [22, 23, 35], [35, 34, 22], [34, 35, 47], [47, 46, 34], [46, 47, 59], [59, 58, 46], [58, 59, 71], [71, 70, 58], [70, 71, 83], [83, 82, 70], [82, 83, 95], [95, 94, 82], [94, 95, 107], [107, 106, 94], [106, 107, 119], [119, 118, 106], [118, 119, 131], [131, 130, 118], [130, 131, 143], [143, 142, 130], [142, 143, 155], [155, 154, 142], [154, 155, 167], [167, 166, 154], [166, 167, 179], [179, 178, 166], [178, 179, 191], [191, 190, 178], [190, 191, 203], [203, 202, 190], [11, 15, 17], [17, 10, 11], [15, 27, 29], [29, 17, 15], [27, 39, 41], [41, 29, 27], [39, 51, 53], [53, 41, 39], [51, 63, 65], [65, 53, 51], [63, 75, 77], [77, 65, 63], [75, 87, 89], [89, 77, 75], [87, 99, 101], [101, 89, 87], [99, 111, 113], [113, 101, 99], [111, 123, 125], [125, 113, 111], [123, 135, 137], [137, 125, 123], [135, 147, 149], [149, 137, 135], [147, 159, 161], [161, 149, 147], [159, 171, 173], [173, 161, 159], [171, 183, 185], [185, 173, 171], [183, 195, 197], [197, 185, 183], [9, 13, 15], [15, 11, 9], [13, 25, 27], [27, 15, 13], [25, 37, 39], [39, 27, 25], [37, 49, 51], [51, 39, 37], [49, 61, 63], [63, 51, 49], [61, 73, 75], [75, 63, 61], [73, 85, 87], [87, 75, 73], [85, 97, 99], [99, 87, 85], [97, 109, 111], [111, 99, 97], [109, 121, 123], [123, 111, 109], [121, 133, 135], [135, 123, 121], [133, 145, 147], [147, 135, 133], [145, 157, 159], [159, 147, 145], [157, 169, 171], [171, 159, 157], [169, 181, 183], [183, 171, 169], [181, 193, 195], [195, 183, 181]]
        inv_triangles_sol = [[23, 21, 6], [6, 4, 23], [35, 33, 21], [21, 23, 35], [47, 45, 33], [33, 35, 47], [59, 57, 45], [45, 47, 59], [71, 69, 57], [57, 59, 71], [83, 81, 69], [69, 71, 83], [95, 93, 81], [81, 83, 95], [107, 105, 93], [93, 95, 107], [119, 117, 105], [105, 107, 119], [131, 129, 117], [117, 119, 131], [143, 141, 129], [129, 131, 143], [155, 153, 141], [141, 143, 155], [167, 165, 153], [153, 155, 167], [179, 177, 165], [165, 167, 179], [191, 189, 177], [177, 179, 191], [203, 201, 189], [189, 191, 203], [16, 3, 5], [5, 14, 16], [28, 16, 14], [14, 26, 28], [40, 28, 26], [26, 38, 40], [52, 40, 38], [38, 50, 52], [64, 52, 50], [50, 62, 64], [76, 64, 62], [62, 74, 76], [88, 76, 74], [74, 86, 88], [100, 88, 86], [86, 98, 100], [112, 100, 98], [98, 110, 112], [124, 112, 110], [110, 122, 124], [136, 124, 122], [122, 134, 136], [148, 136, 134], [134, 146, 148], [160, 148, 146], [146, 158, 160], [172, 160, 158], [158, 170, 172], [184, 172, 170], [170, 182, 184], [196, 184, 182], [182, 194, 196], [19, 17, 10], [10, 8, 19], [31, 29, 17], [17, 19, 31], [43, 41, 29], [29, 31, 43], [55, 53, 41], [41, 43, 55], [67, 65, 53], [53, 55, 67], [79, 77, 65], [65, 67, 79], [91, 89, 77], [77, 79, 91], [103, 101, 89], [89, 91, 103], [115, 113, 101], [101, 103, 115], [127, 125, 113], [113, 115, 127], [139, 137, 125], [125, 127, 139], [151, 149, 137], [137, 139, 151], [163, 161, 149], [149, 151, 163], [175, 173, 161], [161, 163, 175], [187, 185, 173], [173, 175, 187], [199, 197, 185], [185, 187, 199], [21, 19, 8], [8, 6, 21], [33, 31, 19], [19, 21, 33], [45, 43, 31], [31, 33, 45], [57, 55, 43], [43, 45, 57], [69, 67, 55], [55, 57, 69], [81, 79, 67], [67, 69, 81], [93, 91, 79], [79, 81, 93], [105, 103, 91], [91, 93, 105], [117, 115, 103], [103, 105, 117], [129, 127, 115], [115, 117, 129], [141, 139, 127], [127, 129, 141], [153, 151, 139], [139, 141, 153], [165, 163, 151], [151, 153, 165], [177, 175, 163], [163, 165, 177], [189, 187, 175], [175, 177, 189], [201, 199, 187], [187, 189, 201], [13, 12, 7], [7, 9, 13], [25, 24, 12], [12, 13, 25], [37, 36, 24], [24, 25, 37], [49, 48, 36], [36, 37, 49], [61, 60, 48], [48, 49, 61], [73, 72, 60], [60, 61, 73], [85, 84, 72], [72, 73, 85], [97, 96, 84], [84, 85, 97], [109, 108, 96], [96, 97, 109], [121, 120, 108], [108, 109, 121], [133, 132, 120], [120, 121, 133], [145, 144, 132], [132, 133, 145], [157, 156, 144], [144, 145, 157], [169, 168, 156], [156, 157, 169], [181, 180, 168], [168, 169, 181], [193, 192, 180], [180, 181, 193], [14, 5, 7], [7, 12, 14], [26, 14, 12], [12, 24, 26], [38, 26, 24], [24, 36, 38], [50, 38, 36], [36, 48, 50], [62, 50, 48], [48, 60, 62], [74, 62, 60], [60, 72, 74], [86, 74, 72], [72, 84, 86], [98, 86, 84], [84, 96, 98], [110, 98, 96], [96, 108, 110], [122, 110, 108], [108, 120, 122], [134, 122, 120], [120, 132, 134], [146, 134, 132], [132, 144, 146], [158, 146, 144], [144, 156, 158], [170, 158, 156], [156, 168, 170], [182, 170, 168], [168, 180, 182], [194, 182, 180], [180, 192, 194], [18, 1, 3], [3, 16, 18], [30, 18, 16], [16, 28, 30], [42, 30, 28], [28, 40, 42], [54, 42, 40], [40, 52, 54], [66, 54, 52], [52, 64, 66], [78, 66, 64], [64, 76, 78], [90, 78, 76], [76, 88, 90], [102, 90, 88], [88, 100, 102], [114, 102, 100], [100, 112, 114], [126, 114, 112], [112, 124, 126], [138, 126, 124], [124, 136, 138], [150, 138, 136], [136, 148, 150], [162, 150, 148], [148, 160, 162], [174, 162, 160], [160, 172, 174], [186, 174, 172], [172, 184, 186], [198, 186, 184], [184, 196, 198], [20, 0, 1], [1, 18, 20], [32, 20, 18], [18, 30, 32], [44, 32, 30], [30, 42, 44], [56, 44, 42], [42, 54, 56], [68, 56, 54], [54, 66, 68], [80, 68, 66], [66, 78, 80], [92, 80, 78], [78, 90, 92], [104, 92, 90], [90, 102, 104], [116, 104, 102], [102, 114, 116], [128, 116, 114], [114, 126, 128], [140, 128, 126], [126, 138, 140], [152, 140, 138], [138, 150, 152], [164, 152, 150], [150, 162, 164], [176, 164, 162], [162, 174, 176], [188, 176, 174], [174, 186, 188], [200, 188, 186], [186, 198, 200], [22, 2, 0], [0, 20, 22], [34, 22, 20], [20, 32, 34], [46, 34, 32], [32, 44, 46], [58, 46, 44], [44, 56, 58], [70, 58, 56], [56, 68, 70], [82, 70, 68], [68, 80, 82], [94, 82, 80], [80, 92, 94], [106, 94, 92], [92, 104, 106], [118, 106, 104], [104, 116, 118], [130, 118, 116], [116, 128, 130], [142, 130, 128], [128, 140, 142], [154, 142, 140], [140, 152, 154], [166, 154, 152], [152, 164, 166], [178, 166, 164], [164, 176, 178], [190, 178, 176], [176, 188, 190], [202, 190, 188], [188, 200, 202], [23, 4, 2], [2, 22, 23], [35, 23, 22], [22, 34, 35], [47, 35, 34], [34, 46, 47], [59, 47, 46], [46, 58, 59], [71, 59, 58], [58, 70, 71], [83, 71, 70], [70, 82, 83], [95, 83, 82], [82, 94, 95], [107, 95, 94], [94, 106, 107], [119, 107, 106], [106, 118, 119], [131, 119, 118], [118, 130, 131], [143, 131, 130], [130, 142, 143], [155, 143, 142], [142, 154, 155], [167, 155, 154], [154, 166, 167], [179, 167, 166], [166, 178, 179], [191, 179, 178], [178, 190, 191], [203, 191, 190], [190, 202, 203], [17, 15, 11], [11, 10, 17], [29, 27, 15], [15, 17, 29], [41, 39, 27], [27, 29, 41], [53, 51, 39], [39, 41, 53], [65, 63, 51], [51, 53, 65], [77, 75, 63], [63, 65, 77], [89, 87, 75], [75, 77, 89], [101, 99, 87], [87, 89, 101], [113, 111, 99], [99, 101, 113], [125, 123, 111], [111, 113, 125], [137, 135, 123], [123, 125, 137], [149, 147, 135], [135, 137, 149], [161, 159, 147], [147, 149, 161], [173, 171, 159], [159, 161, 173], [185, 183, 171], [171, 173, 185], [197, 195, 183], [183, 185, 197], [15, 13, 9], [9, 11, 15], [27, 25, 13], [13, 15, 27], [39, 37, 25], [25, 27, 39], [51, 49, 37], [37, 39, 51], [63, 61, 49], [49, 51, 63], [75, 73, 61], [61, 63, 75], [87, 85, 73], [73, 75, 87], [99, 97, 85], [85, 87, 99], [111, 109, 97], [97, 99, 111], [123, 121, 109], [109, 111, 123], [135, 133, 121], [121, 123, 135], [147, 145, 133], [133, 135, 147], [159, 157, 145], [145, 147, 159], [171, 169, 157], [157, 159, 171], [183, 181, 169], [169, 171, 183], [195, 193, 181], [181, 183, 195]]
        inv_triangles = mf.invers_normal(new_triangles)
        if inv_triangles != inv_triangles_sol :
            print("- Erreur - Inversion des normales du maillage triangle test faux #022")
        self.assertEqual(inv_triangles, inv_triangles_sol)

    def test_ordering_cylinder(self):
        points = [[7.21644966e-16, 3.25, 0.0], [7.4395623e-16, 3.350481, -0.375], [7.4395623e-16, 3.350481, 0.375], [8.04911693e-16, 3.625, -0.649519], [8.04911693e-16, 3.625, 0.649519], [8.8817842e-16, 4.0, -0.75], [8.8817842e-16, 4.0, 0.75], [9.71445147e-16, 4.375, -0.649519], [9.71445147e-16, 4.375, 0.649519], [1.03240061e-15, 4.649519, -0.375], [1.03240061e-15, 4.649519, 0.375], [1.05471187e-15, 4.75, 0.0], [3.125, 4.375, -0.649519], [3.125, 4.649519, -0.375], [3.125, 4.0, -0.75], [3.125, 4.75, 0.0], [3.125, 3.625, -0.649519], [3.125, 4.649519, 0.375], [3.125, 3.350481, -0.375], [3.125, 4.375, 0.649519], [3.125, 3.25, 0.0], [3.125, 4.0, 0.75], [3.125, 3.350481, 0.375], [3.125, 3.625, 0.649519], [6.25, 4.375, -0.649519], [6.25, 4.649519, -0.375], [6.25, 4.0, -0.75], [6.25, 4.75, 0.0], [6.25, 3.625, -0.649519], [6.25, 4.649519, 0.375], [6.25, 3.350481, -0.375], [6.25, 4.375, 0.649519], [6.25, 3.25, 0.0], [6.25, 4.0, 0.75], [6.25, 3.350481, 0.375], [6.25, 3.625, 0.649519], [9.375, 4.375, -0.649519], [9.375, 4.649519, -0.375], [9.375, 4.0, -0.75], [9.375, 4.75, 0.0], [9.375, 3.625, -0.649519], [9.375, 4.649519, 0.375], [9.375, 3.350481, -0.375], [9.375, 4.375, 0.649519], [9.375, 3.25, 0.0], [9.375, 4.0, 0.75], [9.375, 3.350481, 0.375], [9.375, 3.625, 0.649519], [12.5, 4.375, -0.649519], [12.5, 4.649519, -0.375], [12.5, 4.0, -0.75], [12.5, 4.75, 0.0], [12.5, 3.625, -0.649519], [12.5, 4.649519, 0.375], [12.5, 3.350481, -0.375], [12.5, 4.375, 0.649519], [12.5, 3.25, 0.0], [12.5, 4.0, 0.75], [12.5, 3.350481, 0.375], [12.5, 3.625, 0.649519], [15.625, 4.375, -0.649519], [15.625, 4.649519, -0.375], [15.625, 4.0, -0.75], [15.625, 4.75, 0.0], [15.625, 3.625, -0.649519], [15.625, 4.649519, 0.375], [15.625, 3.350481, -0.375], [15.625, 4.375, 0.649519], [15.625, 3.25, 0.0], [15.625, 4.0, 0.75], [15.625, 3.350481, 0.375], [15.625, 3.625, 0.649519], [18.75, 4.375, -0.649519], [18.75, 4.649519, -0.375], [18.75, 4.0, -0.75], [18.75, 4.75, 0.0], [18.75, 3.625, -0.649519], [18.75, 4.649519, 0.375], [18.75, 3.350481, -0.375], [18.75, 4.375, 0.649519], [18.75, 3.25, 0.0], [18.75, 4.0, 0.75], [18.75, 3.350481, 0.375], [18.75, 3.625, 0.649519], [21.875, 4.375, -0.649519], [21.875, 4.649519, -0.375], [21.875, 4.0, -0.75], [21.875, 4.75, 0.0], [21.875, 3.625, -0.649519], [21.875, 4.649519, 0.375], [21.875, 3.350481, -0.375], [21.875, 4.375, 0.649519], [21.875, 3.25, 0.0], [21.875, 4.0, 0.75], [21.875, 3.350481, 0.375], [21.875, 3.625, 0.649519], [25.0, 4.375, -0.649519], [25.0, 4.649519, -0.375], [25.0, 4.0, -0.75], [25.0, 4.75, 0.0], [25.0, 3.625, -0.649519], [25.0, 4.649519, 0.375], [25.0, 3.350481, -0.375], [25.0, 4.375, 0.649519], [25.0, 3.25, 0.0], [25.0, 4.0, 0.75], [25.0, 3.350481, 0.375], [25.0, 3.625, 0.649519], [28.125, 4.375, -0.649519], [28.125, 4.649519, -0.375], [28.125, 4.0, -0.75], [28.125, 4.75, 0.0], [28.125, 3.625, -0.649519], [28.125, 4.649519, 0.375], [28.125, 3.350481, -0.375], [28.125, 4.375, 0.649519], [28.125, 3.25, 0.0], [28.125, 4.0, 0.75], [28.125, 3.350481, 0.375], [28.125, 3.625, 0.649519], [31.25, 4.375, -0.649519], [31.25, 4.649519, -0.375], [31.25, 4.0, -0.75], [31.25, 4.75, 0.0], [31.25, 3.625, -0.649519], [31.25, 4.649519, 0.375], [31.25, 3.350481, -0.375], [31.25, 4.375, 0.649519], [31.25, 3.25, 0.0], [31.25, 4.0, 0.75], [31.25, 3.350481, 0.375], [31.25, 3.625, 0.649519], [34.375, 4.375, -0.649519], [34.375, 4.649519, -0.375], [34.375, 4.0, -0.75], [34.375, 4.75, 0.0], [34.375, 3.625, -0.649519], [34.375, 4.649519, 0.375], [34.375, 3.350481, -0.375], [34.375, 4.375, 0.649519], [34.375, 3.25, 0.0], [34.375, 4.0, 0.75], [34.375, 3.350481, 0.375], [34.375, 3.625, 0.649519], [37.5, 4.375, -0.649519], [37.5, 4.649519, -0.375], [37.5, 4.0, -0.75], [37.5, 4.75, 0.0], [37.5, 3.625, -0.649519], [37.5, 4.649519, 0.375], [37.5, 3.350481, -0.375], [37.5, 4.375, 0.649519], [37.5, 3.25, 0.0], [37.5, 4.0, 0.75], [37.5, 3.350481, 0.375], [37.5, 3.625, 0.649519], [40.625, 4.375, -0.649519], [40.625, 4.649519, -0.375], [40.625, 4.0, -0.75], [40.625, 4.75, 0.0], [40.625, 3.625, -0.649519], [40.625, 4.649519, 0.375], [40.625, 3.350481, -0.375], [40.625, 4.375, 0.649519], [40.625, 3.25, 0.0], [40.625, 4.0, 0.75], [40.625, 3.350481, 0.375], [40.625, 3.625, 0.649519], [43.75, 4.375, -0.649519], [43.75, 4.649519, -0.375], [43.75, 4.0, -0.75], [43.75, 4.75, 0.0], [43.75, 3.625, -0.649519], [43.75, 4.649519, 0.375], [43.75, 3.350481, -0.375], [43.75, 4.375, 0.649519], [43.75, 3.25, 0.0], [43.75, 4.0, 0.75], [43.75, 3.350481, 0.375], [43.75, 3.625, 0.649519], [46.875, 4.375, -0.649519], [46.875, 4.649519, -0.375], [46.875, 4.0, -0.75], [46.875, 4.75, 0.0], [46.875, 3.625, -0.649519], [46.875, 4.649519, 0.375], [46.875, 3.350481, -0.375], [46.875, 4.375, 0.649519], [46.875, 3.25, 0.0], [46.875, 4.0, 0.75], [46.875, 3.350481, 0.375], [46.875, 3.625, 0.649519], [50.0, 4.375, -0.649519], [50.0, 4.649519, -0.375], [50.0, 4.0, -0.75], [50.0, 4.75, 0.0], [50.0, 3.625, -0.649519], [50.0, 4.649519, 0.375], [50.0, 3.350481, -0.375], [50.0, 4.375, 0.649519], [50.0, 3.25, 0.0], [50.0, 4.0, 0.75], [50.0, 3.350481, 0.375], [50.0, 3.625, 0.649519]]
        [circles, ind_tab] = mf.circle_detection_axis(points=points, axis=0,tolerance = 0.1)
        [new_circle_tab,new_ind_tab_full] = mf.ordering_cylinder(circles,ind_tab)
        circle_tab_sol = [[[9.71445147e-16, 4.375, -0.649519], [1.03240061e-15, 4.649519, -0.375], [1.05471187e-15, 4.75, 0.0], [1.03240061e-15, 4.649519, 0.375], [9.71445147e-16, 4.375, 0.649519], [8.8817842e-16, 4.0, 0.75], [8.04911693e-16, 3.625, 0.649519], [7.4395623e-16, 3.350481, 0.375], [7.21644966e-16, 3.25, 0.0], [7.4395623e-16, 3.350481, -0.375], [8.04911693e-16, 3.625, -0.649519], [8.8817842e-16, 4.0, -0.75]], [[3.125, 4.375, -0.649519], [3.125, 4.649519, -0.375], [3.125, 4.75, 0.0], [3.125, 4.649519, 0.375], [3.125, 4.375, 0.649519], [3.125, 4.0, 0.75], [3.125, 3.625, 0.649519], [3.125, 3.350481, 0.375], [3.125, 3.25, 0.0], [3.125, 3.350481, -0.375], [3.125, 3.625, -0.649519], [3.125, 4.0, -0.75]], [[6.25, 4.375, -0.649519], [6.25, 4.649519, -0.375], [6.25, 4.75, 0.0], [6.25, 4.649519, 0.375], [6.25, 4.375, 0.649519], [6.25, 4.0, 0.75], [6.25, 3.625, 0.649519], [6.25, 3.350481, 0.375], [6.25, 3.25, 0.0], [6.25, 3.350481, -0.375], [6.25, 3.625, -0.649519], [6.25, 4.0, -0.75]], [[9.375, 4.375, -0.649519], [9.375, 4.649519, -0.375], [9.375, 4.75, 0.0], [9.375, 4.649519, 0.375], [9.375, 4.375, 0.649519], [9.375, 4.0, 0.75], [9.375, 3.625, 0.649519], [9.375, 3.350481, 0.375], [9.375, 3.25, 0.0], [9.375, 3.350481, -0.375], [9.375, 3.625, -0.649519], [9.375, 4.0, -0.75]], [[12.5, 4.375, -0.649519], [12.5, 4.649519, -0.375], [12.5, 4.75, 0.0], [12.5, 4.649519, 0.375], [12.5, 4.375, 0.649519], [12.5, 4.0, 0.75], [12.5, 3.625, 0.649519], [12.5, 3.350481, 0.375], [12.5, 3.25, 0.0], [12.5, 3.350481, -0.375], [12.5, 3.625, -0.649519], [12.5, 4.0, -0.75]], [[15.625, 4.375, -0.649519], [15.625, 4.649519, -0.375], [15.625, 4.75, 0.0], [15.625, 4.649519, 0.375], [15.625, 4.375, 0.649519], [15.625, 4.0, 0.75], [15.625, 3.625, 0.649519], [15.625, 3.350481, 0.375], [15.625, 3.25, 0.0], [15.625, 3.350481, -0.375], [15.625, 3.625, -0.649519], [15.625, 4.0, -0.75]], [[18.75, 4.375, -0.649519], [18.75, 4.649519, -0.375], [18.75, 4.75, 0.0], [18.75, 4.649519, 0.375], [18.75, 4.375, 0.649519], [18.75, 4.0, 0.75], [18.75, 3.625, 0.649519], [18.75, 3.350481, 0.375], [18.75, 3.25, 0.0], [18.75, 3.350481, -0.375], [18.75, 3.625, -0.649519], [18.75, 4.0, -0.75]], [[21.875, 4.375, -0.649519], [21.875, 4.649519, -0.375], [21.875, 4.75, 0.0], [21.875, 4.649519, 0.375], [21.875, 4.375, 0.649519], [21.875, 4.0, 0.75], [21.875, 3.625, 0.649519], [21.875, 3.350481, 0.375], [21.875, 3.25, 0.0], [21.875, 3.350481, -0.375], [21.875, 3.625, -0.649519], [21.875, 4.0, -0.75]], [[25.0, 4.375, -0.649519], [25.0, 4.649519, -0.375], [25.0, 4.75, 0.0], [25.0, 4.649519, 0.375], [25.0, 4.375, 0.649519], [25.0, 4.0, 0.75], [25.0, 3.625, 0.649519], [25.0, 3.350481, 0.375], [25.0, 3.25, 0.0], [25.0, 3.350481, -0.375], [25.0, 3.625, -0.649519], [25.0, 4.0, -0.75]], [[28.125, 4.375, -0.649519], [28.125, 4.649519, -0.375], [28.125, 4.75, 0.0], [28.125, 4.649519, 0.375], [28.125, 4.375, 0.649519], [28.125, 4.0, 0.75], [28.125, 3.625, 0.649519], [28.125, 3.350481, 0.375], [28.125, 3.25, 0.0], [28.125, 3.350481, -0.375], [28.125, 3.625, -0.649519], [28.125, 4.0, -0.75]], [[31.25, 4.375, -0.649519], [31.25, 4.649519, -0.375], [31.25, 4.75, 0.0], [31.25, 4.649519, 0.375], [31.25, 4.375, 0.649519], [31.25, 4.0, 0.75], [31.25, 3.625, 0.649519], [31.25, 3.350481, 0.375], [31.25, 3.25, 0.0], [31.25, 3.350481, -0.375], [31.25, 3.625, -0.649519], [31.25, 4.0, -0.75]], [[34.375, 4.375, -0.649519], [34.375, 4.649519, -0.375], [34.375, 4.75, 0.0], [34.375, 4.649519, 0.375], [34.375, 4.375, 0.649519], [34.375, 4.0, 0.75], [34.375, 3.625, 0.649519], [34.375, 3.350481, 0.375], [34.375, 3.25, 0.0], [34.375, 3.350481, -0.375], [34.375, 3.625, -0.649519], [34.375, 4.0, -0.75]], [[37.5, 4.375, -0.649519], [37.5, 4.649519, -0.375], [37.5, 4.75, 0.0], [37.5, 4.649519, 0.375], [37.5, 4.375, 0.649519], [37.5, 4.0, 0.75], [37.5, 3.625, 0.649519], [37.5, 3.350481, 0.375], [37.5, 3.25, 0.0], [37.5, 3.350481, -0.375], [37.5, 3.625, -0.649519], [37.5, 4.0, -0.75]], [[40.625, 4.375, -0.649519], [40.625, 4.649519, -0.375], [40.625, 4.75, 0.0], [40.625, 4.649519, 0.375], [40.625, 4.375, 0.649519], [40.625, 4.0, 0.75], [40.625, 3.625, 0.649519], [40.625, 3.350481, 0.375], [40.625, 3.25, 0.0], [40.625, 3.350481, -0.375], [40.625, 3.625, -0.649519], [40.625, 4.0, -0.75]], [[43.75, 4.375, -0.649519], [43.75, 4.649519, -0.375], [43.75, 4.75, 0.0], [43.75, 4.649519, 0.375], [43.75, 4.375, 0.649519], [43.75, 4.0, 0.75], [43.75, 3.625, 0.649519], [43.75, 3.350481, 0.375], [43.75, 3.25, 0.0], [43.75, 3.350481, -0.375], [43.75, 3.625, -0.649519], [43.75, 4.0, -0.75]], [[46.875, 4.375, -0.649519], [46.875, 4.649519, -0.375], [46.875, 4.75, 0.0], [46.875, 4.649519, 0.375], [46.875, 4.375, 0.649519], [46.875, 4.0, 0.75], [46.875, 3.625, 0.649519], [46.875, 3.350481, 0.375], [46.875, 3.25, 0.0], [46.875, 3.350481, -0.375], [46.875, 3.625, -0.649519], [46.875, 4.0, -0.75]], [[50.0, 4.375, -0.649519], [50.0, 4.649519, -0.375], [50.0, 4.75, 0.0], [50.0, 4.649519, 0.375], [50.0, 4.375, 0.649519], [50.0, 4.0, 0.75], [50.0, 3.625, 0.649519], [50.0, 3.350481, 0.375], [50.0, 3.25, 0.0], [50.0, 3.350481, -0.375], [50.0, 3.625, -0.649519], [50.0, 4.0, -0.75]]]
        tab_ind_full_sol = [[7, 9, 11, 10, 8, 6, 4, 2, 0, 1, 3, 5], [12, 13, 15, 17, 19, 21, 23, 22, 20, 18, 16, 14], [24, 25, 27, 29, 31, 33, 35, 34, 32, 30, 28, 26], [36, 37, 39, 41, 43, 45, 47, 46, 44, 42, 40, 38], [48, 49, 51, 53, 55, 57, 59, 58, 56, 54, 52, 50], [60, 61, 63, 65, 67, 69, 71, 70, 68, 66, 64, 62], [72, 73, 75, 77, 79, 81, 83, 82, 80, 78, 76, 74], [84, 85, 87, 89, 91, 93, 95, 94, 92, 90, 88, 86], [96, 97, 99, 101, 103, 105, 107, 106, 104, 102, 100, 98], [108, 109, 111, 113, 115, 117, 119, 118, 116, 114, 112, 110], [120, 121, 123, 125, 127, 129, 131, 130, 128, 126, 124, 122], [132, 133, 135, 137, 139, 141, 143, 142, 140, 138, 136, 134], [144, 145, 147, 149, 151, 153, 155, 154, 152, 150, 148, 146], [156, 157, 159, 161, 163, 165, 167, 166, 164, 162, 160, 158], [168, 169, 171, 173, 175, 177, 179, 178, 176, 174, 172, 170], [180, 181, 183, 185, 187, 189, 191, 190, 188, 186, 184, 182], [192, 193, 195, 197, 199, 201, 203, 202, 200, 198, 196, 194]]

        if new_circle_tab != circle_tab_sol :
            print("- Erreur - Remise dans le sens horaire des cercles successifs d'un cylindre faux #023")
        self.assertEqual(new_circle_tab, circle_tab_sol)

        if new_ind_tab_full != tab_ind_full_sol :
            print("- Erreur - Remise dans le sens horaire des cercles successifs d'un cylindre faux - Indices #024")
        self.assertEqual(new_ind_tab_full, tab_ind_full_sol)

        circles02 = [[[7.21644966e-16, 3.25, 0.0], [7.4395623e-16, 3.350481, -0.375], [7.4395623e-16, 3.350481, 0.375], [8.04911693e-16, 3.625, -0.649519], [8.04911693e-16, 3.625, 0.649519], [8.8817842e-16, 4.0, -0.75], [8.8817842e-16, 4.0, 0.75], [9.71445147e-16, 4.375, -0.649519], [9.71445147e-16, 4.375, 0.649519], [1.03240061e-15, 4.649519, -0.375], [1.03240061e-15, 4.649519, 0.375], [1.05471187e-15, 4.75, 0.0]], [[3.125, 4.375, -0.649519], [3.125, 4.649519, -0.375], [3.125, 4.0, -0.75], [3.125, 4.75, 0.0], [3.125, 3.625, -0.649519], [3.125, 4.649519, 0.375], [3.125, 3.350481, -0.375], [3.125, 4.375, 0.649519], [3.125, 3.25, 0.0], [3.125, 4.0, 0.75], [3.125, 3.350481, 0.375], [3.125, 3.625, 0.649519]], [[6.25, 4.375, -0.649519], [6.25, 4.649519, -0.375], [6.25, 4.0, -0.75], [6.25, 4.75, 0.0], [6.25, 3.625, -0.649519], [6.25, 4.649519, 0.375], [6.25, 3.350481, -0.375], [6.25, 4.375, 0.649519], [6.25, 3.25, 0.0], [6.25, 4.0, 0.75], [6.25, 3.350481, 0.375], [6.25, 3.625, 0.649519]], [[9.375, 4.375, -0.649519], [9.375, 4.649519, -0.375], [9.375, 4.0, -0.75], [9.375, 4.75, 0.0], [9.375, 3.625, -0.649519], [9.375, 4.649519, 0.375], [9.375, 3.350481, -0.375], [9.375, 4.375, 0.649519], [9.375, 3.25, 0.0], [9.375, 4.0, 0.75], [9.375, 3.350481, 0.375], [9.375, 3.625, 0.649519]], [[12.5, 4.375, -0.649519], [12.5, 4.649519, -0.375], [12.5, 4.0, -0.75], [12.5, 4.75, 0.0], [12.5, 3.625, -0.649519], [12.5, 4.649519, 0.375], [12.5, 3.350481, -0.375], [12.5, 4.375, 0.649519], [12.5, 3.25, 0.0], [12.5, 4.0, 0.75], [12.5, 3.350481, 0.375], [12.5, 3.625, 0.649519]], [[15.625, 4.375, -0.649519], [15.625, 4.649519, -0.375], [15.625, 4.0, -0.75], [15.625, 4.75, 0.0], [15.625, 3.625, -0.649519], [15.625, 4.649519, 0.375], [15.625, 3.350481, -0.375], [15.625, 4.375, 0.649519], [15.625, 3.25, 0.0], [15.625, 4.0, 0.75], [15.625, 3.350481, 0.375], [15.625, 3.625, 0.649519]], [[18.75, 4.375, -0.649519], [18.75, 4.649519, -0.375], [18.75, 4.0, -0.75], [18.75, 4.75, 0.0], [18.75, 3.625, -0.649519], [18.75, 4.649519, 0.375], [18.75, 3.350481, -0.375], [18.75, 4.375, 0.649519], [18.75, 3.25, 0.0], [18.75, 4.0, 0.75], [18.75, 3.350481, 0.375], [18.75, 3.625, 0.649519]], [[21.875, 4.375, -0.649519], [21.875, 4.649519, -0.375], [21.875, 4.0, -0.75], [21.875, 4.75, 0.0], [21.875, 3.625, -0.649519], [21.875, 4.649519, 0.375], [21.875, 3.350481, -0.375], [21.875, 4.375, 0.649519], [21.875, 3.25, 0.0], [21.875, 4.0, 0.75], [21.875, 3.350481, 0.375], [21.875, 3.625, 0.649519]], [[25.0, 4.375, -0.649519], [25.0, 4.649519, -0.375], [25.0, 4.0, -0.75], [25.0, 4.75, 0.0], [25.0, 3.625, -0.649519], [25.0, 4.649519, 0.375], [25.0, 3.350481, -0.375], [25.0, 4.375, 0.649519], [25.0, 3.25, 0.0], [25.0, 4.0, 0.75], [25.0, 3.350481, 0.375], [25.0, 3.625, 0.649519]], [[28.125, 4.375, -0.649519], [28.125, 4.649519, -0.375], [28.125, 4.0, -0.75], [28.125, 4.75, 0.0], [28.125, 3.625, -0.649519], [28.125, 4.649519, 0.375], [28.125, 3.350481, -0.375], [28.125, 4.375, 0.649519], [28.125, 3.25, 0.0], [28.125, 4.0, 0.75], [28.125, 3.350481, 0.375], [28.125, 3.625, 0.649519]], [[31.25, 4.375, -0.649519], [31.25, 4.649519, -0.375], [31.25, 4.0, -0.75], [31.25, 4.75, 0.0], [31.25, 3.625, -0.649519], [31.25, 4.649519, 0.375], [31.25, 3.350481, -0.375], [31.25, 4.375, 0.649519], [31.25, 3.25, 0.0], [31.25, 4.0, 0.75], [31.25, 3.350481, 0.375], [31.25, 3.625, 0.649519]], [[34.375, 4.375, -0.649519], [34.375, 4.649519, -0.375], [34.375, 4.0, -0.75], [34.375, 4.75, 0.0], [34.375, 3.625, -0.649519], [34.375, 4.649519, 0.375], [34.375, 3.350481, -0.375], [34.375, 4.375, 0.649519], [34.375, 3.25, 0.0], [34.375, 4.0, 0.75], [34.375, 3.350481, 0.375], [34.375, 3.625, 0.649519]], [[37.5, 4.375, -0.649519], [37.5, 4.649519, -0.375], [37.5, 4.0, -0.75], [37.5, 4.75, 0.0], [37.5, 3.625, -0.649519], [37.5, 4.649519, 0.375], [37.5, 3.350481, -0.375], [37.5, 4.375, 0.649519], [37.5, 3.25, 0.0], [37.5, 4.0, 0.75], [37.5, 3.350481, 0.375], [37.5, 3.625, 0.649519]], [[40.625, 4.375, -0.649519], [40.625, 4.649519, -0.375], [40.625, 4.0, -0.75], [40.625, 4.75, 0.0], [40.625, 3.625, -0.649519], [40.625, 4.649519, 0.375], [40.625, 3.350481, -0.375], [40.625, 4.375, 0.649519], [40.625, 3.25, 0.0], [40.625, 4.0, 0.75], [40.625, 3.350481, 0.375], [40.625, 3.625, 0.649519]], [[43.75, 4.375, -0.649519], [43.75, 4.649519, -0.375], [43.75, 4.0, -0.75], [43.75, 4.75, 0.0], [43.75, 3.625, -0.649519], [43.75, 4.649519, 0.375], [43.75, 3.350481, -0.375], [43.75, 4.375, 0.649519], [43.75, 3.25, 0.0], [43.75, 4.0, 0.75], [43.75, 3.350481, 0.375], [43.75, 3.625, 0.649519]], [[46.875, 4.375, -0.649519], [46.875, 4.649519, -0.375], [46.875, 4.0, -0.75], [46.875, 4.75, 0.0], [46.875, 3.625, -0.649519], [46.875, 4.649519, 0.375], [46.875, 3.350481, -0.375], [46.875, 4.375, 0.649519], [46.875, 3.25, 0.0], [46.875, 4.0, 0.75], [46.875, 3.350481, 0.375], [46.875, 3.625, 0.649519]], [[50.0, 4.375, -0.649519], [50.0, 4.649519, -0.375], [50.0, 4.0, -0.75], [50.0, 4.75, 0.0], [50.0, 3.625, -0.649519], [50.0, 4.649519, 0.375], [50.0, 3.350481, -0.375], [50.0, 4.375, 0.649519], [50.0, 3.25, 0.0], [50.0, 4.0, 0.75], [50.0, 3.350481, 0.375], [50.0, 3.625, 0.649519]]]
        ind_tab02 = [[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], [12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23], [24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35], [36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47], [48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59], [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71], [72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83], [84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95], [96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107], [108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119], [120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131], [132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143], [144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155], [156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167], [168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179], [180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191], [192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203]]

        [new_circle_tab02,new_ind_tab_full02] = mf.ordering_cylinder(circles02,ind_tab02)
        if new_circle_tab02 != circle_tab_sol :
            print("- Erreur - Remise dans le sens horaire des cercles successifs d'un cylindre faux #025")
        self.assertEqual(new_circle_tab02, circle_tab_sol)

        if new_ind_tab_full02 != tab_ind_full_sol :
            print("- Erreur - Remise dans le sens horaire des cercles successifs d'un cylindre faux - Indices #026")
        self.assertEqual(new_ind_tab_full02, tab_ind_full_sol)

    def test_shift_tab(self): # pour dcaler tous les lments d'un tableau de 1, pour pouvoir placer les ressorts
        tab = [[1, 11], [2, 222], [3, 4], [4, 3], [5, 10], [6, 13], [7, 24], [8, 18], [9, 19], [10, 100], [11, 1], [12, 25]]
        tab_sol = [[2, 222], [3, 4], [4, 3], [5, 10], [6, 13], [7, 24], [8, 18], [9, 19], [10, 100], [11, 1], [12, 25], [1, 11]]
        new_tab = mf.shift_tab(tab)

        if new_tab != tab_sol :
            print("- Erreur - Dcalage des lments du tableau faux - #027")
        self.assertEqual(new_tab, tab_sol)


# def close_cavity(circles,ind_tab): # dirty => you may do better my boy
#     """
#     Fonction qui en fonction des cercles, va crer les triangles pour fermer le maillage du cylindre aux extrmits

#     INPUT : 
#     circles = tableau qui contient les cercles du cylindre (tableau de tous les indices des points, un ligne du tableau reprsentant un cercle
#     ind_tab = tableau des indices 

#     OUTOUT :
#     new_triangles = tableau des triangles  ajouter pour fermer les cylindres
#     """
#     circle_bottom = circles[0]
#     ind_bottom = ind_tab [0]
#     # print(ind_bottom)
#     l = len(circles)
#     circle_top = circles[l-1]
#     ind_top = ind_tab[l-1]
#     print(ind_top)
#     print(len(ind_top))
    
#     new_triangles = []
#     nb_pt_per_slices = len(ind_top)
#     print(nb_pt_per_slices)
#     for i in range(6):
#         i = i*2
#         print(i)
#         ind_a = i
#         ind_b = i + 2
#         ind_c = i + 1
#         # print([ind_a,ind_b,ind_c])
#         if ind_b == np.ceil(nb_pt_per_slices):
#             # print("Y ALLONS NOUS ? je vais savoir bientpot")
#             ind_b = 0
#         print([ind_a,ind_b,ind_c])
        
#         new_triangles.append( [ ind_top[ind_a] ,ind_top[ind_b] ,ind_top[ind_c] ] )
#         new_triangles.append( [ ind_bottom[ind_a] ,ind_bottom[ind_b] ,ind_bottom[ind_c] ] )
        
#         ind_a = 0
#         ind_b = 10
#         ind_c = 2
#         new_triangles.append( [ ind_top[ind_a] ,ind_top[ind_b] ,ind_top[ind_c] ] )
#         new_triangles.append( [ ind_bottom[ind_a] ,ind_bottom[ind_b] ,ind_bottom[ind_c] ] )
        
#         ind_a = 4
#         ind_b = 8
#         ind_c = 6
#         new_triangles.append( [ ind_top[ind_a] ,ind_top[ind_b] ,ind_top[ind_c] ] )
#         new_triangles.append( [ ind_bottom[ind_a] ,ind_bottom[ind_b] ,ind_bottom[ind_c] ] )
        
#         ind_a = 4
#         ind_b = 2
#         ind_c = 10
#         new_triangles.append( [ ind_top[ind_a] ,ind_top[ind_b] ,ind_top[ind_c] ] )
#         new_triangles.append( [ ind_bottom[ind_a] ,ind_bottom[ind_b] ,ind_bottom[ind_c] ] )
        
#         ind_a = 10
#         ind_b = 4
#         ind_c = 8
#         new_triangles.append( [ ind_top[ind_a] ,ind_top[ind_b] ,ind_top[ind_c] ] )
#         new_triangles.append( [ ind_bottom[ind_a] ,ind_bottom[ind_b] ,ind_bottom[ind_c] ] )
    
#     return new_triangles

# def close_cavity_2(ind_top,ind_bottom): # dirty => you may do better my boy
#     """
#     Fonction qui en fonction des cercles, va crer les triangles pour fermer le maillage du cylindre aux extrmits

#     INPUT : 
#     ind_top = indices du cercle  l'extrmit suprieure du cylindre
#     ind_bottom = indices du cercle  l'extrmit infrieure du cylindre

#     OUTOUT :
#     new_triangles = tableau des triangles  ajouter pour fermer les cylindres
#     """
    
#     new_triangles = []
#     nb_pt_per_slices = len(ind_top)
#     # print(nb_pt_per_slices)
#     for i in range(6):
#         i = i*2
#         # print(i)
#         ind_a = i
#         ind_b = i + 2
#         ind_c = i + 1
#         # print([ind_a,ind_b,ind_c])
#         if ind_b == np.ceil(nb_pt_per_slices):
#             # print("Y ALLONS NOUS ? je vais savoir bientpot")
#             ind_b = 0
#         # print([ind_a,ind_b,ind_c])
        
#         new_triangles.append( [ ind_top[ind_a] ,ind_top[ind_b] ,ind_top[ind_c] ] )
#         new_triangles.append( [ ind_bottom[ind_c] ,ind_bottom[ind_b] ,ind_bottom[ind_a] ] )
        
#     ind_a = 0
#     ind_b = 10
#     ind_c = 2
#     new_triangles.append( [ ind_top[ind_a] ,ind_top[ind_b] ,ind_top[ind_c] ] )
#     new_triangles.append( [ ind_bottom[ind_c] ,ind_bottom[ind_b] ,ind_bottom[ind_a] ] )
    
#     ind_a = 4
#     ind_b = 8
#     ind_c = 6
#     new_triangles.append( [ ind_top[ind_a] ,ind_top[ind_b] ,ind_top[ind_c] ] )
#     new_triangles.append( [ ind_bottom[ind_c] ,ind_bottom[ind_b] ,ind_bottom[ind_a] ] )
    
#     ind_a = 2
#     ind_b = 10
#     ind_c = 4
#     new_triangles.append( [ ind_top[ind_a] ,ind_top[ind_b] ,ind_top[ind_c] ] )
#     new_triangles.append( [ ind_bottom[ind_c] ,ind_bottom[ind_b] ,ind_bottom[ind_a] ] )
    
#     ind_a = 4
#     ind_b = 10
#     ind_c = 8
#     new_triangles.append( [ ind_top[ind_a] ,ind_top[ind_b] ,ind_top[ind_c] ] )
#     new_triangles.append( [ ind_bottom[ind_c] ,ind_bottom[ind_b] ,ind_bottom[ind_a] ] )
    
#     return new_triangles 




if __name__ == '__main__':
    unittest.main()
